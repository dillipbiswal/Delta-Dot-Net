function tableToGrid(a,b){jQuery(a).each(function(){if(this.grid){return}jQuery(this).width("99%");var a=jQuery(this).width();var c=jQuery("tr td:first-child input[type=checkbox]:first",jQuery(this));var d=jQuery("tr td:first-child input[type=radio]:first",jQuery(this));var e=c.length>0;var f=!e&&d.length>0;var g=e||f;var h=[];var i=[];jQuery("th",jQuery(this)).each(function(){if(h.length===0&&g){h.push({name:"__selection__",index:"__selection__",width:0,hidden:true});i.push("__selection__")}else{h.push({name:jQuery(this).attr("id")||jQuery.trim(jQuery.jgrid.stripHtml(jQuery(this).html())).split(" ").join("_"),index:jQuery(this).attr("id")||jQuery.trim(jQuery.jgrid.stripHtml(jQuery(this).html())).split(" ").join("_"),width:jQuery(this).width()||150});i.push(jQuery(this).html())}});var j=[];var k=[];var l=[];jQuery("tbody > tr",jQuery(this)).each(function(){var a={};var b=0;jQuery("td",jQuery(this)).each(function(){if(b===0&&g){var c=jQuery("input",jQuery(this));var d=c.attr("value");k.push(d||j.length);if(c.is(":checked")){l.push(d)}a[h[b].name]=c.attr("value")}else{a[h[b].name]=jQuery(this).html()}b++});if(b>0){j.push(a)}});jQuery(this).empty();jQuery(this).addClass("scroll");jQuery(this).jqGrid(jQuery.extend({datatype:"local",width:a,colNames:i,colModel:h,multiselect:e},b||{}));var m;for(m=0;m<j.length;m++){var n=null;if(k.length>0){n=k[m];if(n&&n.replace){n=encodeURIComponent(n).replace(/[.\-%]/g,"_")}}if(n===null){n=m+1}jQuery(this).jqGrid("addRowData",n,j[m])}for(m=0;m<l.length;m++){jQuery(this).jqGrid("setSelection",l[m])}})}(function($){$.jgrid=$.jgrid||{};$.extend($.jgrid,{htmlDecode:function(a){if(a&&(a==" "||a=="&#160;"||a.length==1&&a.charCodeAt(0)==160)){return""}return!a?a:String(a).replace(/>/g,">").replace(/</g,"<").replace(/"/g,'"').replace(/&/g,"&")},htmlEncode:function(a){return!a?a:String(a).replace(/&/g,"&").replace(/\"/g,""").replace(/</g,"<").replace(/>/g,">")},format:function(a){var b=$.makeArray(arguments).slice(1);if(a===undefined){a=""}return a.replace(/\{(\d+)\}/g,function(a,c){return b[c]})},getCellIndex:function(a){var b=$(a);if(b.is("tr")){return-1}b=(!b.is("td")&&!b.is("th")?b.closest("td,th"):b)[0];if($.browser.msie){return $.inArray(b,b.parentNode.cells)}return b.cellIndex},stripHtml:function(a){a=a+"";var b=/<("[^"]*"|'[^']*'|[^'">])*>/gi;if(a){a=a.replace(b,"");return a&&a!==" "&&a!=="&#160;"?a.replace(/\"/g,"'"):""}else{return a}},stripPref:function(a,b){var c=Object.prototype.toString.call(a).slice(8,-1);if(c=="String"||c=="Number"){a=String(a);b=a!=""?String(b).replace(String(a),""):b}return b},stringToDoc:function(a){var b;if(typeof a!=="string"){return a}try{var c=new DOMParser;b=c.parseFromString(a,"text/xml")}catch(d){b=new ActiveXObject("Microsoft.XMLDOM");b.async=false;b.loadXML(a)}return b&&b.documentElement&&b.documentElement.tagName!="parsererror"?b:null},parse:function(jsonString){var js=jsonString;if(js.substr(0,9)=="while(1);"){js=js.substr(9)}if(js.substr(0,2)=="/*"){js=js.substr(2,js.length-4)}if(!js){js="{}"}return $.jgrid.useJSON===true&&typeof JSON==="object"&&typeof JSON.parse==="function"?JSON.parse(js):eval("("+js+")")},parseDate:function(a,b){var c={m:1,d:1,y:1970,h:0,i:0,s:0},d,e,f,g=/[\\\/:_;.,\t\T\s-]/;if(b&&b!==null&&b!==undefined){b=$.trim(b);b=b.split(g);a=a.split(g);var h=$.jgrid.formatter.date.monthNames;var i=$.jgrid.formatter.date.AmPm;var j=function(a,b){if(a===0){if(b==12){b=0}}else{if(b!=12){b+=12}}return b};for(d=0,e=a.length;d<e;d++){if(a[d]=="M"){f=$.inArray(b[d],h);if(f!==-1&&f<12){b[d]=f+1}}if(a[d]=="F"){f=$.inArray(b[d],h);if(f!==-1&&f>11){b[d]=f+1-12}}if(a[d]=="a"){f=$.inArray(b[d],i);if(f!==-1&&f<2&&b[d]==i[f]){b[d]=f;c.h=j(b[d],c.h)}}if(a[d]=="A"){f=$.inArray(b[d],i);if(f!==-1&&f>1&&b[d]==i[f]){b[d]=f-2;c.h=j(b[d],c.h)}}if(b[d]!==undefined){c[a[d].toLowerCase()]=parseInt(b[d],10)}}c.m=parseInt(c.m,10)-1;var k=c.y;if(k>=70&&k<=99){c.y=1900+c.y}else if(k>=0&&k<=69){c.y=2e3+c.y}}return new Date(c.y,c.m,c.d,c.h,c.i,c.s,0)},jqID:function(a){return String(a).replace(/[!"#$%&'()*+,.\/:;<=>?@\[\\\]\^`{|}~]/g,"\\$&")},guid:1,uidPref:"jqg",randId:function(a){return(a?a:$.jgrid.uidPref)+$.jgrid.guid++},getAccessor:function(a,b){var c,d,e=[],f;if(typeof b==="function"){return b(a)}c=a[b];if(c===undefined){try{if(typeof b==="string"){e=b.split(".")}f=e.length;if(f){c=a;while(c&&f--){d=e.shift();c=c[d]}}}catch(g){}}return c},ajaxOptions:{},from:function(source,initalQuery){var queryObject=function(d,q){if(typeof d=="string"){d=$.data(d)}var self=this,_data=d,_usecase=true,_trim=false,_query=q,_stripNum=/[\$,%]/g,_lastCommand=null,_lastField=null,_orDepth=0,_negate=false,_queuedOperator="",_sorting=[],_useProperties=true;if(typeof d=="object"&&d.push){if(d.length>0){if(typeof d[0]!="object"){_useProperties=false}else{_useProperties=true}}}else{throw"data provides is not an array"}this._hasData=function(){return _data===null?false:_data.length===0?false:true};this._getStr=function(a){var b=[];if(_trim){b.push("jQuery.trim(")}b.push("String("+a+")");if(_trim){b.push(")")}if(!_usecase){b.push(".toLowerCase()")}return b.join("")};this._strComp=function(a){if(typeof a=="string"){return".toString()"}else{return""}};this._group=function(a,b){return{field:a.toString(),unique:b,items:[]}};this._toStr=function(a){if(_trim){a=$.trim(a)}if(!_usecase){a=a.toLowerCase()}a=a.toString().replace(/\\/g,"\\\\").replace(/\"/g,'\\"');return a};this._funcLoop=function(a){var b=[];$.each(_data,function(c,d){b.push(a(d))});return b};this._append=function(a){var b;if(_query===null){_query=""}else{_query+=_queuedOperator===""?" && ":_queuedOperator}for(b=0;b<_orDepth;b++){_query+="("}if(_negate){_query+="!"}_query+="("+a+")";_negate=false;_queuedOperator="";_orDepth=0};this._setCommand=function(a,b){_lastCommand=a;_lastField=b};this._resetNegate=function(){_negate=false};this._repeatCommand=function(a,b){if(_lastCommand===null){return self}if(a!==null&&b!==null){return _lastCommand(a,b)}if(_lastField===null){return _lastCommand(a)}if(!_useProperties){return _lastCommand(a)}return _lastCommand(_lastField,a)};this._equals=function(a,b){return self._compare(a,b,1)===0};this._compare=function(a,b,c){if(c===undefined){c=1}if(a===undefined){a=null}if(b===undefined){b=null}if(a===null&&b===null){return 0}if(a===null&&b!==null){return 1}if(a!==null&&b===null){return-1}if(!_usecase&&typeof a!=="number"&&typeof b!=="number"){a=String(a).toLowerCase();b=String(b).toLowerCase()}if(a<b){return-c}if(a>b){return c}return 0};this._performSort=function(){if(_sorting.length===0){return}_data=self._doSort(_data,0)};this._doSort=function(a,b){var c=_sorting[b].by,d=_sorting[b].dir,e=_sorting[b].type,f=_sorting[b].datefmt;if(b==_sorting.length-1){return self._getOrder(a,c,d,e,f)}b++;var g=self._getGroup(a,c,d,e,f);var h=[];for(var i=0;i<g.length;i++){var j=self._doSort(g[i].items,b);for(var k=0;k<j.length;k++){h.push(j[k])}}return h};this._getOrder=function(a,b,c,d,e){var f=[],g=[],h=c=="a"?1:-1,i,j,k,l;if(d===undefined){d="text"}if(d=="float"||d=="number"||d=="currency"||d=="numeric"){l=function(a,b){var c=parseFloat(String(a).replace(_stripNum,""));return isNaN(c)?0:c}}else if(d=="int"||d=="integer"){l=function(a,b){return a?parseFloat(String(a).replace(_stripNum,"")):0}}else if(d=="date"||d=="datetime"){l=function(a,b){return $.jgrid.parseDate(e,a).getTime()}}else if($.isFunction(d)){l=d}else{l=function(a,b){if(!a){a=""}return $.trim(String(a).toUpperCase())}}$.each(a,function(a,c){j=b!==""?$.jgrid.getAccessor(c,b):c;if(j===undefined){j=""}j=l(j,c);g.push({vSort:j,index:a})});g.sort(function(a,b){a=a.vSort;b=b.vSort;return self._compare(a,b,h)});k=0;var m=a.length;while(k<m){i=g[k].index;f.push(a[i]);k++}return f};this._getGroup=function(a,b,c,d,e){var f=[],g=null,h=null,i;$.each(self._getOrder(a,b,c,d,e),function(a,c){i=$.jgrid.getAccessor(c,b);if(i===undefined){i=""}if(!self._equals(h,i)){h=i;if(g!==null){f.push(g)}g=self._group(b,i)}g.items.push(c)});if(g!==null){f.push(g)}return f};this.ignoreCase=function(){_usecase=false;return self};this.useCase=function(){_usecase=true;return self};this.trim=function(){_trim=true;return self};this.noTrim=function(){_trim=false;return self};this.execute=function(){var match=_query,results=[];if(match===null){return self}$.each(_data,function(){if(eval(match)){results.push(this)}});_data=results;return self};this.data=function(){return _data};this.select=function(a){self._performSort();if(!self._hasData()){return[]}self.execute();if($.isFunction(a)){var b=[];$.each(_data,function(c,d){b.push(a(d))});return b}return _data};this.hasMatch=function(a){if(!self._hasData()){return false}self.execute();return _data.length>0};this.andNot=function(a,b,c){_negate=!_negate;return self.and(a,b,c)};this.orNot=function(a,b,c){_negate=!_negate;return self.or(a,b,c)};this.not=function(a,b,c){return self.andNot(a,b,c)};this.and=function(a,b,c){_queuedOperator=" && ";if(a===undefined){return self}return self._repeatCommand(a,b,c)};this.or=function(a,b,c){_queuedOperator=" || ";if(a===undefined){return self}return self._repeatCommand(a,b,c)};this.orBegin=function(){_orDepth++;return self};this.orEnd=function(){if(_query!==null){_query+=")"}return self};this.isNot=function(a){_negate=!_negate;return self.is(a)};this.is=function(a){self._append("this."+a);self._resetNegate();return self};this._compareValues=function(a,b,c,d,e){var f;if(_useProperties){f="jQuery.jgrid.getAccessor(this,'"+b+"')"}else{f="this"}if(c===undefined){c=null}var g=c,h=e.stype===undefined?"text":e.stype;if(c!==null){switch(h){case"int":case"integer":g=isNaN(Number(g))||g===""?"0":g;f="parseInt("+f+",10)";g="parseInt("+g+",10)";break;case"float":case"number":case"numeric":g=String(g).replace(_stripNum,"");g=isNaN(Number(g))||g===""?"0":g;f="parseFloat("+f+")";g="parseFloat("+g+")";break;case"date":case"datetime":g=String($.jgrid.parseDate(e.newfmt||"Y-m-d",g).getTime());f='jQuery.jgrid.parseDate("'+e.srcfmt+'",'+f+").getTime()";break;default:f=self._getStr(f);g=self._getStr('"'+self._toStr(g)+'"')}}self._append(f+" "+d+" "+g);self._setCommand(a,b);self._resetNegate();return self};this.equals=function(a,b,c){return self._compareValues(self.equals,a,b,"==",c)};this.notEquals=function(a,b,c){return self._compareValues(self.equals,a,b,"!==",c)};this.isNull=function(a,b,c){return self._compareValues(self.equals,a,null,"===",c)};this.greater=function(a,b,c){return self._compareValues(self.greater,a,b,">",c)};this.less=function(a,b,c){return self._compareValues(self.less,a,b,"<",c)};this.greaterOrEquals=function(a,b,c){return self._compareValues(self.greaterOrEquals,a,b,">=",c)};this.lessOrEquals=function(a,b,c){return self._compareValues(self.lessOrEquals,a,b,"<=",c)};this.startsWith=function(a,b){var c=b===undefined||b===null?a:b,d=_trim?$.trim(c.toString()).length:c.toString().length;if(_useProperties){self._append(self._getStr("jQuery.jgrid.getAccessor(this,'"+a+"')")+".substr(0,"+d+") == "+self._getStr('"'+self._toStr(b)+'"'))}else{d=_trim?$.trim(b.toString()).length:b.toString().length;self._append(self._getStr("this")+".substr(0,"+d+") == "+self._getStr('"'+self._toStr(a)+'"'))}self._setCommand(self.startsWith,a);self._resetNegate();return self};this.endsWith=function(a,b){var c=b===undefined||b===null?a:b,d=_trim?$.trim(c.toString()).length:c.toString().length;if(_useProperties){self._append(self._getStr("jQuery.jgrid.getAccessor(this,'"+a+"')")+".substr("+self._getStr("jQuery.jgrid.getAccessor(this,'"+a+"')")+".length-"+d+","+d+') == "'+self._toStr(b)+'"')}else{self._append(self._getStr("this")+".substr("+self._getStr("this")+'.length-"'+self._toStr(a)+'".length,"'+self._toStr(a)+'".length) == "'+self._toStr(a)+'"')}self._setCommand(self.endsWith,a);self._resetNegate();return self};this.contains=function(a,b){if(_useProperties){self._append(self._getStr("jQuery.jgrid.getAccessor(this,'"+a+"')")+'.indexOf("'+self._toStr(b)+'",0) > -1')}else{self._append(self._getStr("this")+'.indexOf("'+self._toStr(a)+'",0) > -1')}self._setCommand(self.contains,a);self._resetNegate();return self};this.groupBy=function(a,b,c,d){if(!self._hasData()){return null}return self._getGroup(_data,a,b,c,d)};this.orderBy=function(a,b,c,d){b=b===undefined||b===null?"a":$.trim(b.toString().toLowerCase());if(c===null||c===undefined){c="text"}if(d===null||d===undefined){d="Y-m-d"}if(b=="desc"||b=="descending"){b="d"}if(b=="asc"||b=="ascending"){b="a"}_sorting.push({by:a,dir:b,type:c,datefmt:d});return self};return self};return new queryObject(source,null)},extend:function(a){$.extend($.fn.jqGrid,a);if(!this.no_legacy_api){$.fn.extend(a)}}});$.fn.jqGrid=function(a){if(typeof a=="string"){var b=$.jgrid.getAccessor($.fn.jqGrid,a);if(!b){throw"jqGrid - No such method: "+a}var c=$.makeArray(arguments).slice(1);return b.apply(this,c)}return this.each(function(){if(this.grid){return}var b=$.extend(true,{url:"",height:150,page:1,rowNum:20,rowTotal:null,records:0,pager:"",pgbuttons:true,pginput:true,colModel:[],rowList:[],colNames:[],sortorder:"asc",sortname:"",datatype:"xml",mtype:"GET",altRows:false,selarrrow:[],savedRow:[],shrinkToFit:true,xmlReader:{},jsonReader:{},subGrid:false,subGridModel:[],reccount:0,lastpage:0,lastsort:0,selrow:null,beforeSelectRow:null,onSelectRow:null,onSortCol:null,ondblClickRow:null,onRightClickRow:null,onPaging:null,onSelectAll:null,loadComplete:null,gridComplete:null,loadError:null,loadBeforeSend:null,afterInsertRow:null,beforeRequest:null,beforeProcessing:null,onHeaderClick:null,viewrecords:false,loadonce:false,multiselect:false,multikey:false,editurl:null,search:false,caption:"",hidegrid:true,hiddengrid:false,postData:{},userData:{},treeGrid:false,treeGridModel:"nested",treeReader:{},treeANode:-1,ExpandColumn:null,tree_root_level:0,prmNames:{page:"page",rows:"rows",sort:"sidx",order:"sord",search:"_search",nd:"nd",id:"id",oper:"oper",editoper:"edit",addoper:"add",deloper:"del",subgridid:"id",npage:null,totalrows:"totalrows"},forceFit:false,gridstate:"visible",cellEdit:false,cellsubmit:"remote",nv:0,loadui:"enable",toolbar:[false,""],scroll:false,multiboxonly:false,deselectAfterSort:true,scrollrows:false,autowidth:false,scrollOffset:18,cellLayout:5,subGridWidth:20,multiselectWidth:20,gridview:false,rownumWidth:25,rownumbers:false,pagerpos:"center",recordpos:"right",footerrow:false,userDataOnFooter:false,hoverrows:true,altclass:"ui-priority-secondary",viewsortcols:[false,"vertical",true],resizeclass:"",autoencode:false,remapColumns:[],ajaxGridOptions:{},direction:"ltr",toppager:false,headertitles:false,scrollTimeout:40,data:[],_index:{},grouping:false,groupingView:{groupField:[],groupOrder:[],groupText:[],groupColumnShow:[],groupSummary:[],showSummaryOnHide:false,sortitems:[],sortnames:[],groupDataSorted:false,summary:[],summaryval:[],plusicon:"ui-icon-circlesmall-plus",minusicon:"ui-icon-circlesmall-minus"},ignoreCase:false,cmTemplate:{},idPrefix:""},$.jgrid.defaults,a||{});var c={headers:[],cols:[],footers:[],dragStart:function(a,c,d){this.resizing={idx:a,startX:c.clientX,sOL:d[0]};this.hDiv.style.cursor="col-resize";this.curGbox=$("#rs_m"+$.jgrid.jqID(b.id),"#gbox_"+$.jgrid.jqID(b.id));this.curGbox.css({display:"block",left:d[0],top:d[1],height:d[2]});if($.isFunction(b.resizeStart)){b.resizeStart.call(this,c,a)}document.onselectstart=function(){return false}},dragMove:function(a){if(this.resizing){var c=a.clientX-this.resizing.startX,d=this.headers[this.resizing.idx],e=b.direction==="ltr"?d.width+c:d.width-c,f,g;if(e>33){this.curGbox.css({left:this.resizing.sOL+c});if(b.forceFit===true){f=this.headers[this.resizing.idx+b.nv];g=b.direction==="ltr"?f.width-c:f.width+c;if(g>33){d.newWidth=e;f.newWidth=g}}else{this.newWidth=b.direction==="ltr"?b.tblwidth+c:b.tblwidth-c;d.newWidth=e}}}},dragEnd:function(){this.hDiv.style.cursor="default";if(this.resizing){var a=this.resizing.idx,c=this.headers[a].newWidth||this.headers[a].width;c=parseInt(c,10);this.resizing=false;$("#rs_m"+$.jgrid.jqID(b.id)).css("display","none");b.colModel[a].width=c;this.headers[a].width=c;this.headers[a].el.style.width=c+"px";this.cols[a].style.width=c+"px";if(this.footers.length>0){this.footers[a].style.width=c+"px"}if(b.forceFit===true){c=this.headers[a+b.nv].newWidth||this.headers[a+b.nv].width;this.headers[a+b.nv].width=c;this.headers[a+b.nv].el.style.width=c+"px";this.cols[a+b.nv].style.width=c+"px";if(this.footers.length>0){this.footers[a+b.nv].style.width=c+"px"}b.colModel[a+b.nv].width=c}else{b.tblwidth=this.newWidth||b.tblwidth;$("table:first",this.bDiv).css("width",b.tblwidth+"px");$("table:first",this.hDiv).css("width",b.tblwidth+"px");this.hDiv.scrollLeft=this.bDiv.scrollLeft;if(b.footerrow){$("table:first",this.sDiv).css("width",b.tblwidth+"px");this.sDiv.scrollLeft=this.bDiv.scrollLeft}}if($.isFunction(b.resizeStop)){b.resizeStop.call(this,c,a)}}this.curGbox=null;document.onselectstart=function(){return true}},populateVisible:function(){if(c.timer){clearTimeout(c.timer)}c.timer=null;var a=$(c.bDiv).height();if(!a){return}var d=$("table:first",c.bDiv);var e,f;if(d[0].rows.length){try{e=d[0].rows[1];f=e?$(e).outerHeight()||c.prevRowHeight:c.prevRowHeight}catch(g){f=c.prevRowHeight}}if(!f){return}c.prevRowHeight=f;var h=b.rowNum;var i=c.scrollTop=c.bDiv.scrollTop;var j=Math.round(d.position().top)-i;var k=j+d.height();var l=f*h;var m,n,o;if(k<a&&j<=0&&(b.lastpage===undefined||parseInt((k+i+l-1)/l,10)<=b.lastpage)){n=parseInt((a-k+l-1)/l,10);if(k>=0||n<2||b.scroll===true){m=Math.round((k+i)/l)+1;j=-1}else{j=1}}if(j>0){m=parseInt(i/l,10)+1;n=parseInt((i+a)/l,10)+2-m;o=true}if(n){if(b.lastpage&&m>b.lastpage||b.lastpage==1||m===b.page&&m===b.lastpage){return}if(c.hDiv.loading){c.timer=setTimeout(c.populateVisible,b.scrollTimeout)}else{b.page=m;if(o){c.selectionPreserver(d[0]);c.emptyRows(c.bDiv,false,false)}c.populate(n)}}},scrollGrid:function(a){if(b.scroll){var d=c.bDiv.scrollTop;if(c.scrollTop===undefined){c.scrollTop=0}if(d!=c.scrollTop){c.scrollTop=d;if(c.timer){clearTimeout(c.timer)}c.timer=setTimeout(c.populateVisible,b.scrollTimeout)}}c.hDiv.scrollLeft=c.bDiv.scrollLeft;if(b.footerrow){c.sDiv.scrollLeft=c.bDiv.scrollLeft}if(a){a.stopPropagation()}},selectionPreserver:function(a){var b=a.p;var c=b.selrow,d=b.selarrrow?$.makeArray(b.selarrrow):null;var e=a.grid.bDiv.scrollLeft;var f=b.gridComplete;b.gridComplete=function(){b.selrow=null;b.selarrrow=[];if(b.multiselect&&d&&d.length>0){for(var g=0;g<d.length;g++){if(d[g]!=c){$(a).jqGrid("setSelection",d[g],false)}}}if(c){$(a).jqGrid("setSelection",c,false)}a.grid.bDiv.scrollLeft=e;b.gridComplete=f;if(b.gridComplete){f()}}}};if(this.tagName.toUpperCase()!="TABLE"){alert("Element is not a table");return}$(this).empty().attr("tabindex","1");this.p=b;this.p.useProp=!!$.fn.prop;var d,e,f;if(this.p.colNames.length===0){for(d=0;d<this.p.colModel.length;d++){this.p.colNames[d]=this.p.colModel[d].label||this.p.colModel[d].name}}if(this.p.colNames.length!==this.p.colModel.length){alert($.jgrid.errors.model);return}var g=$("<div class='ui-jqgrid-view'></div>"),h,i=$.browser.msie?true:false,j=$.browser.webkit||$.browser.safari?true:false;f=this;f.p.direction=$.trim(f.p.direction.toLowerCase());if($.inArray(f.p.direction,["ltr","rtl"])==-1){f.p.direction="ltr"}e=f.p.direction;$(g).insertBefore(this);$(this).appendTo(g).removeClass("scroll");var k=$("<div class='ui-jqgrid ui-widget ui-widget-content ui-corner-all'></div>");$(k).insertBefore(g).attr({id:"gbox_"+this.id,dir:e});$(g).appendTo(k).attr("id","gview_"+this.id);if(i&&$.browser.version<=6){h='<iframe style="display:block;position:absolute;z-index:-1;filter:Alpha(Opacity=\'0\');" src="javascript:false;"></iframe>'}else{h=""}$("<div class='ui-widget-overlay jqgrid-overlay' id='lui_"+this.id+"'></div>").append(h).insertBefore(g);$("<div class='loading ui-state-default ui-state-active' id='load_"+this.id+"'>"+this.p.loadtext+"</div>").insertBefore(g);$(this).attr({cellspacing:"0",cellpadding:"0",border:"0",role:"grid","aria-multiselectable":!!this.p.multiselect,"aria-labelledby":"gbox_"+this.id});var l=["shiftKey","altKey","ctrlKey"],m=function(a,b){a=parseInt(a,10);if(isNaN(a)){return b?b:0}else{return a}},n=function(a,b,d,e,g,h){var i=f.p.colModel[a],j=i.align,k='style="',l=i.classes,m=i.name,n,o=[];if(j){k+="text-align:"+j+";"}if(i.hidden===true){k+="display:none;"}if(b===0){k+="width: "+c.headers[a].width+"px;"}else if(i.cellattr&&$.isFunction(i.cellattr)){n=i.cellattr.call(f,g,d,e,i,h);if(n&&typeof n==="string"){n=n.replace(/style/i,"style").replace(/title/i,"title");if(n.indexOf("title")>-1){i.title=false}if(n.indexOf("class")>-1){l=undefined}o=n.split("style");if(o.length===2){o[1]=$.trim(o[1].replace("=",""));if(o[1].indexOf("'")===0||o[1].indexOf('"')===0){o[1]=o[1].substring(1)}k+=o[1].replace(/'/gi,'"')}else{k+='"'}}}if(!o.length){o[0]="";k+='"'}k+=(l!==undefined?' class="'+l+'"':"")+(i.title&&d?' title="'+$.jgrid.stripHtml(d)+'"':"");k+=' aria-describedby="'+f.p.id+"_"+m+'"';return k+o[0]},o=function(a){return a===undefined||a===null||a===""?"&#160;":f.p.autoencode?$.jgrid.htmlEncode(a):a+""},p=function(a,b,c,d,e){var g=f.p.colModel[c],h;if(typeof g.formatter!=="undefined"){var i={rowId:a,colModel:g,gid:f.p.id,pos:c};if($.isFunction(g.formatter)){h=g.formatter.call(f,b,i,d,e)}else if($.fmatter){h=$.fn.fmatter(g.formatter,b,i,d,e)}else{h=o(b)}}else{h=o(b)}return h},q=function(a,b,c,d,e){var f,g;f=p(a,b,c,e,"add");g=n(c,d,f,e,a,true);return'<td role="gridcell" '+g+">"+f+"</td>"},r=function(a,b,c){var d='<input role="checkbox" type="checkbox"'+' id="jqg_'+f.p.id+"_"+a+'" class="cbox" name="jqg_'+f.p.id+"_"+a+'"/>',e=n(b,c,"",null,a,true);return'<td role="gridcell" '+e+">"+d+"</td>"},s=function(a,b,c,d){var e=(parseInt(c,10)-1)*parseInt(d,10)+1+b,f=n(a,b,e,null,b,true);return'<td role="gridcell" class="ui-state-default jqgrid-rownum" '+f+">"+e+"</td>"},t=function(a){var b,c=[],d=0,e;for(e=0;e<f.p.colModel.length;e++){b=f.p.colModel[e];if(b.name!=="cb"&&b.name!=="subgrid"&&b.name!=="rn"){if(a=="local"){c[d]=b.name}else{c[d]=a=="xml"?b.xmlmap||b.name:b.jsonmap||b.name}d++}}return c},u=function(a){var b=f.p.remapColumns;if(!b||!b.length){b=$.map(f.p.colModel,function(a,b){return b})}if(a){b=$.map(b,function(b){return b<a?null:b-a})}return b},v=function(a,b,c){if(f.p.deepempty){$("#"+$.jgrid.jqID(f.p.id)+" tbody:first tr:gt(0)").remove()}else{var d=$("#"+$.jgrid.jqID(f.p.id)+" tbody:first tr:first")[0];$("#"+$.jgrid.jqID(f.p.id)+" tbody:first").empty().append(d)}if(b&&f.p.scroll){$(">div:first",a).css({height:"auto"}).children("div:first").css({height:0,display:"none"});a.scrollTop=0}if(c===true){if(f.p.treeGrid===true){f.p.data=[];f.p._index={}}}},w=function(){var a=f.p.data.length,b,c,d,e=f.p.rownumbers===true?1:0,g=f.p.multiselect===true?1:0,h=f.p.subGrid===true?1:0;if(f.p.keyIndex===false||f.p.loadonce===true){b=f.p.localReader.id}else{b=f.p.colModel[f.p.keyIndex+g+h+e].name}for(c=0;c<a;c++){d=$.jgrid.getAccessor(f.p.data[c],b);f.p._index[d]=c}},x=function(a,b,c,d,e){var g=new Date,h=f.p.datatype!="local"&&f.p.loadonce||f.p.datatype=="xmlstring",i="_id_",j=f.p.datatype=="local"?"local":"xml";if(h){f.p.data=[];f.p._index={};f.p.localReader.id=i}f.p.reccount=0;if($.isXMLDoc(a)){if(f.p.treeANode===-1&&!f.p.scroll){v(b,false,true);c=1}else{c=c>1?c:1}}else{return}var k,l,m=0,n,o,p=0,w=0,x=0,y,z,A=[],B,C={},D,E,F=[],G=f.p.altRows===true?" "+f.p.altclass:"",H;if(!f.p.xmlReader.repeatitems){A=t(j)}if(f.p.keyIndex===false){y=f.p.xmlReader.id}else{y=f.p.keyIndex}if(A.length>0&&!isNaN(y)){if(f.p.remapColumns&&f.p.remapColumns.length){y=$.inArray(y,f.p.remapColumns)}y=A[y]}if((y+"").indexOf("[")===-1){if(A.length){z=function(a,b){return $(y,a).text()||b}}else{z=function(a,b){return $(f.p.xmlReader.cell,a).eq(y).text()||b}}}else{z=function(a,b){return a.getAttribute(y.replace(/[\[\]]/g,""))||b}}f.p.userData={};$(f.p.xmlReader.page,a).each(function(){f.p.page=this.textContent||this.text||0});$(f.p.xmlReader.total,a).each(function(){f.p.lastpage=this.textContent||this.text;if(f.p.lastpage===undefined){f.p.lastpage=1}});$(f.p.xmlReader.records,a).each(function(){f.p.records=this.textContent||this.text||0});$(f.p.xmlReader.userdata,a).each(function(){f.p.userData[this.getAttribute("name")]=$(this).text()});var I=$(f.p.xmlReader.root+" "+f.p.xmlReader.row,a);if(!I){I=[]}var J=I.length,K=0,L={},M;if(I&&J){M=parseInt(f.p.rowNum,10);var N=f.p.scroll?$.jgrid.randId():1,O;if(e){M*=e+1}var P=$.isFunction(f.p.afterInsertRow),Q="";if(f.p.grouping&&f.p.groupingView.groupCollapse===true){Q=' style="display:none;"'}while(K<J){D=I[K];E=z(D,N+K);E=f.p.idPrefix+E;O=c===0?0:c+1;H=(O+K)%2==1?G:"";F.push("<tr"+Q+' id="'+E+'" tabindex="-1" role="row" class ="ui-widget-content jqgrow ui-row-'+f.p.direction+""+H+'">');if(f.p.rownumbers===true){F.push(s(0,K,f.p.page,f.p.rowNum));x=1}if(f.p.multiselect===true){F.push(r(E,x,K));p=1}if(f.p.subGrid===true){F.push($(f).jqGrid("addSubGridCell",p+x,K+c));w=1}if(f.p.xmlReader.repeatitems){if(!B){B=u(p+w+x)}var R=$(f.p.xmlReader.cell,D);$.each(B,function(a){var b=R[this];if(!b){return false}n=b.textContent||b.text;C[f.p.colModel[a+p+w+x].name]=n;F.push(q(E,n,a+p+w+x,K+c,D))})}else{for(k=0;k<A.length;k++){n=$(A[k],D).text();C[f.p.colModel[k+p+w+x].name]=n;F.push(q(E,n,k+p+w+x,K+c,D))}}F.push("</tr>");if(f.p.grouping){var S=f.p.groupingView.groupField.length,T=[];for(var U=0;U<S;U++){T.push(C[f.p.groupingView.groupField[U]])}L=$(f).jqGrid("groupingPrepare",F,T,L,C);F=[]}if(h||f.p.treeGrid===true){C[i]=E;f.p.data.push(C);f.p._index[E]=f.p.data.length-1}if(f.p.gridview===false){$("tbody:first",b).append(F.join(""));if(P){f.p.afterInsertRow.call(f,E,C,D)}F=[]}C={};m++;K++;if(m==M){break}}}if(f.p.gridview===true){l=f.p.treeANode>-1?f.p.treeANode:0;if(f.p.grouping){$(f).jqGrid("groupingRender",L,f.p.colModel.length);L=null}else if(f.p.treeGrid===true&&l>0){$(f.rows[l]).after(F.join(""))}else{$("tbody:first",b).append(F.join(""))}}if(f.p.subGrid===true){try{$(f).jqGrid("addSubGrid",p+x)}catch(V){}}f.p.totaltime=new Date-g;if(m>0){if(f.p.records===0){f.p.records=J}}F=null;if(f.p.treeGrid===true){try{$(f).jqGrid("setTreeNode",l+1,m+l+1)}catch(W){}}if(!f.p.treeGrid&&!f.p.scroll){f.grid.bDiv.scrollTop=0}f.p.reccount=m;f.p.treeANode=-1;if(f.p.userDataOnFooter){$(f).jqGrid("footerData","set",f.p.userData,true)}if(h){f.p.records=J;f.p.lastpage=Math.ceil(J/M)}if(!d){f.updatepager(false,true)}if(h){while(m<J){D=I[m];E=z(D,m);E=f.p.idPrefix+E;if(f.p.xmlReader.repeatitems){if(!B){B=u(p+w+x)}var X=$(f.p.xmlReader.cell,D);$.each(B,function(a){var b=X[this];if(!b){return false}n=b.textContent||b.text;C[f.p.colModel[a+p+w+x].name]=n})}else{for(k=0;k<A.length;k++){n=$(A[k],D).text();C[f.p.colModel[k+p+w+x].name]=n}}C[i]=E;f.p.data.push(C);f.p._index[E]=f.p.data.length-1;C={};m++}}},y=function(a,b,c,d,e){var g=new Date;if(a){if(f.p.treeANode===-1&&!f.p.scroll){v(b,false,true);c=1}else{c=c>1?c:1}}else{return}var h,i="_id_",j,k=f.p.datatype!="local"&&f.p.loadonce||f.p.datatype=="jsonstring";if(k){f.p.data=[];f.p._index={};f.p.localReader.id=i}f.p.reccount=0;if(f.p.datatype=="local"){h=f.p.localReader;j="local"}else{h=f.p.jsonReader;j="json"}var l=0,m,n,o,p=[],w,x,y=0,z=0,A=0,B,C,D,E={},F,G,H=[],I=f.p.altRows===true?" "+f.p.altclass:"",J,K;f.p.page=$.jgrid.getAccessor(a,h.page)||0;K=$.jgrid.getAccessor(a,h.total);f.p.lastpage=K===undefined?1:K;f.p.records=$.jgrid.getAccessor(a,h.records)||0;f.p.userData=$.jgrid.getAccessor(a,h.userdata)||{};if(!h.repeatitems){w=p=t(j)}if(f.p.keyIndex===false){D=h.id}else{D=f.p.keyIndex}if(p.length>0&&!isNaN(D)){if(f.p.remapColumns&&f.p.remapColumns.length){D=$.inArray(D,f.p.remapColumns)}D=p[D]}C=$.jgrid.getAccessor(a,h.root);if(!C){C=[]}B=C.length;n=0;var L=parseInt(f.p.rowNum,10),M=f.p.scroll?$.jgrid.randId():1,N;if(e){L*=e+1}var O=$.isFunction(f.p.afterInsertRow),P={},Q="";if(f.p.grouping&&f.p.groupingView.groupCollapse===true){Q=' style="display:none;"'}while(n<B){x=C[n];G=$.jgrid.getAccessor(x,D);if(G===undefined){G=M+n;if(p.length===0){if(h.cell){var R=$.jgrid.getAccessor(x,h.cell);G=R[D]||G;R=null}}}G=f.p.idPrefix+G;N=c===1?0:c;J=(N+n)%2==1?I:"";H.push("<tr"+Q+' id="'+G+'" tabindex="-1" role="row" class= "ui-widget-content jqgrow ui-row-'+f.p.direction+""+J+'">');if(f.p.rownumbers===true){H.push(s(0,n,f.p.page,f.p.rowNum));A=1}if(f.p.multiselect){H.push(r(G,A,n));y=1}if(f.p.subGrid){H.push($(f).jqGrid("addSubGridCell",y+A,n+c));z=1}if(h.repeatitems){if(h.cell){x=$.jgrid.getAccessor(x,h.cell)}if(!w){w=u(y+z+A)}}for(o=0;o<w.length;o++){m=$.jgrid.getAccessor(x,w[o]);H.push(q(G,m,o+y+z+A,n+c,x));E[f.p.colModel[o+y+z+A].name]=m}H.push("</tr>");if(f.p.grouping){var S=f.p.groupingView.groupField.length,T=[];for(var U=0;U<S;U++){T.push(E[f.p.groupingView.groupField[U]])}P=$(f).jqGrid("groupingPrepare",H,T,P,E);H=[]}if(k||f.p.treeGrid===true){E[i]=G;f.p.data.push(E);f.p._index[G]=f.p.data.length-1}if(f.p.gridview===false){$("#"+$.jgrid.jqID(f.p.id)+" tbody:first").append(H.join(""));if(O){f.p.afterInsertRow.call(f,G,E,x)}H=[]}E={};l++;n++;if(l==L){break}}if(f.p.gridview===true){F=f.p.treeANode>-1?f.p.treeANode:0;if(f.p.grouping){$(f).jqGrid("groupingRender",P,f.p.colModel.length);P=null}else if(f.p.treeGrid===true&&F>0){$(f.rows[F]).after(H.join(""))}else{$("#"+$.jgrid.jqID(f.p.id)+" tbody:first").append(H.join(""))}}if(f.p.subGrid===true){try{$(f).jqGrid("addSubGrid",y+A)}catch(V){}}f.p.totaltime=new Date-g;if(l>0){if(f.p.records===0){f.p.records=B}}H=null;if(f.p.treeGrid===true){try{$(f).jqGrid("setTreeNode",F+1,l+F+1)}catch(W){}}if(!f.p.treeGrid&&!f.p.scroll){f.grid.bDiv.scrollTop=0}f.p.reccount=l;f.p.treeANode=-1;if(f.p.userDataOnFooter){$(f).jqGrid("footerData","set",f.p.userData,true)}if(k){f.p.records=B;f.p.lastpage=Math.ceil(B/L)}if(!d){f.updatepager(false,true)}if(k){while(l<B&&C[l]){x=C[l];G=$.jgrid.getAccessor(x,D);if(G===undefined){G=M+l;if(p.length===0){if(h.cell){var X=$.jgrid.getAccessor(x,h.cell);G=X[D]||G;X=null}}}if(x){G=f.p.idPrefix+G;if(h.repeatitems){if(h.cell){x=$.jgrid.getAccessor(x,h.cell)}if(!w){w=u(y+z+A)}}for(o=0;o<w.length;o++){m=$.jgrid.getAccessor(x,w[o]);E[f.p.colModel[o+y+z+A].name]=m}E[i]=G;f.p.data.push(E);f.p._index[G]=f.p.data.length-1;E={}}l++}}},z=function(){function m(a){var b=0,d,e,g,h,i;if(a.groups!==undefined){e=a.groups.length&&a.groupOp.toString().toUpperCase()==="OR";if(e){l.orBegin()}for(d=0;d<a.groups.length;d++){if(b>0&&e){l.or()}try{m(a.groups[d])}catch(j){alert(j)}b++}if(e){l.orEnd()}}if(a.rules!==undefined){if(b>0){var n=l.select();l=$.jgrid.from(n);if(f.p.ignoreCase){l=l.ignoreCase()}}try{g=a.rules.length&&a.groupOp.toString().toUpperCase()==="OR";if(g){l.orBegin()}for(d=0;d<a.rules.length;d++){i=a.rules[d];h=a.groupOp.toString().toUpperCase();if(k[i.op]&&i.field){if(b>0&&h&&h==="OR"){l=l.or()}l=k[i.op](l,h)(i.field,i.data,c[i.field])}b++}if(g){l.orEnd()}}catch(o){alert(o)}}}var a,b=false,c={},d=[],e=[],g,h,i;if(!$.isArray(f.p.data)){return}var j=f.p.grouping?f.p.groupingView:false;$.each(f.p.colModel,function(k,l){h=this.sorttype||"text";if(h=="date"||h=="datetime"){if(this.formatter&&typeof this.formatter==="string"&&this.formatter=="date"){if(this.formatoptions&&this.formatoptions.srcformat){g=this.formatoptions.srcformat}else{g=$.jgrid.formatter.date.srcformat}if(this.formatoptions&&this.formatoptions.newformat){i=this.formatoptions.newformat}else{i=$.jgrid.formatter.date.newformat}}else{g=i=this.datefmt||"Y-m-d"}c[this.name]={stype:h,srcfmt:g,newfmt:i}}else{c[this.name]={stype:h,srcfmt:"",newfmt:""}}if(f.p.grouping&&this.name==j.groupField[0]){var m=this.name;if(typeof this.index!="undefined"){m=this.index}d[0]=c[m];e.push(m)}if(!b&&(this.index==f.p.sortname||this.name==f.p.sortname)){a=this.name;b=true}});if(f.p.treeGrid){$(f).jqGrid("SortTree",a,f.p.sortorder,c[a].stype,c[a].srcfmt);return}var k={eq:function(a,b){return a.equals},ne:function(a,b){return a.notEquals},lt:function(a,b){return a.less},le:function(a,b){return a.lessOrEquals},gt:function(a,b){return a.greater},ge:function(a,b){return a.greaterOrEquals},cn:function(a,b){return a.contains},nc:function(a,b){return b==="OR"?a.orNot().contains:a.andNot().contains},bw:function(a,b){return a.startsWith},bn:function(a,b){return b==="OR"?a.orNot().startsWith:a.andNot().startsWith},en:function(a,b){return b==="OR"?a.orNot().endsWith:a.andNot().endsWith},ew:function(a,b){return a.endsWith},ni:function(a,b){return b==="OR"?a.orNot().equals:a.andNot().equals},"in":function(a,b){return a.equals},nu:function(a,b){return a.isNull},nn:function(a,b){return b==="OR"?a.orNot().isNull:a.andNot().isNull}},l=$.jgrid.from(f.p.data);if(f.p.ignoreCase){l=l.ignoreCase()}if(f.p.search===true){var n=f.p.postData.filters;if(n){if(typeof n=="string"){n=$.jgrid.parse(n)}m(n)}else{try{l=k[f.p.postData.searchOper](l)(f.p.postData.searchField,f.p.postData.searchString,c[f.p.postData.searchField])}catch(o){}}}if(f.p.grouping){l.orderBy(e,j.groupOrder[0],d[0].stype,d[0].srcfmt);j.groupDataSorted=true}if(a&&f.p.sortorder&&b){if(f.p.sortorder.toUpperCase()=="DESC"){l.orderBy(f.p.sortname,"d",c[a].stype,c[a].srcfmt)}else{l.orderBy(f.p.sortname,"a",c[a].stype,c[a].srcfmt)}}var p=l.select(),q=parseInt(f.p.rowNum,10),r=p.length,s=parseInt(f.p.page,10),t=Math.ceil(r/q),u={};p=p.slice((s-1)*q,s*q);l=null;c=null;u[f.p.localReader.total]=t;u[f.p.localReader.page]=s;u[f.p.localReader.records]=r;u[f.p.localReader.root]=p;u[f.p.localReader.userdata]=f.p.userData;p=null;return u},A=function(a,b){var c,d,e,g,h,i,j,k="",l,n=f.p.pager?"_"+$.jgrid.jqID(f.p.pager.substr(1)):"",o=f.p.toppager?"_"+f.p.toppager.substr(1):"";e=parseInt(f.p.page,10)-1;if(e<0){e=0}e=e*parseInt(f.p.rowNum,10);h=e+f.p.reccount;if(f.p.scroll){var p=$("tbody:first > tr:gt(0)",f.grid.bDiv);e=h-p.length;f.p.reccount=p.length;var q=p.outerHeight()||f.grid.prevRowHeight;if(q){var r=e*q;var s=parseInt(f.p.records,10)*q;$(">div:first",f.grid.bDiv).css({height:s}).children("div:first").css({height:r,display:r?"":"none"})}f.grid.bDiv.scrollLeft=f.grid.hDiv.scrollLeft}k=f.p.pager?f.p.pager:"";k+=f.p.toppager?k?","+f.p.toppager:f.p.toppager:"";if(k){j=$.jgrid.formatter.integer||{};c=m(f.p.page);d=m(f.p.lastpage);$(".selbox",k)[this.p.useProp?"prop":"attr"]("disabled",false);if(f.p.pginput===true){$(".ui-pg-input",k).val(f.p.page);l=f.p.toppager?"#sp_1"+n+",#sp_1"+o:"#sp_1"+n;$(l).html($.fmatter?$.fmatter.util.NumberFormat(f.p.lastpage,j):f.p.lastpage)}if(f.p.viewrecords){if(f.p.reccount===0){$(".ui-paging-info",k).html(f.p.emptyrecords)}else{g=e+1;i=f.p.records;if($.fmatter){g=$.fmatter.util.NumberFormat(g,j);h=$.fmatter.util.NumberFormat(h,j);i=$.fmatter.util.NumberFormat(i,j)}$(".ui-paging-info",k).html($.jgrid.format(f.p.recordtext,g,h,i))}}if(f.p.pgbuttons===true){if(c<=0){c=d=0}if(c==1||c===0){$("#first"+n+", #prev"+n).addClass("ui-state-disabled").removeClass("ui-state-hover");if(f.p.toppager){$("#first_t"+o+", #prev_t"+o).addClass("ui-state-disabled").removeClass("ui-state-hover")}}else{$("#first"+n+", #prev"+n).removeClass("ui-state-disabled");if(f.p.toppager){$("#first_t"+o+", #prev_t"+o).removeClass("ui-state-disabled")}}if(c==d||c===0){$("#next"+n+", #last"+n).addClass("ui-state-disabled").removeClass("ui-state-hover");if(f.p.toppager){$("#next_t"+o+", #last_t"+o).addClass("ui-state-disabled").removeClass("ui-state-hover")}}else{$("#next"+n+", #last"+n).removeClass("ui-state-disabled");if(f.p.toppager){$("#next_t"+o+", #last_t"+o).removeClass("ui-state-disabled")}}}}if(a===true&&f.p.rownumbers===true){$("td.jqgrid-rownum",f.rows).each(function(a){$(this).html(e+1+a)})}if(b&&f.p.jqgdnd){$(f).jqGrid("gridDnD","updateDnD")}if($.isFunction(f.p.gridComplete)){f.p.gridComplete.call(f)}},B=function(){f.grid.hDiv.loading=true;if(f.p.hiddengrid){return}switch(f.p.loadui){case"disable":break;case"enable":$("#load_"+$.jgrid.jqID(f.p.id)).show();break;case"block":$("#lui_"+$.jgrid.jqID(f.p.id)).show();$("#load_"+$.jgrid.jqID(f.p.id)).show();break}},C=function(){f.grid.hDiv.loading=false;switch(f.p.loadui){case"disable":break;case"enable":$("#load_"+$.jgrid.jqID(f.p.id)).hide();break;case"block":$("#lui_"+$.jgrid.jqID(f.p.id)).hide();$("#load_"+$.jgrid.jqID(f.p.id)).hide();break}},D=function(a){if(!f.grid.hDiv.loading){var b=f.p.scroll&&a===false;var c={},d,e,g=f.p.prmNames;if(f.p.page<=0){f.p.page=1}if(g.search!==null){c[g.search]=f.p.search}if(g.nd!==null){c[g.nd]=(new Date).getTime()}if(g.rows!==null){c[g.rows]=f.p.rowNum}if(g.page!==null){c[g.page]=f.p.page}if(g.sort!==null){c[g.sort]=f.p.sortname}if(g.order!==null){c[g.order]=f.p.sortorder}if(f.p.rowTotal!==null&&g.totalrows!==null){c[g.totalrows]=f.p.rowTotal}var h=f.p.loadComplete;var i=$.isFunction(h);if(!i){h=null}var j=0;a=a||1;if(a>1){if(g.npage!==null){c[g.npage]=a;j=a-1;a=1}else{h=function(b){f.p.page++;f.grid.hDiv.loading=false;if(i){f.p.loadComplete.call(f,b)}D(a-1)}}}else if(g.npage!==null){delete f.p.postData[g.npage]}if(f.p.grouping){$(f).jqGrid("groupingSetup");if(f.p.groupingView.groupDataSorted===true){c[g.sort]=f.p.groupingView.groupField[0]+" "+f.p.groupingView.groupOrder[0]+", "+c[g.sort]}}$.extend(f.p.postData,c);var k=!f.p.scroll?1:f.rows.length-1;if($.isFunction(f.p.datatype)){f.p.datatype.call(f,f.p.postData,"load_"+f.p.id);return}else if($.isFunction(f.p.beforeRequest)){var l=f.p.beforeRequest.call(f);if(l===undefined){l=true}if(l===false){return}}d=f.p.datatype.toLowerCase();switch(d){case"json":case"jsonp":case"xml":case"script":$.ajax($.extend({url:f.p.url,type:f.p.mtype,dataType:d,data:$.isFunction(f.p.serializeGridData)?f.p.serializeGridData.call(f,f.p.postData):f.p.postData,success:function(c,e,g){if($.isFunction(f.p.beforeProcessing)){f.p.beforeProcessing.call(f,c,e,g)}if(d==="xml"){x(c,f.grid.bDiv,k,a>1,j)}else{y(c,f.grid.bDiv,k,a>1,j)}if(h){h.call(f,c)}if(b){f.grid.populateVisible()}if(f.p.loadonce||f.p.treeGrid){f.p.datatype="local"}c=null;if(a===1){C()}},error:function(b,c,d){if($.isFunction(f.p.loadError)){f.p.loadError.call(f,b,c,d)}if(a===1){C()}b=null},beforeSend:function(a,b){var c=true;if($.isFunction(f.p.loadBeforeSend)){c=f.p.loadBeforeSend.call(f,a,b)}if(c===undefined){c=true}if(c===false){return false}else{B()}}},$.jgrid.ajaxOptions,f.p.ajaxGridOptions));break;case"xmlstring":B();e=$.jgrid.stringToDoc(f.p.datastr);x(e,f.grid.bDiv);if(i){f.p.loadComplete.call(f,e)}f.p.datatype="local";f.p.datastr=null;C();break;case"jsonstring":B();if(typeof f.p.datastr=="string"){e=$.jgrid.parse(f.p.datastr)}else{e=f.p.datastr}y(e,f.grid.bDiv);if(i){f.p.loadComplete.call(f,e)}f.p.datatype="local";f.p.datastr=null;C();break;case"local":case"clientside":B();f.p.datatype="local";var m=z();y(m,f.grid.bDiv,k,a>1,j);if(h){h.call(f,m)}if(b){f.grid.populateVisible()}C();break}}},E=function(a,b){var c="<td class='ui-pg-button ui-state-disabled' style='width:4px;'><span class='ui-separator'></span></td>",d="",g="<table cellspacing='0' cellpadding='0' border='0' style='table-layout:auto;' class='ui-pg-table'><tbody><tr>",h="",i,j,k,l,n,o,p,q=function(a){var b;if($.isFunction(f.p.onPaging)){b=f.p.onPaging.call(f,a)}f.p.selrow=null;if(f.p.multiselect){f.p.selarrrow=[];$("#cb_"+$.jgrid.jqID(f.p.id),f.grid.hDiv)[f.p.useProp?"prop":"attr"]("checked",false)}f.p.savedRow=[];if(b=="stop"){return false}return true};a=a.substr(1);b+="_"+a;i="pg_"+a;j=a+"_left";k=a+"_center";l=a+"_right";$("#"+$.jgrid.jqID(a)).append("<div id='"+i+"' class='ui-pager-control' role='group'><table cellspacing='0' cellpadding='0' border='0' class='ui-pg-table' style='width:auto;table-layout:fixed;height:100%;' role='row'><tbody><tr><td id='"+j+"' align='left'></td><td id='"+k+"' align='center' style='white-space:pre;'></td><td id='"+l+"' align='right'></td></tr></tbody></table></div>").attr("dir","ltr");if(f.p.rowList.length>0){h="<td dir='"+e+"'>";h+="<select class='ui-pg-selbox' role='listbox'>";for(p=0;p<f.p.rowList.length;p++){h+='<option role="option" value="'+f.p.rowList[p]+'"'+(f.p.rowNum==f.p.rowList[p]?' selected="selected"':"")+">"+f.p.rowList[p]+"</option>"}h+="</select></td>"}if(e=="rtl"){g+=h}if(f.p.pginput===true){d="<td dir='"+e+"'>"+$.jgrid.format(f.p.pgtext||"","<input class='ui-pg-input' type='text' size='2' maxlength='7' value='0' role='textbox'/>","<span id='sp_1_"+$.jgrid.jqID(a)+"'></span>")+"</td>"}if(f.p.pgbuttons===true){var r=["first"+b,"prev"+b,"next"+b,"last"+b];if(e=="rtl"){r.reverse()}g+="<td id='"+r[0]+"' class='ui-pg-button ui-corner-all'><span class='ui-icon ui-icon-seek-first'></span></td>";g+="<td id='"+r[1]+"' class='ui-pg-button ui-corner-all'><span class='ui-icon ui-icon-seek-prev'></span></td>";g+=d!==""?c+d+c:"";g+="<td id='"+r[2]+"' class='ui-pg-button ui-corner-all'><span class='ui-icon ui-icon-seek-next'></span></td>";g+="<td id='"+r[3]+"' class='ui-pg-button ui-corner-all'><span class='ui-icon ui-icon-seek-end'></span></td>"}else if(d!==""){g+=d}if(e=="ltr"){g+=h}g+="</tr></tbody></table>";if(f.p.viewrecords===true){$("td#"+a+"_"+f.p.recordpos,"#"+i).append("<div dir='"+e+"' style='text-align:"+f.p.recordpos+"' class='ui-paging-info'></div>")}$("td#"+a+"_"+f.p.pagerpos,"#"+i).append(g);o=$(".ui-jqgrid").css("font-size")||"11px";$(document.body).append("<div id='testpg' class='ui-jqgrid ui-widget ui-widget-content' style='font-size:"+o+";visibility:hidden;' ></div>");n=$(g).clone().appendTo("#testpg").width();$("#testpg").remove();if(n>0){if(d!==""){n+=50}$("td#"+a+"_"+f.p.pagerpos,"#"+i).width(n)}f.p._nvtd=[];f.p._nvtd[0]=n?Math.floor((f.p.width-n)/2):Math.floor(f.p.width/3);f.p._nvtd[1]=0;g=null;$(".ui-pg-selbox","#"+i).bind("change",function(){f.p.page=Math.round(f.p.rowNum*(f.p.page-1)/this.value-.5)+1;f.p.rowNum=this.value;if(b){$(".ui-pg-selbox",f.p.pager).val(this.value)}else if(f.p.toppager){$(".ui-pg-selbox",f.p.toppager).val(this.value)}if(!q("records")){return false}D();return false});if(f.p.pgbuttons===true){$(".ui-pg-button","#"+i).hover(function(a){if($(this).hasClass("ui-state-disabled")){this.style.cursor="default"}else{$(this).addClass("ui-state-hover");this.style.cursor="pointer"}},function(a){if($(this).hasClass("ui-state-disabled")){}else{$(this).removeClass("ui-state-hover");this.style.cursor="default"}});$("#first"+$.jgrid.jqID(b)+", #prev"+$.jgrid.jqID(b)+", #next"+$.jgrid.jqID(b)+", #last"+$.jgrid.jqID(b)).click(function(a){var c=m(f.p.page,1),d=m(f.p.lastpage,1),e=false,g=true,h=true,i=true,j=true;if(d===0||d===1){g=false;h=false;i=false;j=false}else if(d>1&&c>=1){if(c===1){g=false;h=false}else if(c>1&&c<d){}else if(c===d){i=false;j=false}}else if(d>1&&c===0){i=false;j=false;c=d-1}if(this.id==="first"+b&&g){f.p.page=1;e=true}if(this.id==="prev"+b&&h){f.p.page=c-1;e=true}if(this.id==="next"+b&&i){f.p.page=c+1;e=true}if(this.id==="last"+b&&j){f.p.page=d;e=true}if(e){if(!q(this.id)){return false}D()}return false})}if(f.p.pginput===true){$("input.ui-pg-input","#"+i).keypress(function(a){var b=a.charCode?a.charCode:a.keyCode?a.keyCode:0;if(b==13){f.p.page=$(this).val()>0?$(this).val():f.p.page;if(!q("user")){return false}D();return false}return this})}},F=function(a,b,c,d){if(!f.p.colModel[b].sortable){return}var e;if(f.p.savedRow.length>0){return}if(!c){if(f.p.lastsort==b){if(f.p.sortorder=="asc"){f.p.sortorder="desc"}else if(f.p.sortorder=="desc"){f.p.sortorder="asc"}}else{f.p.sortorder=f.p.colModel[b].firstsortorder||"asc"}f.p.page=1}if(d){if(f.p.lastsort==b&&f.p.sortorder==d&&!c){return}else{f.p.sortorder=d}}var g=f.grid.headers[f.p.lastsort].el,h=f.grid.headers[b].el;$("span.ui-grid-ico-sort",g).addClass("ui-state-disabled");$(g).attr("aria-selected","false");$("span.ui-icon-"+f.p.sortorder,h).removeClass("ui-state-disabled");$(h).attr("aria-selected","true");if(!f.p.viewsortcols[0]){if(f.p.lastsort!=b){$("span.s-ico",g).hide();$("span.s-ico",h).show()}}a=a.substring(5+f.p.id.length+1);f.p.sortname=f.p.colModel[b].index||a;e=f.p.sortorder;if($.isFunction(f.p.onSortCol)){if(f.p.onSortCol.call(f,a,b,e)=="stop"){f.p.lastsort=b;return}}if(f.p.datatype=="local"){if(f.p.deselectAfterSort){$(f).jqGrid("resetSelection")}}else{f.p.selrow=null;if(f.p.multiselect){$("#cb_"+$.jgrid.jqID(f.p.id),f.grid.hDiv)[f.p.useProp?"prop":"attr"]("checked",false)}f.p.selarrrow=[];f.p.savedRow=[]}if(f.p.scroll){var i=f.grid.bDiv.scrollLeft;v(f.grid.bDiv,true,false);f.grid.hDiv.scrollLeft=i}if(f.p.subGrid&&f.p.datatype=="local"){$("td.sgexpanded","#"+$.jgrid.jqID(f.p.id)).each(function(){$(this).trigger("click")})}D();f.p.lastsort=b;if(f.p.sortname!=a&&b){f.p.lastsort=b}},G=function(){var a=0,b=j?0:f.p.cellLayout,d=0,e,g=f.p.scrollOffset,h,i=false,k,l=0,n=0,o;$.each(f.p.colModel,function(c){if(typeof this.hidden==="undefined"){this.hidden=false}this.widthOrg=h=m(this.width,0);if(this.hidden===false){a+=h+b;if(this.fixed){l+=h+b}else{d++}n++}});if(isNaN(f.p.width)){f.p.width=c.width=a}else{c.width=f.p.width}f.p.tblwidth=a;if(f.p.shrinkToFit===false&&f.p.forceFit===true){f.p.forceFit=false}if(f.p.shrinkToFit===true&&d>0){k=c.width-b*d-l;if(isNaN(f.p.height)){}else{k-=g;i=true}a=0;$.each(f.p.colModel,function(c){if(this.hidden===false&&!this.fixed){h=Math.round(k*this.width/(f.p.tblwidth-b*d-l));this.width=h;a+=h;e=c}});o=0;if(i){if(c.width-l-(a+b*d)!==g){o=c.width-l-(a+b*d)-g}}else if(!i&&Math.abs(c.width-l-(a+b*d))!==1){o=c.width-l-(a+b*d)}f.p.colModel[e].width+=o;f.p.tblwidth=a+o+b*d+l;if(f.p.tblwidth>f.p.width){f.p.colModel[e].width-=f.p.tblwidth-parseInt(f.p.width,10);f.p.tblwidth=f.p.width}}},H=function(a){var b=a,c=a,d;for(d=a+1;d<f.p.colModel.length;d++){if(f.p.colModel[d].hidden!==true){c=d;break}}return c-b},I=function(a){var b,c={},d=j?0:f.p.cellLayout;c[0]=c[1]=c[2]=0;for(b=0;b<=a;b++){if(f.p.colModel[b].hidden===false){c[0]+=f.p.colModel[b].width+d}}if(f.p.direction=="rtl"){c[0]=f.p.width-c[0]}c[0]=c[0]-f.grid.bDiv.scrollLeft;if($(f.grid.cDiv).is(":visible")){c[1]+=$(f.grid.cDiv).height()+parseInt($(f.grid.cDiv).css("padding-top"),10)+parseInt($(f.grid.cDiv).css("padding-bottom"),10)}if(f.p.toolbar[0]===true&&(f.p.toolbar[1]=="top"||f.p.toolbar[1]=="both")){c[1]+=$(f.grid.uDiv).height()+parseInt($(f.grid.uDiv).css("border-top-width"),10)+parseInt($(f.grid.uDiv).css("border-bottom-width"),10)}if(f.p.toppager){c[1]+=$(f.grid.topDiv).height()+parseInt($(f.grid.topDiv).css("border-bottom-width"),10)}c[2]+=$(f.grid.bDiv).height()+$(f.grid.hDiv).height();return c},J=function(a){var b,c=f.grid.headers,d=$.jgrid.getCellIndex(a);for(b=0;b<c.length;b++){if(a===c[b].el){d=b;break}}return d};this.p.id=this.id;if($.inArray(f.p.multikey,l)==-1){f.p.multikey=false}f.p.keyIndex=false;for(d=0;d<f.p.colModel.length;d++){f.p.colModel[d]=$.extend(true,{},f.p.cmTemplate,f.p.colModel[d].template||{},f.p.colModel[d]);if(f.p.keyIndex===false&&f.p.colModel[d].key===true){f.p.keyIndex=d}}f.p.sortorder=f.p.sortorder.toLowerCase();if(f.p.grouping===true){f.p.scroll=false;f.p.rownumbers=false;f.p.subGrid=false;f.p.treeGrid=false;f.p.gridview=true}if(this.p.treeGrid===true){try{$(this).jqGrid("setTreeGrid")}catch(K){}if(f.p.datatype!="local"){f.p.localReader={id:"_id_"}}}if(this.p.subGrid){try{$(f).jqGrid("setSubGrid")}catch(L){}}if(this.p.multiselect){this.p.colNames.unshift("<input role='checkbox' id='cb_"+this.p.id+"' class='cbox' type='checkbox'/>");this.p.colModel.unshift({name:"cb",width:j?f.p.multiselectWidth+f.p.cellLayout:f.p.multiselectWidth,sortable:false,resizable:false,hidedlg:true,search:false,align:"center",fixed:true})}if(this.p.rownumbers){this.p.colNames.unshift("");this.p.colModel.unshift({name:"rn",width:f.p.rownumWidth,sortable:false,resizable:false,hidedlg:true,search:false,align:"center",fixed:true})}f.p.xmlReader=$.extend(true,{root:"rows",row:"row",page:"rows>page",total:"rows>total",records:"rows>records",repeatitems:true,cell:"cell",id:"[id]",userdata:"userdata",subgrid:{root:"rows",row:"row",repeatitems:true,cell:"cell"}},f.p.xmlReader);f.p.jsonReader=$.extend(true,{root:"rows",page:"page",total:"total",records:"records",repeatitems:true,cell:"cell",id:"id",userdata:"userdata",subgrid:{root:"rows",repeatitems:true,cell:"cell"}},f.p.jsonReader);f.p.localReader=$.extend(true,{root:"rows",page:"page",total:"total",records:"records",repeatitems:false,cell:"cell",id:"id",userdata:"userdata",subgrid:{root:"rows",repeatitems:true,cell:"cell"}},f.p.localReader);if(f.p.scroll){f.p.pgbuttons=false;f.p.pginput=false;f.p.rowList=[]}if(f.p.data.length){w()}var M="<thead><tr class='ui-jqgrid-labels' role='rowheader'>",N,O,P,Q,R,S,T,U,V,W="",X="";if(f.p.shrinkToFit===true&&f.p.forceFit===true){for(d=f.p.colModel.length-1;d>=0;d--){if(!f.p.colModel[d].hidden){f.p.colModel[d].resizable=false;break}}}if(f.p.viewsortcols[1]=="horizontal"){W=" ui-i-asc";X=" ui-i-desc"}N=i?"class='ui-th-div-ie'":"";V="<span class='s-ico' style='display:none'><span sort='asc' class='ui-grid-ico-sort ui-icon-asc"+W+" ui-state-disabled ui-icon ui-icon-triangle-1-n ui-sort-"+e+"'></span>";V+="<span sort='desc' class='ui-grid-ico-sort ui-icon-desc"+X+" ui-state-disabled ui-icon ui-icon-triangle-1-s ui-sort-"+e+"'></span></span>";for(d=0;d<this.p.colNames.length;d++){var Y=f.p.headertitles?' title="'+$.jgrid.stripHtml(f.p.colNames[d])+'"':"";M+="<th id='"+f.p.id+"_"+f.p.colModel[d].name+"' role='columnheader' class='ui-state-default ui-th-column ui-th-"+e+"'"+Y+">";O=f.p.colModel[d].index||f.p.colModel[d].name;M+="<div id='jqgh_"+f.p.id+"_"+f.p.colModel[d].name+"' "+N+">"+f.p.colNames[d];if(!f.p.colModel[d].width){f.p.colModel[d].width=150}else{f.p.colModel[d].width=parseInt(f.p.colModel[d].width,10)}if(typeof f.p.colModel[d].title!=="boolean"){f.p.colModel[d].title=true}if(O==f.p.sortname){f.p.lastsort=d}M+=V+"</div></th>"}M+="</tr></thead>";V=null;$(this).append(M);$("thead tr:first th",this).hover(function(){$(this).addClass("ui-state-hover")},function(){$(this).removeClass("ui-state-hover")});if(this.p.multiselect){var Z=[],_;$("#cb_"+$.jgrid.jqID(f.p.id),this).bind("click",function(){f.p.selarrrow=[];if(this.checked){$(f.rows).each(function(a){if(a>0){if(!$(this).hasClass("ui-subgrid")&&!$(this).hasClass("jqgroup")&&!$(this).hasClass("ui-state-disabled")){$("#jqg_"+$.jgrid.jqID(f.p.id)+"_"+$.jgrid.jqID(this.id))[f.p.useProp?"prop":"attr"]("checked",true);$(this).addClass("ui-state-highlight").attr("aria-selected","true");f.p.selarrrow.push(this.id);f.p.selrow=this.id}}});_=true;Z=[]}else{$(f.rows).each(function(a){if(a>0){if(!$(this).hasClass("ui-subgrid")&&!$(this).hasClass("ui-state-disabled")){$("#jqg_"+$.jgrid.jqID(f.p.id)+"_"+$.jgrid.jqID(this.id))[f.p.useProp?"prop":"attr"]("checked",false);$(this).removeClass("ui-state-highlight").attr("aria-selected","false");Z.push(this.id)}}});f.p.selrow=null;_=false}if($.isFunction(f.p.onSelectAll)){f.p.onSelectAll.call(f,_?f.p.selarrrow:Z,_)}})}if(f.p.autowidth===true){var ba=$(k).innerWidth();f.p.width=ba>0?ba:"nw"}G();$(k).css("width",c.width+"px").append("<div class='ui-jqgrid-resize-mark' id='rs_m"+f.p.id+"'>&#160;</div>");$(g).css("width",c.width+"px");M=$("thead:first",f).get(0);var bb="";if(f.p.footerrow){bb+="<table role='grid' style='width:"+f.p.tblwidth+"px' class='ui-jqgrid-ftable' cellspacing='0' cellpadding='0' border='0'><tbody><tr role='row' class='ui-widget-content footrow footrow-"+e+"'>"}var bc=$("tr:first",M),bd="<tr class='jqgfirstrow' role='row' style='height:auto'>";f.p.disableClick=false;$("th",bc).each(function(a){P=f.p.colModel[a].width;if(typeof f.p.colModel[a].resizable==="undefined"){f.p.colModel[a].resizable=true}if(f.p.colModel[a].resizable){Q=document.createElement("span");$(Q).html("&#160;").addClass("ui-jqgrid-resize ui-jqgrid-resize-"+e);if(!$.browser.opera){$(Q).css("cursor","col-resize")}$(this).addClass(f.p.resizeclass)}else{Q=""}$(this).css("width",P+"px").prepend(Q);var b="";if(f.p.colModel[a].hidden){$(this).css("display","none");b="display:none;"}bd+="<td role='gridcell' style='height:0px;width:"+P+"px;"+b+"'></td>";c.headers[a]={width:P,el:this};R=f.p.colModel[a].sortable;if(typeof R!=="boolean"){f.p.colModel[a].sortable=true;R=true}var d=f.p.colModel[a].name;if(!(d=="cb"||d=="subgrid"||d=="rn")){if(f.p.viewsortcols[2]){$("div",this).addClass("ui-jqgrid-sortable")}}if(R){if(f.p.viewsortcols[0]){$("div span.s-ico",this).show();if(a==f.p.lastsort){$("div span.ui-icon-"+f.p.sortorder,this).removeClass("ui-state-disabled")}}else if(a==f.p.lastsort){$("div span.s-ico",this).show();$("div span.ui-icon-"+f.p.sortorder,this).removeClass("ui-state-disabled")}}if(f.p.footerrow){bb+="<td role='gridcell' "+n(a,0,"",null,"",false)+">&#160;</td>"}}).mousedown(function(a){if($(a.target).closest("th>span.ui-jqgrid-resize").length!=1){return}var b=J(this);if(f.p.forceFit===true){f.p.nv=H(b)}c.dragStart(b,a,I(b));return false}).click(function(a){if(f.p.disableClick){f.p.disableClick=false;return false}var b="th>div.ui-jqgrid-sortable",c,d;if(!f.p.viewsortcols[2]){b="th>div>span>span.ui-grid-ico-sort"}var e=$(a.target).closest(b);if(e.length!=1){return}var g=J(this);if(!f.p.viewsortcols[2]){c=true;d=e.attr("sort")}F($("div",this)[0].id,g,c,d);return false});if(f.p.sortable&&$.fn.sortable){try{$(f).jqGrid("sortableColumns",bc)}catch(be){}}if(f.p.footerrow){bb+="</tr></tbody></table>"}bd+="</tr>";U=document.createElement("tbody");this.appendChild(U);$(this).addClass("ui-jqgrid-btable").append(bd);bd=null;var bf=$("<table class='ui-jqgrid-htable' style='width:"+f.p.tblwidth+"px' role='grid' aria-labelledby='gbox_"+this.id+"' cellspacing='0' cellpadding='0' border='0'></table>").append(M),bg=f.p.caption&&f.p.hiddengrid===true?true:false,bh=$("<div class='ui-jqgrid-hbox"+(e=="rtl"?"-rtl":"")+"'></div>");M=null;c.hDiv=document.createElement("div");$(c.hDiv).css({width:c.width+"px"}).addClass("ui-state-default ui-jqgrid-hdiv").append(bh);$(bh).append(bf);bf=null;if(bg){$(c.hDiv).hide()}if(f.p.pager){if(typeof f.p.pager=="string"){if(f.p.pager.substr(0,1)!="#"){f.p.pager="#"+f.p.pager}}else{f.p.pager="#"+$(f.p.pager).attr("id")}$(f.p.pager).css({width:c.width+"px"}).appendTo(k).addClass("ui-state-default ui-jqgrid-pager ui-corner-bottom");if(bg){$(f.p.pager).hide()}E(f.p.pager,"")}if(f.p.cellEdit===false&&f.p.hoverrows===true){$(f).bind("mouseover",function(a){T=$(a.target).closest("tr.jqgrow");if($(T).attr("class")!=="ui-subgrid"){$(T).addClass("ui-state-hover")}}).bind("mouseout",function(a){T=$(a.target).closest("tr.jqgrow");$(T).removeClass("ui-state-hover")})}var bi,bj;$(f).before(c.hDiv).click(function(a){S=a.target;T=$(S,f.rows).closest("tr.jqgrow");if($(T).length===0||T[0].className.indexOf("ui-state-disabled")>-1){return this}var b=$(S).hasClass("cbox"),c=true;if($.isFunction(f.p.beforeSelectRow)){c=f.p.beforeSelectRow.call(f,T[0].id,a)}if(S.tagName=="A"||(S.tagName=="INPUT"||S.tagName=="TEXTAREA"||S.tagName=="OPTION"||S.tagName=="SELECT")&&!b){return this}if(c===true){if(f.p.cellEdit===true){if(f.p.multiselect&&b){$(f).jqGrid("setSelection",T[0].id,true)}else{bi=T[0].rowIndex;bj=$.jgrid.getCellIndex(S);try{$(f).jqGrid("editCell",bi,bj,true)}catch(d){}}}else if(!f.p.multikey){if(f.p.multiselect&&f.p.multiboxonly){if(b){$(f).jqGrid("setSelection",T[0].id,true)}else{$(f.p.selarrrow).each(function(a,b){var c=f.rows.namedItem(b);$(c).removeClass("ui-state-highlight");$("#jqg_"+$.jgrid.jqID(f.p.id)+"_"+$.jgrid.jqID(b))[f.p.useProp?"prop":"attr"]("checked",false)});f.p.selarrrow=[];$("#cb_"+$.jgrid.jqID(f.p.id),f.grid.hDiv)[f.p.useProp?"prop":"attr"]("checked",false);$(f).jqGrid("setSelection",T[0].id,true)}}else{$(f).jqGrid("setSelection",T[0].id,true)}}else{if(a[f.p.multikey]){$(f).jqGrid("setSelection",T[0].id,true)}else if(f.p.multiselect&&b){b=$("#jqg_"+$.jgrid.jqID(f.p.id)+"_"+T[0].id).is(":checked");$("#jqg_"+$.jgrid.jqID(f.p.id)+"_"+T[0].id)[f.p.useProp?"prop":"attr"]("checked",b)}}if($.isFunction(f.p.onCellSelect)){bi=T[0].id;bj=$.jgrid.getCellIndex(S);f.p.onCellSelect.call(f,bi,bj,$(S).html(),a)}}return this}).bind("reloadGrid",function(a,b){if(f.p.treeGrid===true){f.p.datatype=f.p.treedatatype}if(b&&b.current){f.grid.selectionPreserver(f)}if(f.p.datatype=="local"){$(f).jqGrid("resetSelection");if(f.p.data.length){w()}}else if(!f.p.treeGrid){f.p.selrow=null;if(f.p.multiselect){f.p.selarrrow=[];$("#cb_"+$.jgrid.jqID(f.p.id),f.grid.hDiv)[f.p.useProp?"prop":"attr"]("checked",false)}f.p.savedRow=[]}if(f.p.scroll){v(f.grid.bDiv,true,false)}if(b&&b.page){var c=b.page;if(c>f.p.lastpage){c=f.p.lastpage}if(c<1){c=1}f.p.page=c;if(f.grid.prevRowHeight){f.grid.bDiv.scrollTop=(c-1)*f.grid.prevRowHeight*f.p.rowNum}else{f.grid.bDiv.scrollTop=0}}if(f.grid.prevRowHeight&&f.p.scroll){delete f.p.lastpage;f.grid.populateVisible()}else{f.grid.populate()}return false});if($.isFunction(this.p.ondblClickRow)){$(this).dblclick(function(a){S=a.target;T=$(S,f.rows).closest("tr.jqgrow");if($(T).length===0){return false}bi=T[0].rowIndex;bj=$.jgrid.getCellIndex(S);f.p.ondblClickRow.call(f,$(T).attr("id"),bi,bj,a);return false})}if($.isFunction(this.p.onRightClickRow)){$(this).bind("contextmenu",function(a){S=a.target;T=$(S,f.rows).closest("tr.jqgrow");if($(T).length===0){return false}if(!f.p.multiselect){$(f).jqGrid("setSelection",T[0].id,true)}bi=T[0].rowIndex;bj=$.jgrid.getCellIndex(S);f.p.onRightClickRow.call(f,$(T).attr("id"),bi,bj,a);return false})}c.bDiv=document.createElement("div");if(i){if(String(f.p.height).toLowerCase()==="auto"){f.p.height="100%"}}$(c.bDiv).append($('<div style="position:relative;'+(i&&$.browser.version<8?"height:0.01%;":"")+'"></div>').append("<div></div>").append(this)).addClass("ui-jqgrid-bdiv").css({height:f.p.height+(isNaN(f.p.height)?"":"px"),width:c.width+"px"}).scroll(c.scrollGrid);$("table:first",c.bDiv).css({width:f.p.tblwidth+"px"});if(i){if($("tbody",this).size()==2){$("tbody:gt(0)",this).remove()}if(f.p.multikey){$(c.bDiv).bind("selectstart",function(){return false})}}else{if(f.p.multikey){$(c.bDiv).bind("mousedown",function(){return false})}}if(bg){$(c.bDiv).hide()}c.cDiv=document.createElement("div");var bk=f.p.hidegrid===true?$("<a role='link' href='javascript:void(0)'/>").addClass("ui-jqgrid-titlebar-close HeaderButton").hover(function(){bk.addClass("ui-state-hover")},function(){bk.removeClass("ui-state-hover")}).append("<span class='ui-icon ui-icon-circle-triangle-n'></span>").css(e=="rtl"?"left":"right","0px"):"";$(c.cDiv).append(bk).append("<span class='ui-jqgrid-title"+(e=="rtl"?"-rtl":"")+"'>"+f.p.caption+"</span>").addClass("ui-jqgrid-titlebar ui-widget-header ui-corner-top ui-helper-clearfix");$(c.cDiv).insertBefore(c.hDiv);if(f.p.toolbar[0]){c.uDiv=document.createElement("div");if(f.p.toolbar[1]=="top"){$(c.uDiv).insertBefore(c.hDiv)}else if(f.p.toolbar[1]=="bottom"){$(c.uDiv).insertAfter(c.hDiv)}if(f.p.toolbar[1]=="both"){c.ubDiv=document.createElement("div");$(c.uDiv).insertBefore(c.hDiv).addClass("ui-userdata ui-state-default").attr("id","t_"+this.id);$(c.ubDiv).insertAfter(c.hDiv).addClass("ui-userdata ui-state-default").attr("id","tb_"+this.id);if(bg){$(c.ubDiv).hide()}}else{$(c.uDiv).width(c.width).addClass("ui-userdata ui-state-default").attr("id","t_"+this.id)}if(bg){$(c.uDiv).hide()}}if(f.p.toppager){f.p.toppager=$.jgrid.jqID(f.p.id)+"_toppager";c.topDiv=$("<div id='"+f.p.toppager+"'></div>")[0];f.p.toppager="#"+f.p.toppager;$(c.topDiv).insertBefore(c.hDiv).addClass("ui-state-default ui-jqgrid-toppager").width(c.width);E(f.p.toppager,"_t")}if(f.p.footerrow){c.sDiv=$("<div class='ui-jqgrid-sdiv'></div>")[0];bh=$("<div class='ui-jqgrid-hbox"+(e=="rtl"?"-rtl":"")+"'></div>");$(c.sDiv).append(bh).insertAfter(c.hDiv).width(c.width);$(bh).append(bb);c.footers=$(".ui-jqgrid-ftable",c.sDiv)[0].rows[0].cells;if(f.p.rownumbers){c.footers[0].className="ui-state-default jqgrid-rownum"}if(bg){$(c.sDiv).hide()}}bh=null;if(f.p.caption){var bl=f.p.datatype;if(f.p.hidegrid===true){$(".ui-jqgrid-titlebar-close",c.cDiv).click(function(a){var b=$.isFunction(f.p.onHeaderClick),d=".ui-jqgrid-bdiv, .ui-jqgrid-hdiv, .ui-jqgrid-pager, .ui-jqgrid-sdiv",e,g=this;if(f.p.toolbar[0]===true){if(f.p.toolbar[1]=="both"){d+=", #"+$(c.ubDiv).attr("id")}d+=", #"+$(c.uDiv).attr("id")}e=$(d,"#gview_"+$.jgrid.jqID(f.p.id)).length;if(f.p.gridstate=="visible"){$(d,"#gbox_"+$.jgrid.jqID(f.p.id)).slideUp("fast",function(){e--;if(e===0){$("span",g).removeClass("ui-icon-circle-triangle-n").addClass("ui-icon-circle-triangle-s");f.p.gridstate="hidden";if($("#gbox_"+$.jgrid.jqID(f.p.id)).hasClass("ui-resizable")){$(".ui-resizable-handle","#gbox_"+$.jgrid.jqID(f.p.id)).hide()}if(b){if(!bg){f.p.onHeaderClick.call(f,f.p.gridstate,a)}}}})}else if(f.p.gridstate=="hidden"){$(d,"#gbox_"+$.jgrid.jqID(f.p.id)).slideDown("fast",function(){e--;if(e===0){$("span",g).removeClass("ui-icon-circle-triangle-s").addClass("ui-icon-circle-triangle-n");if(bg){f.p.datatype=bl;D();bg=false}f.p.gridstate="visible";if($("#gbox_"+$.jgrid.jqID(f.p.id)).hasClass("ui-resizable")){$(".ui-resizable-handle","#gbox_"+$.jgrid.jqID(f.p.id)).show()}if(b){if(!bg){f.p.onHeaderClick.call(f,f.p.gridstate,a)}}}})}return false});if(bg){f.p.datatype="local";$(".ui-jqgrid-titlebar-close",c.cDiv).trigger("click")}}}else{$(c.cDiv).hide()}$(c.hDiv).after(c.bDiv).mousemove(function(a){if(c.resizing){c.dragMove(a);return false}});$(".ui-jqgrid-labels",c.hDiv).bind("selectstart",function(){return false});$(document).mouseup(function(a){if(c.resizing){c.dragEnd();return false}return true});f.formatCol=n;f.sortData=F;f.updatepager=A;f.refreshIndex=w;f.formatter=function(a,b,c,d,e){return p(a,b,c,d,e)};$.extend(c,{populate:D,emptyRows:v});this.grid=c;f.addXmlData=function(a){x(a,f.grid.bDiv)};f.addJSONData=function(a){y(a,f.grid.bDiv)};this.grid.cols=this.rows[0].cells;D();f.p.hiddengrid=false;$(window).unload(function(){f=null})})};$.jgrid.extend({getGridParam:function(a){var b=this[0];if(!b||!b.grid){return}if(!a){return b.p}else{return typeof b.p[a]!="undefined"?b.p[a]:null}},setGridParam:function(a){return this.each(function(){if(this.grid&&typeof a==="object"){$.extend(true,this.p,a)}})},getDataIDs:function(){var a=[],b=0,c,d=0;this.each(function(){c=this.rows.length;if(c&&c>0){while(b<c){if($(this.rows[b]).hasClass("jqgrow")){a[d]=this.rows[b].id;d++}b++}}});return a},setSelection:function(a,b){return this.each(function(){function i(a){var b=$(c.grid.bDiv)[0].clientHeight,d=$(c.grid.bDiv)[0].scrollTop,e=c.rows[a].offsetTop,f=c.rows[a].clientHeight;if(e+f>=b+d){$(c.grid.bDiv)[0].scrollTop=e-(b+d)+f+d}else if(e<b+d){if(e<d){$(c.grid.bDiv)[0].scrollTop=e}}}var c=this,d,e,f,g,h;if(a===undefined){return}b=b===false?false:true;e=c.rows.namedItem(a+"");if(!e||e.className.indexOf("ui-state-disabled")>-1){return}if(c.p.scrollrows===true){f=c.rows.namedItem(a).rowIndex;if(f>=0){i(f)}}if(!c.p.multiselect){if(e.className!=="ui-subgrid"){if(c.p.selrow!=e.id){$(c.rows.namedItem(c.p.selrow)).removeClass("ui-state-highlight").attr({"aria-selected":"false",tabindex:"-1"});$(e).addClass("ui-state-highlight").attr({"aria-selected":"true",tabindex:"0"});d=true}else{d=false}c.p.selrow=e.id;if(c.p.onSelectRow&&b){c.p.onSelectRow.call(c,e.id,d)}}}else{$("#cb_"+$.jgrid.jqID(c.p.id),c.grid.hDiv)[c.p.useProp?"prop":"attr"]("checked",false);c.p.selrow=e.id;g=$.inArray(c.p.selrow,c.p.selarrrow);if(g===-1){if(e.className!=="ui-subgrid"){$(e).addClass("ui-state-highlight").attr("aria-selected","true")}d=true;$("#jqg_"+$.jgrid.jqID(c.p.id)+"_"+$.jgrid.jqID(c.p.selrow))[c.p.useProp?"prop":"attr"]("checked",d);c.p.selarrrow.push(c.p.selrow)}else{if(e.className!=="ui-subgrid"){$(e).removeClass("ui-state-highlight").attr("aria-selected","false")}d=false;$("#jqg_"+$.jgrid.jqID(c.p.id)+"_"+$.jgrid.jqID(c.p.selrow))[c.p.useProp?"prop":"attr"]("checked",d);c.p.selarrrow.splice(g,1);h=c.p.selarrrow[0];c.p.selrow=h===undefined?null:h}if(c.p.onSelectRow&&b){c.p.onSelectRow.call(c,e.id,d)}}})},resetSelection:function(a){return this.each(function(){var b=this,c,d;if(typeof a!=="undefined"){d=a===b.p.selrow?b.p.selrow:a;$("#"+$.jgrid.jqID(b.p.id)+" tbody:first tr#"+$.jgrid.jqID(d)).removeClass("ui-state-highlight").attr("aria-selected","false");if(b.p.multiselect){$("#jqg_"+$.jgrid.jqID(b.p.id)+"_"+$.jgrid.jqID(d))[b.p.useProp?"prop":"attr"]("checked",false);$("#cb_"+$.jgrid.jqID(b.p.id))[b.p.useProp?"prop":"attr"]("checked",false)}d=null}else if(!b.p.multiselect){if(b.p.selrow){$("#"+$.jgrid.jqID(b.p.id)+" tbody:first tr#"+$.jgrid.jqID(b.p.selrow)).removeClass("ui-state-highlight").attr("aria-selected","false");b.p.selrow=null}}else{$(b.p.selarrrow).each(function(a,d){c=b.rows.namedItem(d);$(c).removeClass("ui-state-highlight").attr("aria-selected","false");$("#jqg_"+$.jgrid.jqID(b.p.id)+"_"+$.jgrid.jqID(d))[b.p.useProp?"prop":"attr"]("checked",false)});$("#cb_"+$.jgrid.jqID(b.p.id))[b.p.useProp?"prop":"attr"]("checked",false);b.p.selarrrow=[]}if(b.p.cellEdit===true){if(parseInt(b.p.iCol,10)>=0&&parseInt(b.p.iRow,10)>=0){$("td:eq("+b.p.iCol+")",b.rows[b.p.iRow]).removeClass("edit-cell ui-state-highlight");$(b.rows[b.p.iRow]).removeClass("selected-row ui-state-hover")}}b.p.savedRow=[]})},getRowData:function(a){var b={},c,d=false,e,f=0;this.each(function(){var g=this,h,i;if(typeof a=="undefined"){d=true;c=[];e=g.rows.length}else{i=g.rows.namedItem(a);if(!i){return b}e=2}while(f<e){if(d){i=g.rows[f]}if($(i).hasClass("jqgrow")){$("td",i).each(function(a){h=g.p.colModel[a].name;if(h!=="cb"&&h!=="subgrid"&&h!=="rn"){if(g.p.treeGrid===true&&h==g.p.ExpandColumn){b[h]=$.jgrid.htmlDecode($("span:first",this).html())}else{try{b[h]=$.unformat(this,{rowId:i.id,colModel:g.p.colModel[a]},a)}catch(c){b[h]=$.jgrid.htmlDecode($(this).html())}}}});if(d){c.push(b);b={}}}f++}});return c?c:b},delRowData:function(a){var b=false,c,d,e;this.each(function(){var f=this;c=f.rows.namedItem(a);if(!c){return false}else{e=c.rowIndex;$(c).remove();f.p.records--;f.p.reccount--;f.updatepager(true,false);b=true;if(f.p.multiselect){d=$.inArray(a,f.p.selarrrow);if(d!=-1){f.p.selarrrow.splice(d,1)}}if(a==f.p.selrow){f.p.selrow=null}}if(f.p.datatype=="local"){var g=f.p._index[a];if(typeof g!="undefined"){f.p.data.splice(g,1);f.refreshIndex()}}if(f.p.altRows===true&&b){var h=f.p.altclass;$(f.rows).each(function(a){if(a%2==1){$(this).addClass(h)}else{$(this).removeClass(h)}})}});return b},setRowData:function(a,b,c){var d,e=true,f;this.each(function(){if(!this.grid){return false}var g=this,h,i,j=typeof c,k={};i=g.rows.namedItem(a);if(!i){return false}if(b){try{$(this.p.colModel).each(function(c){d=this.name;if(b[d]!==undefined){k[d]=this.formatter&&typeof this.formatter==="string"&&this.formatter=="date"?$.unformat.date(b[d],this):b[d];h=g.formatter(a,b[d],c,b,"edit");f=this.title?{title:$.jgrid.stripHtml(h)}:{};if(g.p.treeGrid===true&&d==g.p.ExpandColumn){$("td:eq("+c+") > span:first",i).html(h).attr(f)}else{$("td:eq("+c+")",i).html(h).attr(f)}}});if(g.p.datatype=="local"){var l=g.p._index[a];if(g.p.treeGrid){for(var m in g.p.treeReader){if(k.hasOwnProperty(g.p.treeReader[m])){delete k[g.p.treeReader[m]]}}}if(typeof l!="undefined"){g.p.data[l]=$.extend(true,g.p.data[l],k)}k=null}}catch(n){e=false}}if(e){if(j==="string"){$(i).addClass(c)}else if(j==="object"){$(i).css(c)}}});return e},addRowData:function(a,b,c,d){if(!c){c="last"}var e=false,f,g,h,i,j,k,l,m,n="",o,p,q,r,s;if(b){if($.isArray(b)){o=true;c="last";p=a}else{b=[b];o=false}this.each(function(){var t=this,u=b.length;j=t.p.rownumbers===true?1:0;h=t.p.multiselect===true?1:0;i=t.p.subGrid===true?1:0;if(!o){if(typeof a!="undefined"){a=a+""}else{a=$.jgrid.randId();if(t.p.keyIndex!==false){p=t.p.colModel[t.p.keyIndex+h+i+j].name;if(typeof b[0][p]!="undefined"){a=b[0][p]}}}}q=t.p.altclass;var w=0,x="",y={},z=$.isFunction(t.p.afterInsertRow)?true:false;while(w<u){r=b[w];g="";if(o){try{a=r[p]}catch(A){a=$.jgrid.randId()}x=t.p.altRows===true?(t.rows.length-1)%2===0?q:"":""}a=t.p.idPrefix+a;if(j){n=t.formatCol(0,1,"",null,a,true);g+='<td role="gridcell" aria-describedby="'+t.p.id+'_rn" class="ui-state-default jqgrid-rownum" '+n+">0</td>"}if(h){m='<input role="checkbox" type="checkbox"'+' id="jqg_'+t.p.id+"_"+a+'" class="cbox"/>';n=t.formatCol(j,1,"",null,a,true);g+='<td role="gridcell" aria-describedby="'+t.p.id+'_cb" '+n+">"+m+"</td>"}if(i){g+=$(t).jqGrid("addSubGridCell",h+j,1)}for(l=h+i+j;l<t.p.colModel.length;l++){s=t.p.colModel[l];f=s.name;y[f]=s.formatter&&typeof s.formatter==="string"&&s.formatter=="date"?$.unformat.date(r[f],s):r[f];m=t.formatter(a,$.jgrid.getAccessor(r,f),l,r,"edit");n=t.formatCol(l,1,m,r,a,true);g+='<td role="gridcell" aria-describedby="'+t.p.id+"_"+f+'" '+n+">"+m+"</td>"}g='<tr id="'+a+'" role="row" tabindex="-1" class="ui-widget-content jqgrow ui-row-'+t.p.direction+" "+x+'">'+g+"</tr>";if(t.rows.length===0){$("table:first",t.grid.bDiv).append(g)}else{switch(c){case"last":$(t.rows[t.rows.length-1]).after(g);k=t.rows.length-1;break;case"first":$(t.rows[0]).after(g);k=1;break;case"after":k=t.rows.namedItem(d);if(k){if($(t.rows[k.rowIndex+1]).hasClass("ui-subgrid")){$(t.rows[k.rowIndex+1]).after(g)}else{$(k).after(g)}}k++;break;case"before":k=t.rows.namedItem(d);if(k){$(k).before(g);k=k.rowIndex}k--;break}}if(t.p.subGrid===true){$(t).jqGrid("addSubGrid",h+j,k)}t.p.records++;t.p.reccount++;if(z){t.p.afterInsertRow.call(t,a,r,r)}w++;if(t.p.datatype=="local"){y[t.p.localReader.id]=a;t.p._index[a]=t.p.data.length;t.p.data.push(y);y={}}}if(t.p.altRows===true&&!o){if(c=="last"){if((t.rows.length-1)%2==1){$(t.rows[t.rows.length-1]).addClass(q)}}else{$(t.rows).each(function(a){if(a%2==1){$(this).addClass(q)}else{$(this).removeClass(q)}})}}t.updatepager(true,true);e=true})}return e},footerData:function(a,b,c){function h(a){for(var b in a){if(a.hasOwnProperty(b)){return false}}return true}var d,e=false,f={},g;if(typeof a=="undefined"){a="get"}if(typeof c!="boolean"){c=true}a=a.toLowerCase();this.each(function(){var i=this,j;if(!i.grid||!i.p.footerrow){return false}if(a=="set"){if(h(b)){return false}}e=true;$(this.p.colModel).each(function(h){d=this.name;if(a=="set"){if(b[d]!==undefined){j=c?i.formatter("",b[d],h,b,"edit"):b[d];g=this.title?{title:$.jgrid.stripHtml(j)}:{};$("tr.footrow td:eq("+h+")",i.grid.sDiv).html(j).attr(g);e=true}}else if(a=="get"){f[d]=$("tr.footrow td:eq("+h+")",i.grid.sDiv).html()}})});return a=="get"?f:e},showHideCol:function(a,b){return this.each(function(){var c=this,d=false,e=$.browser.webkit||$.browser.safari?0:c.p.cellLayout,f;if(!c.grid){return}if(typeof a==="string"){a=[a]}b=b!="none"?"":"none";var g=b===""?true:false,h=c.p.groupHeader&&(typeof c.p.groupHeader==="object"||$.isFunction(c.p.groupHeader));if(h){$(c).jqGrid("destroyGroupHeader",false)}$(this.p.colModel).each(function(h){if($.inArray(this.name,a)!==-1&&this.hidden===g){$("tr",c.grid.hDiv).each(function(){$(this.cells[h]).css("display",b)});$(c.rows).each(function(a){$(this.cells[h]).css("display",b)});if(c.p.footerrow){$("tr.footrow td:eq("+h+")",c.grid.sDiv).css("display",b)}f=this.widthOrg?this.widthOrg:parseInt(this.width,10);if(b==="none"){c.p.tblwidth-=f+e}else{c.p.tblwidth+=f+e}this.hidden=!g;d=true}});if(d===true){$(c).jqGrid("setGridWidth",c.p.shrinkToFit===true?c.p.tblwidth:c.p.width)}if(h){$(c).jqGrid("setGroupHeaders",c.p.groupHeader)}})},hideCol:function(a){return this.each(function(){$(this).jqGrid("showHideCol",a,"none")})},showCol:function(a){return this.each(function(){$(this).jqGrid("showHideCol",a,"")})},remapColumns:function(a,b,c){function f(b,c){$(">tr"+(c||""),b).each(function(){var b=this;var c=$.makeArray(b.cells);$.each(a,function(){var a=c[this];if(a){b.appendChild(a)}})})}function d(b){var c;if(b.length){c=$.makeArray(b)}else{c=$.extend({},b)}$.each(a,function(a){b[a]=c[this]})}var e=this.get(0);d(e.p.colModel);d(e.p.colNames);d(e.grid.headers);f($("thead:first",e.grid.hDiv),c&&":not(.ui-jqgrid-labels)");if(b){f($("#"+$.jgrid.jqID(e.p.id)+" tbody:first"),".jqgfirstrow, tr.jqgrow, tr.jqfoot")}if(e.p.footerrow){f($("tbody:first",e.grid.sDiv))}if(e.p.remapColumns){if(!e.p.remapColumns.length){e.p.remapColumns=$.makeArray(a)}else{d(e.p.remapColumns)}}e.p.lastsort=$.inArray(e.p.lastsort,a);if(e.p.treeGrid){e.p.expColInd=$.inArray(e.p.expColInd,a)}},setGridWidth:function(a,b){return this.each(function(){if(!this.grid){return}var c=this,d,e=0,f=$.browser.webkit||$.browser.safari?0:c.p.cellLayout,g,h=0,i=false,j=c.p.scrollOffset,k,l=0,m=0,n;if(typeof b!="boolean"){b=c.p.shrinkToFit}if(isNaN(a)){return}else{a=parseInt(a,10);c.grid.width=c.p.width=a}$("#gbox_"+$.jgrid.jqID(c.p.id)).css("width",a+"px");$("#gview_"+$.jgrid.jqID(c.p.id)).css("width",a+"px");$(c.grid.bDiv).css("width",a+"px");$(c.grid.hDiv).css("width",a+"px");if(c.p.pager){$(c.p.pager).css("width",a+"px")}if(c.p.toppager){$(c.p.toppager).css("width",a+"px")}if(c.p.toolbar[0]===true){$(c.grid.uDiv).css("width",a+"px");if(c.p.toolbar[1]=="both"){$(c.grid.ubDiv).css("width",a+"px")}}if(c.p.footerrow){$(c.grid.sDiv).css("width",a+"px")}if(b===false&&c.p.forceFit===true){c.p.forceFit=false}if(b===true){$.each(c.p.colModel,function(a){if(this.hidden===false){d=this.widthOrg?this.widthOrg:parseInt(this.width,10);e+=d+f;if(this.fixed){l+=d+f}else{h++}m++}});if(h===0){return}c.p.tblwidth=e;k=a-f*h-l;if(!isNaN(c.p.height)){if($(c.grid.bDiv)[0].clientHeight<$(c.grid.bDiv)[0].scrollHeight||c.rows.length===1){i=true;k-=j}}e=0;var o=c.grid.cols.length>0;$.each(c.p.colModel,function(a){if(this.hidden===false&&!this.fixed){d=this.widthOrg?this.widthOrg:parseInt(this.width,10);d=Math.round(k*d/(c.p.tblwidth-f*h-l));if(d<0){return}this.width=d;e+=d;c.grid.headers[a].width=d;c.grid.headers[a].el.style.width=d+"px";if(c.p.footerrow){c.grid.footers[a].style.width=d+"px"}if(o){c.grid.cols[a].style.width=d+"px"}g=a}});if(!g){return}n=0;if(i){if(a-l-(e+f*h)!==j){n=a-l-(e+f*h)-j}}else if(Math.abs(a-l-(e+f*h))!==1){n=a-l-(e+f*h)}c.p.colModel[g].width+=n;c.p.tblwidth=e+n+f*h+l;if(c.p.tblwidth>a){var p=c.p.tblwidth-parseInt(a,10);c.p.tblwidth=a;d=c.p.colModel[g].width=c.p.colModel[g].width-p}else{d=c.p.colModel[g].width}c.grid.headers[g].width=d;c.grid.headers[g].el.style.width=d+"px";if(o){c.grid.cols[g].style.width=d+"px"}if(c.p.footerrow){c.grid.footers[g].style.width=d+"px"}}if(c.p.tblwidth){$("table:first",c.grid.bDiv).css("width",c.p.tblwidth+"px");$("table:first",c.grid.hDiv).css("width",c.p.tblwidth+"px");c.grid.hDiv.scrollLeft=c.grid.bDiv.scrollLeft;if(c.p.footerrow){$("table:first",c.grid.sDiv).css("width",c.p.tblwidth+"px")}}})},setGridHeight:function(a){return this.each(function(){var b=this;if(!b.grid){return}$(b.grid.bDiv).css({height:a+(isNaN(a)?"":"px")});b.p.height=a;if(b.p.scroll){b.grid.populateVisible()}})},setCaption:function(a){return this.each(function(){this.p.caption=a;$("span.ui-jqgrid-title",this.grid.cDiv).html(a);$(this.grid.cDiv).show()})},setLabel:function(a,b,c,d){return this.each(function(){var e=this,f=-1;if(!e.grid){return}if(typeof a!="undefined"){$(e.p.colModel).each(function(b){if(this.name==a){f=b;return false}})}else{return}if(f>=0){var g=$("tr.ui-jqgrid-labels th:eq("+f+")",e.grid.hDiv);if(b){var h=$(".s-ico",g);$("[id^=jqgh_]",g).empty().html(b).append(h);e.p.colNames[f]=b}if(c){if(typeof c==="string"){$(g).addClass(c)}else{$(g).css(c)}}if(typeof d==="object"){$(g).attr(d)}}})},setCell:function(a,b,c,d,e,f){return this.each(function(){var g=this,h=-1,i,j;if(!g.grid){return}if(isNaN(b)){$(g.p.colModel).each(function(a){if(this.name==b){h=a;return false}})}else{h=parseInt(b,10)}if(h>=0){var k=g.rows.namedItem(a);if(k){var l=$("td:eq("+h+")",k);if(c!==""||f===true){i=g.formatter(a,c,h,k,"edit");j=g.p.colModel[h].title?{title:$.jgrid.stripHtml(i)}:{};if(g.p.treeGrid&&$(".tree-wrap",$(l)).length>0){$("span",$(l)).html(i).attr(j)}else{$(l).html(i).attr(j)}if(g.p.datatype=="local"){var m=g.p.colModel[h],n;c=m.formatter&&typeof m.formatter==="string"&&m.formatter=="date"?$.unformat.date(c,m):c;n=g.p._index[a];if(typeof n!="undefined"){g.p.data[n][m.name]=c}}}if(typeof d==="string"){$(l).addClass(d)}else if(d){$(l).css(d)}if(typeof e==="object"){$(l).attr(e)}}}})},getCell:function(a,b){var c=false;this.each(function(){var d=this,e=-1;if(!d.grid){return}if(isNaN(b)){$(d.p.colModel).each(function(a){if(this.name===b){e=a;return false}})}else{e=parseInt(b,10)}if(e>=0){var f=d.rows.namedItem(a);if(f){try{c=$.unformat($("td:eq("+e+")",f),{rowId:f.id,colModel:d.p.colModel[e]},e)}catch(g){c=$.jgrid.htmlDecode($("td:eq("+e+")",f).html())}}}});return c},getCol:function(a,b,c){var d=[],e,f=0,g=0,h=0,i;b=typeof b!="boolean"?false:b;if(typeof c=="undefined"){c=false}this.each(function(){var j=this,k=-1;if(!j.grid){return}if(isNaN(a)){$(j.p.colModel).each(function(b){if(this.name===a){k=b;return false}})}else{k=parseInt(a,10)}if(k>=0){var l=j.rows.length,m=0;if(l&&l>0){while(m<l){if($(j.rows[m]).hasClass("jqgrow")){try{e=$.unformat($(j.rows[m].cells[k]),{rowId:j.rows[m].id,colModel:j.p.colModel[k]},k)}catch(n){e=$.jgrid.htmlDecode(j.rows[m].cells[k].innerHTML)}if(c){i=parseFloat(e);f+=i;g=Math.min(g,i);h=Math.max(h,i)}else if(b){d.push({id:j.rows[m].id,value:e})}else{d.push(e)}}m++}if(c){switch(c.toLowerCase()){case"sum":d=f;break;case"avg":d=f/l;break;case"count":d=l;break;case"min":d=g;break;case"max":d=h;break}}}}});return d},clearGridData:function(a){return this.each(function(){var b=this;if(!b.grid){return}if(typeof a!="boolean"){a=false}if(b.p.deepempty){$("#"+$.jgrid.jqID(b.p.id)+" tbody:first tr:gt(0)").remove()}else{var c=$("#"+$.jgrid.jqID(b.p.id)+" tbody:first tr:first")[0];$("#"+$.jgrid.jqID(b.p.id)+" tbody:first").empty().append(c)}if(b.p.footerrow&&a){$(".ui-jqgrid-ftable td",b.grid.sDiv).html("&#160;")}b.p.selrow=null;b.p.selarrrow=[];b.p.savedRow=[];b.p.records=0;b.p.page=1;b.p.lastpage=0;b.p.reccount=0;b.p.data=[];b.p._index={};b.updatepager(true,false)})},getInd:function(a,b){var c=false,d;this.each(function(){d=this.rows.namedItem(a);if(d){c=b===true?d:d.rowIndex}});return c},bindKeys:function(a){var b=$.extend({onEnter:null,onSpace:null,onLeftKey:null,onRightKey:null,scrollingRows:true},a||{});return this.each(function(){var a=this;if(!$("body").is("[role]")){$("body").attr("role","application")}a.p.scrollrows=b.scrollingRows;$(a).keydown(function(c){var d=$(a).find("tr[tabindex=0]")[0],e,f,g,h=a.p.treeReader.expanded_field;if(d){g=a.p._index[d.id];if(c.keyCode===37||c.keyCode===38||c.keyCode===39||c.keyCode===40){if(c.keyCode===38){f=d.previousSibling;e="";if(f){if($(f).is(":hidden")){while(f){f=f.previousSibling;if(!$(f).is(":hidden")&&$(f).hasClass("jqgrow")){e=f.id;break}}}else{e=f.id}}$(a).jqGrid("setSelection",e)}if(c.keyCode===40){f=d.nextSibling;e="";if(f){if($(f).is(":hidden")){while(f){f=f.nextSibling;if(!$(f).is(":hidden")&&$(f).hasClass("jqgrow")){e=f.id;break}}}else{e=f.id}}$(a).jqGrid("setSelection",e)}if(c.keyCode===37){if(a.p.treeGrid&&a.p.data[g][h]){$(d).find("div.treeclick").trigger("click")}if($.isFunction(b.onLeftKey)){b.onLeftKey.call(a,a.p.selrow)}}if(c.keyCode===39){if(a.p.treeGrid&&!a.p.data[g][h]){$(d).find("div.treeclick").trigger("click")}if($.isFunction(b.onRightKey)){b.onRightKey.call(a,a.p.selrow)}}}else if(c.keyCode===13){if($.isFunction(b.onEnter)){b.onEnter.call(a,a.p.selrow)}}else if(c.keyCode===32){if($.isFunction(b.onSpace)){b.onSpace.call(a,a.p.selrow)}}}})})},unbindKeys:function(){return this.each(function(){var a=this;$(a).unbind("keydown")})},getLocalRow:function(a){var b=false,c;this.each(function(){if(typeof a!=="undefined"){c=this.p._index[a];if(c>=0){b=this.p.data[c]}}});return b}})})(jQuery);(function(a){a.jgrid.extend({getColProp:function(a){var b={},c=this[0];if(!c.grid){return false}var d=c.p.colModel;for(var e=0;e<d.length;e++){if(d[e].name==a){b=d[e];break}}return b},setColProp:function(b,c){return this.each(function(){if(this.grid){if(c){var d=this.p.colModel;for(var e=0;e<d.length;e++){if(d[e].name==b){a.extend(this.p.colModel[e],c);break}}}}})},sortGrid:function(a,b,c){return this.each(function(){var d=this,e=-1;if(!d.grid){return}if(!a){a=d.p.sortname}for(var f=0;f<d.p.colModel.length;f++){if(d.p.colModel[f].index==a||d.p.colModel[f].name==a){e=f;break}}if(e!=-1){var g=d.p.colModel[e].sortable;if(typeof g!=="boolean"){g=true}if(typeof b!=="boolean"){b=false}if(g){d.sortData("jqgh_"+d.p.id+"_"+a,e,b,c)}}})},GridDestroy:function(){return this.each(function(){if(this.grid){if(this.p.pager){a(this.p.pager).remove()}var b=this.id;try{a("#gbox_"+b).remove()}catch(c){}}})},GridUnload:function(){return this.each(function(){if(!this.grid){return}var b={id:a(this).attr("id"),cl:a(this).attr("class")};if(this.p.pager){a(this.p.pager).empty().removeClass("ui-state-default ui-jqgrid-pager corner-bottom")}var c=document.createElement("table");a(c).attr({id:b.id});c.className=b.cl;var d=this.id;a(c).removeClass("ui-jqgrid-btable");if(a(this.p.pager).parents("#gbox_"+d).length===1){a(c).insertBefore("#gbox_"+d).show();a(this.p.pager).insertBefore("#gbox_"+d)}else{a(c).insertBefore("#gbox_"+d).show()}a("#gbox_"+d).remove()})},setGridState:function(b){return this.each(function(){if(!this.grid){return}var c=this;if(b=="hidden"){a(".ui-jqgrid-bdiv, .ui-jqgrid-hdiv","#gview_"+c.p.id).slideUp("fast");if(c.p.pager){a(c.p.pager).slideUp("fast")}if(c.p.toppager){a(c.p.toppager).slideUp("fast")}if(c.p.toolbar[0]===true){if(c.p.toolbar[1]=="both"){a(c.grid.ubDiv).slideUp("fast")}a(c.grid.uDiv).slideUp("fast")}if(c.p.footerrow){a(".ui-jqgrid-sdiv","#gbox_"+c.p.id).slideUp("fast")}a(".ui-jqgrid-titlebar-close span",c.grid.cDiv).removeClass("ui-icon-circle-triangle-n").addClass("ui-icon-circle-triangle-s");c.p.gridstate="hidden"}else if(b=="visible"){a(".ui-jqgrid-hdiv, .ui-jqgrid-bdiv","#gview_"+c.p.id).slideDown("fast");if(c.p.pager){a(c.p.pager).slideDown("fast")}if(c.p.toppager){a(c.p.toppager).slideDown("fast")}if(c.p.toolbar[0]===true){if(c.p.toolbar[1]=="both"){a(c.grid.ubDiv).slideDown("fast")}a(c.grid.uDiv).slideDown("fast")}if(c.p.footerrow){a(".ui-jqgrid-sdiv","#gbox_"+c.p.id).slideDown("fast")}a(".ui-jqgrid-titlebar-close span",c.grid.cDiv).removeClass("ui-icon-circle-triangle-s").addClass("ui-icon-circle-triangle-n");c.p.gridstate="visible"}})},filterToolbar:function(b){b=a.extend({autosearch:true,searchOnEnter:true,beforeSearch:null,afterSearch:null,beforeClear:null,afterClear:null,searchurl:"",stringResult:false,groupOp:"AND",defaultSearch:"bw"},b||{});return this.each(function(){function g(b,c){var d=a(b);if(d[0]){jQuery.each(c,function(){if(this.data!==undefined){d.bind(this.type,this.data,this.fn)}else{d.bind(this.type,this.fn)}})}}var c=this;if(this.ftoolbar){return}var d=function(){var d={},e=0,f,g,h={},i;a.each(c.p.colModel,function(j,k){g=this.index||this.name;switch(this.stype){case"select":i=this.searchoptions&&this.searchoptions.sopt?this.searchoptions.sopt[0]:"eq";f=a("#gs_"+a.jgrid.jqID(this.name),c.grid.hDiv).val();if(f){d[g]=f;h[g]=i;e++}else{try{delete c.p.postData[g]}catch(l){}}break;case"text":i=this.searchoptions&&this.searchoptions.sopt?this.searchoptions.sopt[0]:b.defaultSearch;f=a("#gs_"+a.jgrid.jqID(this.name),c.grid.hDiv).val();if(f){d[g]=f;h[g]=i;e++}else{try{delete c.p.postData[g]}catch(m){}}break}});var j=e>0?true:false;if(b.stringResult===true||c.p.datatype=="local"){var k='{"groupOp":"'+b.groupOp+'","rules":[';var l=0;a.each(d,function(a,b){if(l>0){k+=","}k+='{"field":"'+a+'",';k+='"op":"'+h[a]+'",';b+="";k+='"data":"'+b.replace(/\\/g,"\\\\").replace(/\"/g,'\\"')+'"}';l++});k+="]}";a.extend(c.p.postData,{filters:k});a.each(["searchField","searchString","searchOper"],function(a,b){if(c.p.postData.hasOwnProperty(b)){delete c.p.postData[b]}})}else{a.extend(c.p.postData,d)}var m;if(c.p.searchurl){m=c.p.url;a(c).jqGrid("setGridParam",{url:c.p.searchurl})}var n=false;if(a.isFunction(b.beforeSearch)){n=b.beforeSearch.call(c)}if(!n){a(c).jqGrid("setGridParam",{search:j}).trigger("reloadGrid",[{page:1}])}if(m){a(c).jqGrid("setGridParam",{url:m})}if(a.isFunction(b.afterSearch)){b.afterSearch()}};var e=function(d){var e={},f,g=0,h;d=typeof d!="boolean"?true:d;a.each(c.p.colModel,function(b,d){f=this.searchoptions&&this.searchoptions.defaultValue?this.searchoptions.defaultValue:"";h=this.index||this.name;switch(this.stype){case"select":var i;a("#gs_"+a.jgrid.jqID(h)+" option",c.grid.hDiv).each(function(b){if(b===0){this.selected=true}if(a(this).text()==f){this.selected=true;i=a(this).val();return false}});if(i){e[h]=i;g++}else{try{delete c.p.postData[h]}catch(j){}}break;case"text":a("#gs_"+a.jgrid.jqID(h),c.grid.hDiv).val(f);if(f){e[h]=f;g++}else{try{delete c.p.postData[h]}catch(k){}}break}});var i=g>0?true:false;if(b.stringResult===true||c.p.datatype=="local"){var j='{"groupOp":"'+b.groupOp+'","rules":[';var k=0;a.each(e,function(a,b){if(k>0){j+=","}j+='{"field":"'+a+'",';j+='"op":"'+"eq"+'",';b+="";j+='"data":"'+b.replace(/\\/g,"\\\\").replace(/\"/g,'\\"')+'"}';k++});j+="]}";a.extend(c.p.postData,{filters:j});a.each(["searchField","searchString","searchOper"],function(a,b){if(c.p.postData.hasOwnProperty(b)){delete c.p.postData[b]}})}else{a.extend(c.p.postData,e)}var l;if(c.p.searchurl){l=c.p.url;a(c).jqGrid("setGridParam",{url:c.p.searchurl})}var m=false;if(a.isFunction(b.beforeClear)){m=b.beforeClear.call(c)}if(!m){if(d){a(c).jqGrid("setGridParam",{search:i}).trigger("reloadGrid",[{page:1}])}}if(l){a(c).jqGrid("setGridParam",{url:l})}if(a.isFunction(b.afterClear)){b.afterClear()}};var f=function(){var b=a("tr.ui-search-toolbar",c.grid.hDiv);if(b.css("display")=="none"){b.show()}else{b.hide()}};var h=a("<tr class='ui-search-toolbar' role='rowheader'></tr>");var i;a.each(c.p.colModel,function(e,f){var j=this,k,l,m,n,o;l=a("<th role='columnheader' class='ui-state-default ui-th-column ui-th-"+c.p.direction+"'></th>");k=a("<div style='width:100%;position:relative;height:100%;padding-right:0.3em;'></div>");if(this.hidden===true){a(l).css("display","none")}this.search=this.search===false?false:true;if(typeof this.stype=="undefined"){this.stype="text"}m=a.extend({},this.searchoptions||{});if(this.search){switch(this.stype){case"select":n=this.surl||m.dataUrl;if(n){o=k;a.ajax(a.extend({url:n,dataType:"html",success:function(c,e){if(m.buildSelect!==undefined){var f=m.buildSelect(c);if(f){a(o).append(f)}}else{a(o).append(c)}if(m.defaultValue){a("select",o).val(m.defaultValue)}a("select",o).attr({name:j.index||j.name,id:"gs_"+j.name});if(m.attr){a("select",o).attr(m.attr)}a("select",o).css({width:"100%"});if(m.dataInit!==undefined){m.dataInit(a("select",o)[0])}if(m.dataEvents!==undefined){g(a("select",o)[0],m.dataEvents)}if(b.autosearch===true){a("select",o).change(function(a){d();return false})}c=null}},a.jgrid.ajaxOptions,c.p.ajaxSelectOptions||{}))}else{var q;if(j.searchoptions&&j.searchoptions.value){q=j.searchoptions.value}else if(j.editoptions&&j.editoptions.value){q=j.editoptions.value}if(q){var r=document.createElement("select");r.style.width="100%";a(r).attr({name:j.index||j.name,id:"gs_"+j.name});var s,t,u;if(typeof q==="string"){s=q.split(";");for(var v=0;v<s.length;v++){t=s[v].split(":");u=document.createElement("option");u.value=t[0];u.innerHTML=t[1];r.appendChild(u)}}else if(typeof q==="object"){for(var w in q){if(q.hasOwnProperty(w)){u=document.createElement("option");u.value=w;u.innerHTML=q[w];r.appendChild(u)}}}if(m.defaultValue){a(r).val(m.defaultValue)}if(m.attr){a(r).attr(m.attr)}if(m.dataInit!==undefined){m.dataInit(r)}if(m.dataEvents!==undefined){g(r,m.dataEvents)}a(k).append(r);if(b.autosearch===true){a(r).change(function(a){d();return false})}}}break;case"text":var x=m.defaultValue?m.defaultValue:"";a(k).append("<input type='text' style='width:95%;padding:0px;' name='"+(j.index||j.name)+"' id='gs_"+j.name+"' value='"+x+"'/>");if(m.attr){a("input",k).attr(m.attr)}if(m.dataInit!==undefined){m.dataInit(a("input",k)[0])}if(m.dataEvents!==undefined){g(a("input",k)[0],m.dataEvents)}if(b.autosearch===true){if(b.searchOnEnter){a("input",k).keypress(function(a){var b=a.charCode?a.charCode:a.keyCode?a.keyCode:0;if(b==13){d();return false}return this})}else{a("input",k).keydown(function(a){var b=a.which;switch(b){case 13:return false;case 9:case 16:case 37:case 38:case 39:case 40:case 27:break;default:if(i){clearTimeout(i)}i=setTimeout(function(){d()},500)}})}}break}}a(l).append(k);a(h).append(l)});a("table thead",c.grid.hDiv).append(h);this.ftoolbar=true;this.triggerToolbar=d;this.clearToolbar=e;this.toggleToolbar=f})},destroyGroupHeader:function(b){if(typeof b=="undefined"){b=true}return this.each(function(){var c=this,d,e,f,g,h,i,j=c.grid,k=a("table.ui-jqgrid-htable thead",j.hDiv),l=c.p.colModel,m;if(!j)return;d=a("<tr>",{role:"rowheader"}).addClass("ui-jqgrid-labels");g=j.headers;for(e=0,f=g.length;e<f;e++){m=l[e].hidden?"none":"";h=a(g[e].el).width(g[e].width).removeAttr("rowSpan").css("display",m);d.append(h);i=h.children("span.ui-jqgrid-resize");if(i.length>0){i[0].style.height=""}h.children("div")[0].style.top=""}a(k).children("tr.ui-jqgrid-labels").remove();a(k).prepend(d);if(b===true){a(c).jqGrid("setGridParam",{groupHeader:null})}})},setGroupHeaders:function(b){b=a.extend({useColSpanStyle:false,groupHeaders:[]},b||{});return this.each(function(){this.p.groupHeader=b;var c=this,d,e,f=0,g,h,i,j,k,l,m,n,p,q,r=c.p.colModel,s=r.length,t=c.grid.headers,u=a("table.ui-jqgrid-htable",c.grid.hDiv),v=u.children("thead").children("tr.ui-jqgrid-labels:last").addClass("jqg-second-row-header"),w=u.children("thead"),x,y,z=u.find(".jqg-first-row-header");if(z.html()===null){z=a("<tr>",{role:"row","aria-hidden":"true"}).addClass("jqg-first-row-header").css("height","auto")}else{z.empty()}var A,B=function(a,b){var c=0,d=b.length;for(;c<d;c++){if(b[c].startColumnName===a){return c}}return-1};a(c).prepend(w);g=a("<tr>",{role:"rowheader"}).addClass("ui-jqgrid-labels jqg-third-row-header");for(d=0;d<s;d++){i=t[d].el;j=a(i);e=r[d];k={height:"0px",width:t[d].width+"px",display:e.hidden?"none":""};a("<th>",{role:"gridcell"}).css(k).addClass("ui-first-th-"+c.p.direction).appendTo(z);i.style.width="";l=B(e.name,b.groupHeaders);if(l>=0){m=b.groupHeaders[l];n=m.numberOfColumns;p=m.titleText;for(q=0,l=0;l<n&&d+l<s;l++){if(!r[d+l].hidden){q++}}h=a("<th>",{colspan:String(q),role:"columnheader"}).addClass("ui-state-default ui-th-column-header ui-th-"+c.p.direction).css({height:"22px","border-top":"0px none"}).html(p);if(c.p.headertitles){h.attr("title",h.text())}if(q===0){h.hide()}j.before(h);g.append(i);f=n-1}else{if(f===0){if(b.useColSpanStyle){j.attr("rowspan","2")}else{a("<th>",{role:"columnheader"}).addClass("ui-state-default ui-th-column-header ui-th-"+c.p.direction).css({display:e.hidden?"none":"","border-top":"0px none"}).insertBefore(j);g.append(i)}}else{g.append(i);f--}}}x=a(c).children("thead");x.prepend(z);g.insertAfter(v);u.append(x);if(b.useColSpanStyle){u.find("span.ui-jqgrid-resize").each(function(){var b=a(this).parent();if(b.is(":visible")){this.style.cssText="height: "+b.height()+"px !important; cursor: col-resize;"}});u.find("div.ui-jqgrid-sortable").each(function(){var b=a(this),c=b.parent();if(c.is(":visible")){b.css("top",(c.height()-b.outerHeight())/2+"px")}})}if(a.isFunction(c.p.resizeStop)){y=c.p.resizeStop}A=x.find("tr.jqg-first-row-header");c.p.resizeStop=function(b,d){A.find("th").eq(d).width(b);if(a.isFunction(y)){y.call(c,b,d)}}})}})})(jQuery);(function(a){a.fn.jqm=function(d){var e={overlay:50,closeoverlay:true,overlayClass:"jqmOverlay",closeClass:"jqmClose",trigger:".jqModal",ajax:f,ajaxText:"",target:f,modal:f,toTop:f,onShow:f,onHide:f,onLoad:f};return this.each(function(){if(this._jqm)return c[this._jqm].c=a.extend({},c[this._jqm].c,d);b++;this._jqm=b;c[b]={c:a.extend(e,a.jqm.params,d),a:f,w:a(this).addClass("jqmID"+b),s:b};if(e.trigger)a(this).jqmAddTrigger(e.trigger)})};a.fn.jqmAddClose=function(a){return k(this,a,"jqmHide")};a.fn.jqmAddTrigger=function(a){return k(this,a,"jqmShow")};a.fn.jqmShow=function(b){return this.each(function(){a.jqm.open(this._jqm,b)})};a.fn.jqmHide=function(b){return this.each(function(){a.jqm.close(this._jqm,b)})};a.jqm={hash:{},open:function(b,h){var j=c[b],k=j.c,l="."+k.closeClass,m=parseInt(j.w.css("z-index"));m=m>0?m:3e3;var n=a("<div></div>").css({height:"100%",width:"100%",position:"fixed",left:0,top:0,"z-index":m-1,opacity:k.overlay/100});if(j.a)return f;j.t=h;j.a=true;j.w.css("z-index",m);if(k.modal){if(!d[0])setTimeout(function(){i("bind")},1);d.push(b)}else if(k.overlay>0){if(k.closeoverlay)j.w.jqmAddClose(n)}else n=f;j.o=n?n.addClass(k.overlayClass).prependTo("body"):f;if(e){a("html,body").css({height:"100%",width:"100%"});if(n){n=n.css({position:"absolute"})[0];for(var o in{Top:1,Left:1})n.style.setExpression(o.toLowerCase(),"(_=(document.documentElement.scroll"+o+" || document.body.scroll"+o+"))+'px'")}}if(k.ajax){var p=k.target||j.w,q=k.ajax;p=typeof p=="string"?a(p,j.w):a(p);q=q.substr(0,1)=="@"?a(h).attr(q.substring(1)):q;p.html(k.ajaxText).load(q,function(){if(k.onLoad)k.onLoad.call(this,j);if(l)j.w.jqmAddClose(a(l,j.w));g(j)})}else if(l)j.w.jqmAddClose(a(l,j.w));if(k.toTop&&j.o)j.w.before('<span id="jqmP'+j.w[0]._jqm+'"></span>').insertAfter(j.o);k.onShow?k.onShow(j):j.w.show();g(j);return f},close:function(b){var e=c[b];if(!e.a)return f;e.a=f;if(d[0]){d.pop();if(!d[0])i("unbind")}if(e.c.toTop&&e.o)a("#jqmP"+e.w[0]._jqm).after(e.w).remove();if(e.c.onHide)e.c.onHide(e);else{e.w.hide();if(e.o)e.o.remove()}return f},params:{}};var b=0,c=a.jqm.hash,d=[],e=a.browser.msie&&a.browser.version=="6.0",f=false,g=function(b){var c=a('<iframe src="javascript:false;document.write(\'\');" class="jqm"></iframe>').css({opacity:0});if(e)if(b.o)b.o.html('<p style="width:100%;height:100%"/>').prepend(c);else if(!a("iframe.jqm",b.w)[0])b.w.prepend(c);h(b)},h=function(b){try{a(":input:visible",b.w)[0].focus()}catch(c){}},i=function(b){a(document)[b]("keypress",j)[b]("keydown",j)[b]("mousedown",j)},j=function(b){var e=c[d[d.length-1]],f=!a(b.target).parents(".jqmID"+e.s)[0];if(f)h(e);return!f},k=function(b,d,e){return b.each(function(){var b=this._jqm;a(d).each(function(){if(!this[e]){this[e]=[];a(this).click(function(){for(var a in{jqmShow:1,jqmHide:1})for(var b in this[a])if(c[this[a][b]])c[this[a][b]].w[a](this);return f})}this[e].push(b)})})}})(jQuery);(function(a){a.fn.jqDrag=function(a){return f(this,a,"d")};a.fn.jqResize=function(a,b){return f(this,a,"r",b)};a.jqDnR={dnr:{},e:0,drag:function(a){if(c.k=="d")d.css({left:c.X+a.pageX-c.pX,top:c.Y+a.pageY-c.pY});else{d.css({width:Math.max(a.pageX-c.pX+c.W,0),height:Math.max(a.pageY-c.pY+c.H,0)});if(M1){e.css({width:Math.max(a.pageX-M1.pX+M1.W,0),height:Math.max(a.pageY-M1.pY+M1.H,0)})}}return false},stop:function(){a(document).unbind("mousemove",b.drag).unbind("mouseup",b.stop)}};var b=a.jqDnR,c=b.dnr,d=b.e,e,f=function(b,f,h,i){return b.each(function(){f=f?a(f,b):b;f.bind("mousedown",{e:b,k:h},function(b){var f=b.data,h={};d=f.e;e=i?a(i):false;if(d.css("position")!="relative"){try{d.position(h)}catch(j){}}c={X:h.left||g("left")||0,Y:h.top||g("top")||0,W:g("width")||d[0].scrollWidth||0,H:g("height")||d[0].scrollHeight||0,pX:b.pageX,pY:b.pageY,k:f.k};if(e&&f.k!="d"){M1={X:h.left||f1("left")||0,Y:h.top||f1("top")||0,W:e[0].offsetWidth||f1("width")||0,H:e[0].offsetHeight||f1("height")||0,pX:b.pageX,pY:b.pageY,k:f.k}}else{M1=false}if(a("input.hasDatepicker",d[0])[0]){try{a("input.hasDatepicker",d[0]).datepicker("hide")}catch(k){}}a(document).mousemove(a.jqDnR.drag).mouseup(a.jqDnR.stop);return false})})},g=function(a){return parseInt(d.css(a))||false};f1=function(a){return parseInt(e.css(a))||false}})(jQuery);var xmlJsonClass={xml2json:function(a,b){if(a.nodeType===9){a=a.documentElement}var c=this.removeWhite(a);var d=this.toObj(c);var e=this.toJson(d,a.nodeName,"\t");return"{\n"+b+(b?e.replace(/\t/g,b):e.replace(/\t|\n/g,""))+"\n}"},json2xml:function(a,b){var c=function(a,b,d){var e="";var f,g;if(a instanceof Array){if(a.length===0){e+=d+"<"+b+">__EMPTY_ARRAY_</"+b+">\n"}else{for(f=0,g=a.length;f<g;f+=1){var h=d+c(a[f],b,d+"\t")+"\n";e+=h}}}else if(typeof a==="object"){var i=false;e+=d+"<"+b;var j;for(j in a)if(a.hasOwnProperty(j)){if(j.charAt(0)==="@"){e+=" "+j.substr(1)+'="'+a[j].toString()+'"'}else{i=true}}e+=i?">":"/>";if(i){for(j in a)if(a.hasOwnProperty(j)){if(j==="#text"){e+=a[j]}else if(j==="#cdata"){e+="<![CDATA["+a[j]+"]]>"}else if(j.charAt(0)!=="@"){e+=c(a[j],j,d+"\t")}}e+=(e.charAt(e.length-1)==="\n"?d:"")+"</"+b+">"}}else if(typeof a==="function"){e+=d+"<"+b+">"+"<![CDATA["+a+"]]>"+"</"+b+">"}else{if(a===undefined){a=""}if(a.toString()==='""'||a.toString().length===0){e+=d+"<"+b+">__EMPTY_STRING_</"+b+">"}else{e+=d+"<"+b+">"+a.toString()+"</"+b+">"}}return e};var d="";var e;for(e in a)if(a.hasOwnProperty(e)){d+=c(a[e],e,"")}return b?d.replace(/\t/g,b):d.replace(/\t|\n/g,"")},toObj:function(a){var b={};var c=/function/i;if(a.nodeType===1){if(a.attributes.length){var d;for(d=0;d<a.attributes.length;d+=1){b["@"+a.attributes[d].nodeName]=(a.attributes[d].nodeValue||"").toString()}}if(a.firstChild){var e=0,f=0,g=false;var h;for(h=a.firstChild;h;h=h.nextSibling){if(h.nodeType===1){g=true}else if(h.nodeType===3&&h.nodeValue.match(/[^ \f\n\r\t\v]/)){e+=1}else if(h.nodeType===4){f+=1}}if(g){if(e<2&&f<2){this.removeWhite(a);for(h=a.firstChild;h;h=h.nextSibling){if(h.nodeType===3){b["#text"]=this.escape(h.nodeValue)}else if(h.nodeType===4){if(c.test(h.nodeValue)){b[h.nodeName]=[b[h.nodeName],h.nodeValue]}else{b["#cdata"]=this.escape(h.nodeValue)}}else if(b[h.nodeName]){if(b[h.nodeName]instanceof Array){b[h.nodeName][b[h.nodeName].length]=this.toObj(h)}else{b[h.nodeName]=[b[h.nodeName],this.toObj(h)]}}else{b[h.nodeName]=this.toObj(h)}}}else{if(!a.attributes.length){b=this.escape(this.innerXml(a))}else{b["#text"]=this.escape(this.innerXml(a))}}}else if(e){if(!a.attributes.length){b=this.escape(this.innerXml(a));if(b==="__EMPTY_ARRAY_"){b="[]"}else if(b==="__EMPTY_STRING_"){b=""}}else{b["#text"]=this.escape(this.innerXml(a))}}else if(f){if(f>1){b=this.escape(this.innerXml(a))}else{for(h=a.firstChild;h;h=h.nextSibling){if(c.test(a.firstChild.nodeValue)){b=a.firstChild.nodeValue;break}else{b["#cdata"]=this.escape(h.nodeValue)}}}}}if(!a.attributes.length&&!a.firstChild){b=null}}else if(a.nodeType===9){b=this.toObj(a.documentElement)}else{alert("unhandled node type: "+a.nodeType)}return b},toJson:function(a,b,c,d){if(d===undefined)d=true;var e=b?'"'+b+'"':"",f="\t",g="\n";if(!d){f="";g=""}if(a==="[]"){e+=b?":[]":"[]"}else if(a instanceof Array){var h,i,j=[];for(i=0,h=a.length;i<h;i+=1){j[i]=this.toJson(a[i],"",c+f,d)}e+=(b?":[":"[")+(j.length>1?g+c+f+j.join(","+g+c+f)+g+c:j.join(""))+"]"}else if(a===null){e+=(b&&":")+"null"}else if(typeof a==="object"){var k=[],l;for(l in a){if(a.hasOwnProperty(l)){k[k.length]=this.toJson(a[l],l,c+f,d)}}e+=(b?":{":"{")+(k.length>1?g+c+f+k.join(","+g+c+f)+g+c:k.join(""))+"}"}else if(typeof a==="string"){e+=(b&&":")+'"'+a.replace(/\\/g,"\\\\").replace(/\"/g,'\\"')+'"'}else{e+=(b&&":")+'"'+a.toString()+'"'}return e},innerXml:function(a){var b="";if("innerHTML"in a){b=a.innerHTML}else{var c=function(a){var b="",d;if(a.nodeType===1){b+="<"+a.nodeName;for(d=0;d<a.attributes.length;d+=1){b+=" "+a.attributes[d].nodeName+'="'+(a.attributes[d].nodeValue||"").toString()+'"'}if(a.firstChild){b+=">";for(var e=a.firstChild;e;e=e.nextSibling){b+=c(e)}b+="</"+a.nodeName+">"}else{b+="/>"}}else if(a.nodeType===3){b+=a.nodeValue}else if(a.nodeType===4){b+="<![CDATA["+a.nodeValue+"]]>"}return b};for(var d=a.firstChild;d;d=d.nextSibling){b+=c(d)}}return b},escape:function(a){return a.replace(/[\\]/g,"\\\\").replace(/[\"]/g,'\\"').replace(/[\n]/g,"\\n").replace(/[\r]/g,"\\r")},removeWhite:function(a){a.normalize();var b;for(b=a.firstChild;b;){if(b.nodeType===3){if(!b.nodeValue.match(/[^ \f\n\r\t\v]/)){var c=b.nextSibling;a.removeChild(b);b=c}else{b=b.nextSibling}}else if(b.nodeType===1){this.removeWhite(b);b=b.nextSibling}else{b=b.nextSibling}}return a}};(function(a){a.fmatter={};a.extend(a.fmatter,{isBoolean:function(a){return typeof a==="boolean"},isObject:function(b){return b&&(typeof b==="object"||a.isFunction(b))||false},isString:function(a){return typeof a==="string"},isNumber:function(a){return typeof a==="number"&&isFinite(a)},isNull:function(a){return a===null},isUndefined:function(a){return typeof a==="undefined"},isValue:function(a){return this.isObject(a)||this.isString(a)||this.isNumber(a)||this.isBoolean(a)},isEmpty:function(b){if(!this.isString(b)&&this.isValue(b)){return false}else if(!this.isValue(b)){return true}b=a.trim(b).replace(/\&nbsp\;/ig,"").replace(/\&#160\;/ig,"");return b===""}});a.fn.fmatter=function(b,c,d,e,f){var g=c;d=a.extend({},a.jgrid.formatter,d);if(a.fn.fmatter[b]){g=a.fn.fmatter[b](c,d,e,f)}return g};a.fmatter.util={NumberFormat:function(b,c){if(!a.fmatter.isNumber(b)){b*=1}if(a.fmatter.isNumber(b)){var d=b<0;var e=b+"";var f=c.decimalSeparator?c.decimalSeparator:".";var g;if(a.fmatter.isNumber(c.decimalPlaces)){var h=c.decimalPlaces;var i=Math.pow(10,h);e=Math.round(b*i)/i+"";g=e.lastIndexOf(".");if(h>0){if(g<0){e+=f;g=e.length-1}else if(f!=="."){e=e.replace(".",f)}while(e.length-1-g<h){e+="0"}}}if(c.thousandsSeparator){var j=c.thousandsSeparator;g=e.lastIndexOf(f);g=g>-1?g:e.length;var k=e.substring(g);var l=-1;for(var m=g;m>0;m--){l++;if(l%3===0&&m!==g&&(!d||m>1)){k=j+k}k=e.charAt(m-1)+k}e=k}e=c.prefix?c.prefix+e:e;e=c.suffix?e+c.suffix:e;return e}else{return b}},DateFormat:function(b,c,d,e){var f=/\\.|[dDjlNSwzWFmMntLoYyaABgGhHisueIOPTZcrU]/g,g=/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g,h=/[^-+\dA-Z]/g,i=new RegExp("^/Date\\((([-+])?[0-9]+)(([-+])([0-9]{2})([0-9]{2}))?\\)/$"),j=typeof c==="string"?c.match(i):null,k=function(a,b){a=String(a);b=parseInt(b,10)||2;while(a.length<b){a="0"+a}return a},l={m:1,d:1,y:1970,h:0,i:0,s:0,u:0},m=0,n,o,p,q=["i18n"];q.i18n={dayNames:e.dayNames,monthNames:e.monthNames};if(b in e.masks){b=e.masks[b]}if(!isNaN(c-0)&&String(b).toLowerCase()=="u"){m=new Date(parseFloat(c)*1e3)}else if(c.constructor===Date){m=c}else if(j!==null){m=new Date(parseInt(j[1],10));if(j[3]){var r=Number(j[5])*60+Number(j[6]);r*=j[4]=="-"?1:-1;r-=m.getTimezoneOffset();m.setTime(Number(Number(m)+r*60*1e3))}}else{c=String(c).split(/[\\\/:_;.,\t\T\s-]/);b=b.split(/[\\\/:_;.,\t\T\s-]/);for(o=0,p=b.length;o<p;o++){if(b[o]=="M"){n=a.inArray(c[o],q.i18n.monthNames);if(n!==-1&&n<12){c[o]=n+1}}if(b[o]=="F"){n=a.inArray(c[o],q.i18n.monthNames);if(n!==-1&&n>11){c[o]=n+1-12}}if(c[o]){l[b[o].toLowerCase()]=parseInt(c[o],10)}}if(l.f){l.m=l.f}if(l.m===0&&l.y===0&&l.d===0){return"&#160;"}l.m=parseInt(l.m,10)-1;var s=l.y;if(s>=70&&s<=99){l.y=1900+l.y}else if(s>=0&&s<=69){l.y=2e3+l.y}m=new Date(l.y,l.m,l.d,l.h,l.i,l.s,l.u)}if(d in e.masks){d=e.masks[d]}else if(!d){d="Y-m-d"}var t=m.getHours(),u=m.getMinutes(),v=m.getDate(),w=m.getMonth()+1,x=m.getTimezoneOffset(),y=m.getSeconds(),z=m.getMilliseconds(),A=m.getDay(),B=m.getFullYear(),C=(A+6)%7+1,D=(new Date(B,w-1,v)-new Date(B,0,1))/864e5,E={d:k(v),D:q.i18n.dayNames[A],j:v,l:q.i18n.dayNames[A+7],N:C,S:e.S(v),w:A,z:D,W:C<5?Math.floor((D+C-1)/7)+1:Math.floor((D+C-1)/7)||(((new Date(B-1,0,1)).getDay()+6)%7<4?53:52),F:q.i18n.monthNames[w-1+12],m:k(w),M:q.i18n.monthNames[w-1],n:w,t:"?",L:"?",o:"?",Y:B,y:String(B).substring(2),a:t<12?e.AmPm[0]:e.AmPm[1],A:t<12?e.AmPm[2]:e.AmPm[3],B:"?",g:t%12||12,G:t,h:k(t%12||12),H:k(t),i:k(u),s:k(y),u:z,e:"?",I:"?",O:(x>0?"-":"+")+k(Math.floor(Math.abs(x)/60)*100+Math.abs(x)%60,4),P:"?",T:(String(m).match(g)||[""]).pop().replace(h,""),Z:"?",c:"?",r:"?",U:Math.floor(m/1e3)};return d.replace(f,function(a){return a in E?E[a]:a.substring(1)})}};a.fn.fmatter.defaultFormat=function(b,c){return a.fmatter.isValue(b)&&b!==""?b:c.defaultValue?c.defaultValue:"&#160;"};a.fn.fmatter.email=function(b,c){if(!a.fmatter.isEmpty(b)){return'<a href="mailto:'+b+'">'+b+"</a>"}else{return a.fn.fmatter.defaultFormat(b,c)}};a.fn.fmatter.checkbox=function(b,c){var d=a.extend({},c.checkbox),e;if(!a.fmatter.isUndefined(c.colModel.formatoptions)){d=a.extend({},d,c.colModel.formatoptions)}if(d.disabled===true){e='disabled="disabled"'}else{e=""}if(a.fmatter.isEmpty(b)||a.fmatter.isUndefined(b)){b=a.fn.fmatter.defaultFormat(b,d)}b=b+"";b=b.toLowerCase();var f=b.search(/(false|0|no|off)/i)<0?" checked='checked' ":"";return'<input type="checkbox" '+f+' value="'+b+'" offval="no" '+e+"/>"};a.fn.fmatter.link=function(b,c){var d={target:c.target};var e="";if(!a.fmatter.isUndefined(c.colModel.formatoptions)){d=a.extend({},d,c.colModel.formatoptions)}if(d.target){e="target="+d.target}if(!a.fmatter.isEmpty(b)){return"<a "+e+' href="'+b+'">'+b+"</a>"}else{return a.fn.fmatter.defaultFormat(b,c)}};a.fn.fmatter.showlink=function(b,c){var d={baseLinkUrl:c.baseLinkUrl,showAction:c.showAction,addParam:c.addParam||"",target:c.target,idName:c.idName},e="",f;if(!a.fmatter.isUndefined(c.colModel.formatoptions)){d=a.extend({},d,c.colModel.formatoptions)}if(d.target){e="target="+d.target}f=d.baseLinkUrl+d.showAction+"?"+d.idName+"="+c.rowId+d.addParam;if(a.fmatter.isString(b)||a.fmatter.isNumber(b)){return"<a "+e+' href="'+f+'">'+b+"</a>"}else{return a.fn.fmatter.defaultFormat(b,c)}};a.fn.fmatter.integer=function(b,c){var d=a.extend({},c.integer);if(!a.fmatter.isUndefined(c.colModel.formatoptions)){d=a.extend({},d,c.colModel.formatoptions)}if(a.fmatter.isEmpty(b)){return d.defaultValue}return a.fmatter.util.NumberFormat(b,d)};a.fn.fmatter.number=function(b,c){var d=a.extend({},c.number);if(!a.fmatter.isUndefined(c.colModel.formatoptions)){d=a.extend({},d,c.colModel.formatoptions)}if(a.fmatter.isEmpty(b)){return d.defaultValue}return a.fmatter.util.NumberFormat(b,d)};a.fn.fmatter.currency=function(b,c){var d=a.extend({},c.currency);if(!a.fmatter.isUndefined(c.colModel.formatoptions)){d=a.extend({},d,c.colModel.formatoptions)}if(a.fmatter.isEmpty(b)){return d.defaultValue}return a.fmatter.util.NumberFormat(b,d)};a.fn.fmatter.date=function(b,c,d,e){var f=a.extend({},c.date);if(!a.fmatter.isUndefined(c.colModel.formatoptions)){f=a.extend({},f,c.colModel.formatoptions)}if(!f.reformatAfterEdit&&e=="edit"){return a.fn.fmatter.defaultFormat(b,c)}else if(!a.fmatter.isEmpty(b)){return a.fmatter.util.DateFormat(f.srcformat,b,f.newformat,f)}else{return a.fn.fmatter.defaultFormat(b,c)}};a.fn.fmatter.select=function(b,c,d,e){b=b+"";var f=false,g=[];if(!a.fmatter.isUndefined(c.colModel.formatoptions)){f=c.colModel.formatoptions.value}else if(!a.fmatter.isUndefined(c.colModel.editoptions)){f=c.colModel.editoptions.value}if(f){var h=c.colModel.editoptions.multiple===true?true:false,i=[],j;if(h){i=b.split(",");i=a.map(i,function(b){return a.trim(b)})}if(a.fmatter.isString(f)){var k=f.split(";"),l=0;for(var m=0;m<k.length;m++){j=k[m].split(":");if(j.length>2){j[1]=jQuery.map(j,function(a,b){if(b>0){return a}}).join(":")}if(h){if(jQuery.inArray(j[0],i)>-1){g[l]=j[1];l++}}else if(a.trim(j[0])==a.trim(b)){g[0]=j[1];break}}}else if(a.fmatter.isObject(f)){if(h){g=jQuery.map(i,function(a,b){return f[a]})}else{g[0]=f[b]||""}}}b=g.join(", ");return b===""?a.fn.fmatter.defaultFormat(b,c):b};a.fn.fmatter.rowactions=function(b,c,d,e){var f={keys:false,onEdit:null,onSuccess:null,afterSave:null,onError:null,afterRestore:null,extraparam:{oper:"edit"},url:null,delOptions:{},editOptions:{}};b=a.jgrid.jqID(b);c=a.jgrid.jqID(c);var g=a("#"+c)[0].p.colModel[e];if(!a.fmatter.isUndefined(g.formatoptions)){f=a.extend(f,g.formatoptions)}if(!a.fmatter.isUndefined(a("#"+c)[0].p.editOptions)){f.editOptions=a("#"+c)[0].p.editOptions}if(!a.fmatter.isUndefined(a("#"+c)[0].p.delOptions)){f.delOptions=a("#"+c)[0].p.delOptions}var h=function(d){if(f.afterSave)f.afterSave(d);a("tr#"+b+" div.ui-inline-edit, "+"tr#"+b+" div.ui-inline-del","#"+c+".ui-jqgrid-btable:first").show();a("tr#"+b+" div.ui-inline-save, "+"tr#"+b+" div.ui-inline-cancel","#"+c+".ui-jqgrid-btable:first").hide()},i=function(d){if(f.afterRestore)f.afterRestore(d);a("tr#"+b+" div.ui-inline-edit, "+"tr#"+b+" div.ui-inline-del","#"+c+".ui-jqgrid-btable:first").show();a("tr#"+b+" div.ui-inline-save, "+"tr#"+b+" div.ui-inline-cancel","#"+c+".ui-jqgrid-btable:first").hide()};switch(d){case"edit":a("#"+c).jqGrid("editRow",b,f.keys,f.onEdit,f.onSuccess,f.url,f.extraparam,h,f.onError,i);a("tr#"+b+" div.ui-inline-edit, "+"tr#"+b+" div.ui-inline-del","#"+c+".ui-jqgrid-btable:first").hide();a("tr#"+b+" div.ui-inline-save, "+"tr#"+b+" div.ui-inline-cancel","#"+c+".ui-jqgrid-btable:first").show();break;case"save":if(a("#"+c).jqGrid("saveRow",b,f.onSuccess,f.url,f.extraparam,h,f.onError,i)){a("tr#"+b+" div.ui-inline-edit, "+"tr#"+b+" div.ui-inline-del","#"+c+".ui-jqgrid-btable:first").show();a("tr#"+b+" div.ui-inline-save, "+"tr#"+b+" div.ui-inline-cancel","#"+c+".ui-jqgrid-btable:first").hide()}break;case"cancel":a("#"+c).jqGrid("restoreRow",b,i);a("tr#"+b+" div.ui-inline-edit, "+"tr#"+b+" div.ui-inline-del","#"+c+".ui-jqgrid-btable:first").show();a("tr#"+b+" div.ui-inline-save, "+"tr#"+b+" div.ui-inline-cancel","#"+c+".ui-jqgrid-btable:first").hide();break;case"del":a("#"+c).jqGrid("delGridRow",b,f.delOptions);break;case"formedit":a("#"+c).jqGrid("setSelection",b);a("#"+c).jqGrid("editGridRow",b,f.editOptions);break}};a.fn.fmatter.actions=function(b,c,d){var e={keys:false,editbutton:true,delbutton:true,editformbutton:false};if(!a.fmatter.isUndefined(c.colModel.formatoptions)){e=a.extend(e,c.colModel.formatoptions)}var f=c.rowId,g="",h;if(typeof f=="undefined"||a.fmatter.isEmpty(f)){return""}if(e.editformbutton){h="onclick=jQuery.fn.fmatter.rowactions('"+f+"','"+c.gid+"','formedit',"+c.pos+"); onmouseover=jQuery(this).addClass('ui-state-hover'); onmouseout=jQuery(this).removeClass('ui-state-hover'); ";g=g+"<div title='"+a.jgrid.nav.edittitle+"' style='float:left;cursor:pointer;' class='ui-pg-div ui-inline-edit' "+h+"><span class='ui-icon ui-icon-pencil'></span></div>"}else if(e.editbutton){h="onclick=jQuery.fn.fmatter.rowactions('"+f+"','"+c.gid+"','edit',"+c.pos+"); onmouseover=jQuery(this).addClass('ui-state-hover'); onmouseout=jQuery(this).removeClass('ui-state-hover') ";g=g+"<div title='"+a.jgrid.nav.edittitle+"' style='float:left;cursor:pointer;' class='ui-pg-div ui-inline-edit' "+h+"><span class='ui-icon ui-icon-pencil'></span></div>"}if(e.delbutton){h="onclick=jQuery.fn.fmatter.rowactions('"+f+"','"+c.gid+"','del',"+c.pos+"); onmouseover=jQuery(this).addClass('ui-state-hover'); onmouseout=jQuery(this).removeClass('ui-state-hover'); ";g=g+"<div title='"+a.jgrid.nav.deltitle+"' style='float:left;margin-left:5px;' class='ui-pg-div ui-inline-del' "+h+"><span class='ui-icon ui-icon-trash'></span></div>"}h="onclick=jQuery.fn.fmatter.rowactions('"+f+"','"+c.gid+"','save',"+c.pos+"); onmouseover=jQuery(this).addClass('ui-state-hover'); onmouseout=jQuery(this).removeClass('ui-state-hover'); ";g=g+"<div title='"+a.jgrid.edit.bSubmit+"' style='float:left;display:none' class='ui-pg-div ui-inline-save' "+h+"><span class='ui-icon ui-icon-disk'></span></div>";h="onclick=jQuery.fn.fmatter.rowactions('"+f+"','"+c.gid+"','cancel',"+c.pos+"); onmouseover=jQuery(this).addClass('ui-state-hover'); onmouseout=jQuery(this).removeClass('ui-state-hover'); ";g=g+"<div title='"+a.jgrid.edit.bCancel+"' style='float:left;display:none;margin-left:5px;' class='ui-pg-div ui-inline-cancel' "+h+"><span class='ui-icon ui-icon-cancel'></span></div>";return"<div style='margin-left:8px;'>"+g+"</div>"};a.unformat=function(b,c,d,e){var f,g=c.colModel.formatter,h=c.colModel.formatoptions||{},i,j=/([\.\*\_\'\(\)\{\}\+\?\\])/g,k=c.colModel.unformat||a.fn.fmatter[g]&&a.fn.fmatter[g].unformat;if(typeof k!=="undefined"&&a.isFunction(k)){f=k(a(b).text(),c,b)}else if(!a.fmatter.isUndefined(g)&&a.fmatter.isString(g)){var l=a.jgrid.formatter||{},m;switch(g){case"integer":h=a.extend({},l.integer,h);i=h.thousandsSeparator.replace(j,"\\$1");m=new RegExp(i,"g");f=a(b).text().replace(m,"");break;case"number":h=a.extend({},l.number,h);i=h.thousandsSeparator.replace(j,"\\$1");m=new RegExp(i,"g");f=a(b).text().replace(m,"").replace(h.decimalSeparator,".");break;case"currency":h=a.extend({},l.currency,h);i=h.thousandsSeparator.replace(j,"\\$1");m=new RegExp(i,"g");f=a(b).text().replace(m,"").replace(h.decimalSeparator,".").replace(h.prefix,"").replace(h.suffix,"");break;case"checkbox":var n=c.colModel.editoptions?c.colModel.editoptions.value.split(":"):["Yes","No"];f=a("input",b).is(":checked")?n[0]:n[1];break;case"select":f=a.unformat.select(b,c,d,e);break;case"actions":return"";default:f=a(b).text()}}return f!==undefined?f:e===true?a(b).text():a.jgrid.htmlDecode(a(b).html())};a.unformat.select=function(b,c,d,e){var f=[];var g=a(b).text();if(e===true){return g}var h=a.extend({},c.colModel.editoptions);if(h.value){var i=h.value,j=h.multiple===true?true:false,k=[],l;if(j){k=g.split(",");k=a.map(k,function(b){return a.trim(b)})}if(a.fmatter.isString(i)){var m=i.split(";"),n=0;for(var o=0;o<m.length;o++){l=m[o].split(":");if(l.length>2){l[1]=jQuery.map(l,function(a,b){if(b>0){return a}}).join(":")}if(j){if(jQuery.inArray(l[1],k)>-1){f[n]=l[0];n++}}else if(a.trim(l[1])==a.trim(g)){f[0]=l[0];break}}}else if(a.fmatter.isObject(i)||a.isArray(i)){if(!j){k[0]=g}f=jQuery.map(k,function(b){var c;a.each(i,function(a,d){if(d==b){c=a;return false}});if(typeof c!="undefined"){return c}})}return f.join(", ")}else{return g||""}};a.unformat.date=function(b,c){var d=a.jgrid.formatter.date||{};if(!a.fmatter.isUndefined(c.formatoptions)){d=a.extend({},d,c.formatoptions)}if(!a.fmatter.isEmpty(b)){return a.fmatter.util.DateFormat(d.newformat,b,d.srcformat,d)}else{return a.fn.fmatter.defaultFormat(b,c)}}})(jQuery);(function(a){a.extend(a.jgrid,{showModal:function(a){a.w.show()},closeModal:function(a){a.w.hide().attr("aria-hidden","true");if(a.o){a.o.remove()}},hideModal:function(b,c){c=a.extend({jqm:true,gb:""},c||{});if(c.onClose){var d=c.onClose(b);if(typeof d=="boolean"&&!d){return}}if(a.fn.jqm&&c.jqm===true){a(b).attr("aria-hidden","true").jqmHide()}else{if(a(b).dialog("isOpen")){a(b).dialog("close")}}},findPos:function(a){var b=0,c=0;if(a.offsetParent){do{b+=a.offsetLeft;c+=a.offsetTop}while(a=a.offsetParent)}return[b,c]},createModal:function(b,c,d,e,f,g,h){var i=document.createElement("div"),j,k=this;h=a.extend({},h||{});j=a(d.gbox).attr("dir")=="rtl"?true:false;i.className="ui-widget ui-widget-content ui-corner-all ui-jqdialog";i.id=b.themodal;var l=document.createElement("div");a(l).append(c);i.appendChild(l);if(g===true){a("body").append(i)}else if(typeof g=="string")a(g).append(i);else{a(i).insertBefore(e)}a(i).css(h);if(typeof d.jqModal==="undefined"){d.jqModal=true}var m={};if(a.fn.jqm&&d.jqModal===true){if(d.left===0&&d.top===0&&d.overlay){var n=[];n=this.findPos(f);d.left=n[0]+4;d.top=n[1]+4}m.top=d.top+"px";m.left=d.left}else if(d.left!==0||d.top!==0){m.left=d.left;m.top=d.top+"px"}if(d.width===0||!d.width){d.width=300}if(d.height===0||!d.height){d.height=200}var o=0;if(j&&m.left&&!g){o=a(d.gbox).width()-(!isNaN(d.width)?parseInt(d.width,10):0)-8;m.left=parseInt(m.left,10)+parseInt(o,10)}if(typeof d.drag=="undefined"){d.drag=true}if(typeof d.resize=="undefined"){d.resize=true}if(d.drag){if(a.fn.jqDrag){a(i).jqDrag()}else{try{a(i).draggable()}catch(p){}}}if(d.resize){if(a.fn.jqResize){a(i).append("<div class='jqResize ui-resizable-handle ui-resizable-se ui-icon ui-icon-gripsmall-diagonal-se ui-icon-grip-diagonal-se'></div>");a("#"+b.themodal).jqResize(".jqResize",b.scrollelm?"#"+b.scrollelm:false)}else{try{a(i).resizable({handles:"se, sw",alsoResize:b.scrollelm?"#"+b.scrollelm:false})}catch(q){}}}if(d.closeOnEscape===true){a(i).keydown(function(c){if(c.which==27){var e=a("#"+b.themodal).data("onClose")||d.onClose;k.hideModal(this,{gb:d.gbox,jqm:d.jqModal,onClose:e})}})}},viewModal:function(b,c){c=a.extend({toTop:true,overlay:10,modal:false,width:300,overlayClass:"ui-widget-overlay",onShow:this.showModal,onHide:this.closeModal,gbox:"",jqm:true,jqM:true,rightButton:"Save",rightButtonId:"sData",leftButton:"Cancel",leftButtonId:"cancelData"},c||{});if(a.fn.jqm&&c.jqm===true){if(c.jqM){a(b).attr("aria-hidden","false").jqm(c).jqmShow()}else{a(b).attr("aria-hidden","false").jqmShow()}}else{if(a(b).dialog("isOpen")!==false){a(b).attr("aria-hidden","false").dialog({modal:true,width:c.width,draggable:false,resizable:false,title:a(b).data("title"),show:{effect:"slide",complete:function(){setTimeout(function(){try{a(":input:visible",b)[0].focus()}catch(c){}},50)}},hide:{effect:"fade",duration:300},close:function(d,e){a.jgrid.hideModal(b,{gb:c.gbox,jqm:false,onClose:a(b).data("onClose")})},buttons:{Confirm:{id:c.rightButtonId,text:c.rightButton,click:function(){return true}},Cancel:{id:c.leftButtonId,text:c.leftButton,click:function(){a(b).dialog("close")}}}})}else{a(b).dialog("option","title",a(b).data("title"));a(b).dialog("open")}}},info_dialog:function(b,c,d,e){var f={width:290,height:"auto",dataheight:"auto",drag:true,resize:false,caption:"<b>"+b+"</b>",left:250,top:170,zIndex:1e3,jqModal:true,modal:false,closeOnEscape:true,align:"center",buttonalign:"center",buttons:[]};a.extend(f,e||{});var g=f.jqModal,h=this;if(a.fn.jqm&&!g){g=false}var i="";if(f.buttons.length>0){for(var j=0;j<f.buttons.length;j++){if(typeof f.buttons[j].id=="undefined"){f.buttons[j].id="info_button_"+j}i+="<a href='javascript:void(0)' id='"+f.buttons[j].id+"' class='fm-button ui-state-default ui-corner-all'>"+f.buttons[j].text+"</a>"}}var k=isNaN(f.dataheight)?f.dataheight:f.dataheight+"px",l="text-align:"+f.align+";";var m="<div id='info_id'>";m+="<div id='infocnt' style='margin:0px;padding-bottom:1em;width:100%;overflow:auto;position:relative;height:"+k+";"+l+"'>"+c+"</div>";m+=d?"<div class='ui-widget-content ui-helper-clearfix' style='text-align:"+f.buttonalign+";padding-bottom:0.8em;padding-top:0.5em;background-image: none;border-width: 1px 0 0 0;'><a href='javascript:void(0)' id='closedialog' class='fm-button ui-state-default ui-corner-all'>"+d+"</a>"+i+"</div>":i!==""?"<div class='ui-widget-content ui-helper-clearfix' style='text-align:"+f.buttonalign+";padding-bottom:0.8em;padding-top:0.5em;background-image: none;border-width: 1px 0 0 0;'>"+i+"</div>":"";m+="</div>";try{if(a("#info_dialog").attr("aria-hidden")=="false"){this.hideModal("#info_dialog",{jqm:g})}a("#info_dialog").remove()}catch(n){}this.createModal({themodal:"info_dialog",modalhead:"info_head",modalcontent:"info_content",scrollelm:"infocnt"},m,f,"","",true);if(i){a.each(f.buttons,function(b){a("#"+this.id,"#info_id").bind("click",function(){f.buttons[b].onClick.call(a("#info_dialog"));return false})})}a("#closedialog","#info_id").click(function(a){h.hideModal("#info_dialog",{jqm:g});return false});a(".fm-button","#info_dialog").hover(function(){a(this).addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover")});if(a.isFunction(f.beforeOpen)){f.beforeOpen()}this.viewModal("#info_dialog",{onHide:function(a){a.w.hide().remove();if(a.o){a.o.remove()}},modal:f.modal,jqm:g});if(a.isFunction(f.afterOpen)){f.afterOpen()}try{a("#info_dialog").focus()}catch(o){}},createEl:function(b,c,d,e,f){function i(b,c,d){var e=["dataInit","dataEvents","dataUrl","buildSelect","sopt","searchhidden","defaultValue","attr"];if(typeof d!="undefined"&&a.isArray(d)){e=a.extend(e,d)}a.each(c,function(c,d){if(a.inArray(c,e)===-1){a(b).attr(c,d)}});if(!c.hasOwnProperty("id")){a(b).attr("id",a.jgrid.randId())}}function h(b,c){if(a.isFunction(c.dataInit)){c.dataInit(b)}if(c.dataEvents){a.each(c.dataEvents,function(){if(this.data!==undefined){a(b).bind(this.type,this.data,this.fn)}else{a(b).bind(this.type,this.fn)}})}return c}var g="";switch(b){case"textarea":g=document.createElement("textarea");if(e){if(!c.cols){a(g).css({width:"98%"})}}else if(!c.cols){c.cols=20}if(!c.rows){c.rows=2}if(d==" "||d=="&#160;"||d.length==1&&d.charCodeAt(0)==160){d=""}g.value=d;i(g,c);c=h(g,c);a(g).attr({role:"textbox",multiline:"true"});break;case"checkbox":g=document.createElement("input");g.type="checkbox";if(!c.value){var j=d.toLowerCase();if(j.search(/(false|0|no|off|undefined)/i)<0&&j!==""){g.checked=true;g.defaultChecked=true;g.value=d}else{g.value="on"}a(g).attr("offval","off")}else{var k=c.value.split(":");if(d===k[0]){g.checked=true;g.defaultChecked=true}g.value=k[0];a(g).attr("offval",k[1])}i(g,c,["value"]);c=h(g,c);a(g).attr("role","checkbox");break;case"select":g=document.createElement("select");g.setAttribute("role","select");var l,m=[];if(c.multiple===true){l=true;g.multiple="multiple";a(g).attr("aria-multiselectable","true")}else{l=false}if(typeof c.dataUrl!="undefined"){a.ajax(a.extend({url:c.dataUrl,type:"GET",dataType:"html",context:{elem:g,options:c,vl:d},success:function(b,c){var d,e=[],f=this.elem,g=this.vl,j=a.extend({},this.options),k=j.multiple===true;if(typeof j.buildSelect!="undefined"){var l=j.buildSelect(b);d=a(l).html()}else{d=a(b).html()}if(d){a(f).append(d);i(f,j);j=h(f,j);if(typeof j.size==="undefined"){j.size=k?3:1}if(k){e=g.split(",");e=a.map(e,function(b){return a.trim(b)})}else{e[0]=a.trim(g)}setTimeout(function(){a("option",f).each(function(b){a(this).attr("role","option");if(a.inArray(a.trim(a(this).text()),e)>-1||a.inArray(a.trim(a(this).val()),e)>-1){this.selected="selected"}})},0)}}},f||{}))}else if(c.value){var n;if(typeof c.size==="undefined"){c.size=l?3:1}if(l){m=d.split(",");m=a.map(m,function(b){return a.trim(b)})}if(typeof c.value==="function"){c.value=c.value()}var o,p,q;if(typeof c.value==="string"){o=c.value.split(";");for(n=0;n<o.length;n++){p=o[n].split(":");if(p.length>2){p[1]=a.map(p,function(a,b){if(b>0){return a}}).join(":")}q=document.createElement("option");q.setAttribute("role","option");q.value=p[0];q.innerHTML=p[1];g.appendChild(q);if(!l&&(a.trim(p[0])==a.trim(d)||a.trim(p[1])==a.trim(d))){q.selected="selected"}if(l&&(a.inArray(a.trim(p[1]),m)>-1||a.inArray(a.trim(p[0]),m)>-1)){q.selected="selected"}}}else if(typeof c.value==="object"){var r=c.value;for(var s in r){if(r.hasOwnProperty(s)){q=document.createElement("option");q.setAttribute("role","option");q.value=s;q.innerHTML=r[s];g.appendChild(q);if(!l&&(a.trim(s)==a.trim(d)||a.trim(r[s])==a.trim(d))){q.selected="selected"}if(l&&(a.inArray(a.trim(r[s]),m)>-1||a.inArray(a.trim(s),m)>-1)){q.selected="selected"}}}}i(g,c,["value"]);c=h(g,c)}break;case"text":case"password":case"button":var t;if(b=="button"){t="button"}else{t="textbox"}g=document.createElement("input");g.type=b;g.value=d;i(g,c);c=h(g,c);if(b!="button"){if(e){if(!c.size){a(g).css({width:"98%"})}}else if(!c.size){c.size=20}}a(g).attr("role",t);break;case"image":case"file":g=document.createElement("input");g.type=b;i(g,c);c=h(g,c);break;case"custom":g=document.createElement("span");try{if(a.isFunction(c.custom_element)){var u=c.custom_element.call(this,d,c);if(u){u=a(u).addClass("customelement").attr({id:c.id,name:c.name});a(g).empty().append(u)}else{throw"e2"}}else{throw"e1"}}catch(v){if(v=="e1"){this.info_dialog(a.jgrid.errors.errcap,"function 'custom_element' "+a.jgrid.edit.msg.nodefined,a.jgrid.edit.bClose)}if(v=="e2"){this.info_dialog(a.jgrid.errors.errcap,"function 'custom_element' "+a.jgrid.edit.msg.novalue,a.jgrid.edit.bClose)}else{this.info_dialog(a.jgrid.errors.errcap,typeof v==="string"?v:v.message,a.jgrid.edit.bClose)}}break}return g},checkDate:function(a,b){var c=function(a){return a%4===0&&(a%100!==0||a%400===0)?29:28},d=function(a){for(var b=1;b<=a;b++){this[b]=31;if(b==4||b==6||b==9||b==11){this[b]=30}if(b==2){this[b]=29}}return this};var e={},f;a=a.toLowerCase();if(a.indexOf("/")!=-1){f="/"}else if(a.indexOf("-")!=-1){f="-"}else if(a.indexOf(".")!=-1){f="."}else{f="/"}a=a.split(f);b=b.split(f);if(b.length!=3){return false}var g=-1,h,i=-1,j=-1;for(var k=0;k<a.length;k++){var l=isNaN(b[k])?0:parseInt(b[k],10);e[a[k]]=l;h=a[k];if(h.indexOf("y")!=-1){g=k}if(h.indexOf("m")!=-1){j=k}if(h.indexOf("d")!=-1){i=k}}if(a[g]=="y"||a[g]=="yyyy"){h=4}else if(a[g]=="yy"){h=2}else{h=-1}var m=d(12),n;if(g===-1){return false}else{n=e[a[g]].toString();if(h==2&&n.length==1){h=1}if(n.length!=h||e[a[g]]===0&&b[g]!="00"){return false}}if(j===-1){return false}else{n=e[a[j]].toString();if(n.length<1||e[a[j]]<1||e[a[j]]>12){return false}}if(i===-1){return false}else{n=e[a[i]].toString();if(n.length<1||e[a[i]]<1||e[a[i]]>31||e[a[j]]==2&&e[a[i]]>c(e[a[g]])||e[a[i]]>m[e[a[j]]]){return false}}return true},isEmpty:function(a){if(a.match(/^\s+$/)||a===""){return true}else{return false}},checkTime:function(a){var b=/^(\d{1,2}):(\d{2})([ap]m)?$/,c;if(!this.isEmpty(a)){c=a.match(b);if(c){if(c[3]){if(c[1]<1||c[1]>12){return false}}else{if(c[1]>23){return false}}if(c[2]>59){return false}}else{return false}}return true},checkValues:function(b,c,d,e,f){var g,h,i,j,k;if(typeof e==="undefined"){if(typeof c=="string"){for(h=0,k=d.p.colModel.length;h<k;h++){if(d.p.colModel[h].name==c){g=d.p.colModel[h].editrules;c=h;try{i=d.p.colModel[h].formoptions.label}catch(l){}break}}}else if(c>=0){g=d.p.colModel[c].editrules}}else{g=e;i=f===undefined?"_":f}if(g){if(!i){i=d.p.colNames[c]}if(g.required===true){if(this.isEmpty(b)){return[false,i+": "+a.jgrid.edit.msg.required,""]}}var m=g.required===false?false:true;if(g.number===true){if(!(m===false&&this.isEmpty(b))){if(isNaN(b)){return[false,i+": "+a.jgrid.edit.msg.number,""]}}}if(typeof g.minValue!="undefined"&&!isNaN(g.minValue)){if(parseFloat(b)<parseFloat(g.minValue)){return[false,i+": "+a.jgrid.edit.msg.minValue+" "+g.minValue,""]}}if(typeof g.maxValue!="undefined"&&!isNaN(g.maxValue)){if(parseFloat(b)>parseFloat(g.maxValue)){return[false,i+": "+a.jgrid.edit.msg.maxValue+" "+g.maxValue,""]}}var n;if(g.email===true){if(!(m===false&&this.isEmpty(b))){n=/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i;if(!n.test(b)){return[false,i+": "+a.jgrid.edit.msg.email,""]}}}if(g.integer===true){if(!(m===false&&this.isEmpty(b))){if(isNaN(b)){return[false,i+": "+a.jgrid.edit.msg.integer,""]}if(b%1!==0||b.indexOf(".")!=-1){return[false,i+": "+a.jgrid.edit.msg.integer,""]}}}if(g.date===true){if(!(m===false&&this.isEmpty(b))){if(d.p.colModel[c].formatoptions&&d.p.colModel[c].formatoptions.newformat){j=d.p.colModel[c].formatoptions.newformat}else{j=d.p.colModel[c].datefmt||"Y-m-d"}if(!this.checkDate(j,b)){return[false,i+": "+a.jgrid.edit.msg.date+" - "+j,""]}}}if(g.time===true){if(!(m===false&&this.isEmpty(b))){if(!this.checkTime(b)){return[false,i+": "+a.jgrid.edit.msg.date+" - hh:mm (am/pm)",""]}}}if(g.url===true){if(!(m===false&&this.isEmpty(b))){n=/^(((https?)|(ftp)):\/\/([\-\w]+\.)+\w{2,3}(\/[%\-\w]+(\.\w{2,})?)*(([\w\-\.\?\\\/+@&#;`~=%!]*)(\.\w{2,})?)*\/?)/i;if(!n.test(b)){return[false,i+": "+a.jgrid.edit.msg.url,""]}}}if(g.custom===true){if(!(m===false&&this.isEmpty(b))){if(a.isFunction(g.custom_func)){var o=g.custom_func.call(d,b,i);if(a.isArray(o)){return o}else{return[false,a.jgrid.edit.msg.customarray,""]}}else{return[false,a.jgrid.edit.msg.customfcheck,""]}}}}return[true,"",""]}})})(jQuery);(function(a){a.fn.jqFilter=function(b){if(typeof b==="string"){var c=a.fn.jqFilter[b];if(!c){throw"jqFilter - No such method: "+b}var d=a.makeArray(arguments).slice(1);return c.apply(this,d)}var e=a.extend(true,{filter:null,columns:[],onChange:null,afterRedraw:null,checkValues:null,error:false,errmsg:"",errorcheck:true,showQuery:true,sopt:null,ops:[{name:"eq",description:"equal",operator:"="},{name:"ne",description:"not equal",operator:"<>"},{name:"lt",description:"less",operator:"<"},{name:"le",description:"less or equal",operator:"<="},{name:"gt",description:"greater",operator:">"},{name:"ge",description:"greater or equal",operator:">="},{name:"bw",description:"begins with",operator:"LIKE"},{name:"bn",description:"does not begin with",operator:"NOT LIKE"},{name:"in",description:"in",operator:"IN"},{name:"ni",description:"not in",operator:"NOT IN"},{name:"ew",description:"ends with",operator:"LIKE"},{name:"en",description:"does not end with",operator:"NOT LIKE"},{name:"cn",description:"contains",operator:"LIKE"},{name:"nc",description:"does not contain",operator:"NOT LIKE"},{name:"nu",description:"is null",operator:"IS NULL"},{name:"nn",description:"is not null",operator:"IS NOT NULL"}],numopts:["eq","ne","lt","le","gt","ge","nu","nn","in","ni"],stropts:["eq","ne","bw","bn","ew","en","cn","nc","nu","nn","in","ni"],_gridsopt:[],groupOps:["AND","OR"],groupButton:true,ruleButtons:true,direction:"ltr"},b||{});return this.each(function(){if(this.filter){return}this.p=e;if(this.p.filter===null||this.p.filter===undefined){this.p.filter={groupOp:this.p.groupOps[0],rules:[],groups:[]}}var b,c=this.p.columns.length,d,f=/msie/i.test(navigator.userAgent)&&!window.opera;if(this.p._gridsopt.length){for(b=0;b<this.p._gridsopt.length;b++){this.p.ops[b].description=this.p._gridsopt[b]}}this.p.initFilter=a.extend(true,{},this.p.filter);if(!c){return}for(b=0;b<c;b++){d=this.p.columns[b];if(d.stype){d.inputtype=d.stype}else if(!d.inputtype){d.inputtype="text"}if(d.sorttype){d.searchtype=d.sorttype}else if(!d.searchtype){d.searchtype="string"}if(d.hidden===undefined){d.hidden=false}if(!d.label){d.label=d.name}if(d.index){d.name=d.index}if(!d.hasOwnProperty("searchoptions")){d.searchoptions={}}if(!d.hasOwnProperty("searchrules")){d.searchrules={}}}if(this.p.showQuery){a(this).append("<table class='queryresult ui-widget ui-widget-content' style='display:block;max-width:440px;border:0px none;' dir='"+this.p.direction+"'><tbody><tr><td class='query'></td></tr></tbody></table>")}var g=function(b,c){var d=[true,""];if(a.isFunction(c.searchrules)){d=c.searchrules(b,c)}else if(a.jgrid&&a.jgrid.checkValues){try{d=a.jgrid.checkValues(b,-1,null,c.searchrules,c.label)}catch(f){}}if(d&&d.length&&d[0]===false){e.error=!d[0];e.errmsg=d[1]}};this.onchange=function(){this.p.error=false;this.p.errmsg="";return a.isFunction(this.p.onChange)?this.p.onChange.call(this,this.p):false};this.reDraw=function(){a("table.group:first",this).remove();var b=this.createTableForGroup(e.filter,null);a(this).append(b);if(a.isFunction(this.p.afterRedraw)){this.p.afterRedraw.call(this,this.p)}};this.createTableForGroup=function(b,c){var d=this,f;var g=a("<table class='group ui-widget ui-widget-content' style='border:0px none;'><tbody></tbody></table>"),h="left";if(this.p.direction=="rtl"){h="right";g.attr("dir","rtl")}if(c===null){g.append("<tr class='error' style='display:none;'><th colspan='5' class='ui-state-error' align='"+h+"'></th></tr>")}var i=a("<tr></tr>");g.append(i);var j=a("<th colspan='5' align='"+h+"'></th>");i.append(j);if(this.p.ruleButtons===true){var k=a("<select class='opsel'></select>");j.append(k);var l="",m;for(f=0;f<e.groupOps.length;f++){m=b.groupOp===d.p.groupOps[f]?" selected='selected'":"";l+="<option value='"+d.p.groupOps[f]+"'"+m+">"+d.p.groupOps[f]+"</option>"}k.append(l).bind("change",function(){b.groupOp=a(k).val();d.onchange()})}var n="<span></span>";if(this.p.groupButton){n=a("<input type='button' value='+ {}' title='Add subgroup' class='add-group'/>");n.bind("click",function(){if(b.groups===undefined){b.groups=[]}b.groups.push({groupOp:e.groupOps[0],rules:[],groups:[]});d.reDraw();d.onchange();return false})}j.append(n);if(this.p.ruleButtons===true){var o=a("<input type='button' value='+' title='Add rule' class='add-rule ui-add'/>"),q;o.bind("click",function(){if(b.rules===undefined){b.rules=[]}for(f=0;f<d.p.columns.length;f++){var a=typeof d.p.columns[f].search==="undefined"?true:d.p.columns[f].search,c=d.p.columns[f].hidden===true,e=d.p.columns[f].searchoptions.searchhidden===true;if(e&&a||a&&!c){q=d.p.columns[f];break}}var g;if(q.searchoptions.sopt){g=q.searchoptions.sopt}else if(d.p.sopt){g=d.p.sopt}else if(q.searchtype==="string"){g=d.p.stropts}else{g=d.p.numopts}b.rules.push({field:q.name,op:g[0],data:""});d.reDraw();return false});j.append(o)}if(c!==null){var r=a("<input type='button' value='-' title='Delete group' class='delete-group'/>");j.append(r);r.bind("click",function(){for(f=0;f<c.groups.length;f++){if(c.groups[f]===b){c.groups.splice(f,1);break}}d.reDraw();d.onchange();return false})}if(b.groups!==undefined){for(f=0;f<b.groups.length;f++){var s=a("<tr></tr>");g.append(s);var t=a("<td class='first'></td>");s.append(t);var u=a("<td colspan='4'></td>");u.append(this.createTableForGroup(b.groups[f],b));s.append(u)}}if(b.groupOp===undefined){b.groupOp=d.p.groupOps[0]}if(b.rules!==undefined){for(f=0;f<b.rules.length;f++){g.append(this.createTableRowForRule(b.rules[f],b))}}return g};this.createTableRowForRule=function(b,c){var d=this,g=a("<tr></tr>"),h,i,j,k,l="",m;g.append("<td class='first'></td>");var n=a("<td class='columns'></td>");g.append(n);var o=a("<select></select>"),q,r=[];n.append(o);o.bind("change",function(){b.field=a(o).val();j=a(this).parents("tr:first");for(h=0;h<d.p.columns.length;h++){if(d.p.columns[h].name===b.field){k=d.p.columns[h];break}}if(!k){return}k.searchoptions.id=a.jgrid.randId();if(f&&k.inputtype==="text"){if(!k.searchoptions.size){k.searchoptions.size=10}}var c=a.jgrid.createEl(k.inputtype,k.searchoptions,"",true,d.p.ajaxSelectOptions,true);a(c).addClass("input-elm");if(k.searchoptions.sopt){i=k.searchoptions.sopt}else if(d.p.sopt){i=d.p.sopt}else if(k.searchtype==="string"){i=d.p.stropts}else{i=d.p.numopts}var e="",g=0;r=[];a.each(d.p.ops,function(){r.push(this.name)});for(h=0;h<i.length;h++){q=a.inArray(i[h],r);if(q!==-1){if(g===0){b.op=d.p.ops[q].name}e+="<option value='"+d.p.ops[q].name+"'>"+d.p.ops[q].description+"</option>";g++}}a(".selectopts",j).empty().append(e);a(".selectopts",j)[0].selectedIndex=0;if(a.browser.msie&&a.browser.version<9){var l=parseInt(a("select.selectopts",j)[0].offsetWidth)+1;a(".selectopts",j).width(l);a(".selectopts",j).css("width","auto")}a(".data",j).empty().append(c);a(".input-elm",j).bind("change",function(){b.data=a(this).val();d.onchange()});setTimeout(function(){b.data=a(c).val();d.onchange()},0)});var s=0;for(h=0;h<d.p.columns.length;h++){var t=typeof d.p.columns[h].search==="undefined"?true:d.p.columns[h].search,u=d.p.columns[h].hidden===true,v=d.p.columns[h].searchoptions.searchhidden===true;if(v&&t||t&&!u){m="";if(b.field===d.p.columns[h].name){m=" selected='selected'";s=h}l+="<option value='"+d.p.columns[h].name+"'"+m+">"+d.p.columns[h].label+"</option>"}}o.append(l);var w=a("<td class='operators'></td>");g.append(w);k=e.columns[s];k.searchoptions.id=a.jgrid.randId();if(f&&k.inputtype==="text"){if(!k.searchoptions.size){k.searchoptions.size=10}}var x=a.jgrid.createEl(k.inputtype,k.searchoptions,b.data,true,d.p.ajaxSelectOptions,true);var y=a("<select class='selectopts'></select>");w.append(y);y.bind("change",function(){b.op=a(y).val();j=a(this).parents("tr:first");var c=a(".input-elm",j)[0];if(b.op==="nu"||b.op==="nn"){b.data="";c.value="";c.setAttribute("readonly","true");c.setAttribute("disabled","true")}else{c.removeAttribute("readonly");c.removeAttribute("disabled")}d.onchange()});if(k.searchoptions.sopt){i=k.searchoptions.sopt}else if(d.p.sopt){i=d.p.sopt}else if(k.searchtype==="string"){i=e.stropts}else{i=d.p.numopts}l="";a.each(d.p.ops,function(){r.push(this.name)});for(h=0;h<i.length;h++){q=a.inArray(i[h],r);if(q!==-1){m=b.op===d.p.ops[q].name?" selected='selected'":"";l+="<option value='"+d.p.ops[q].name+"'"+m+">"+d.p.ops[q].description+"</option>"}}y.append(l);var z=a("<td class='data'></td>");g.append(z);z.append(x);a(x).addClass("input-elm").bind("change",function(){b.data=a(this).val();d.onchange()});var A=a("<td></td>");g.append(A);if(this.p.ruleButtons===true){var B=a("<input type='button' value='-' title='Delete rule' class='delete-rule ui-del'/>");A.append(B);B.bind("click",function(){for(h=0;h<c.rules.length;h++){if(c.rules[h]===b){c.rules.splice(h,1);break}}d.reDraw();d.onchange();return false})}return g};this.getStringForGroup=function(a){var b="(",c;if(a.groups!==undefined){for(c=0;c<a.groups.length;c++){if(b.length>1){b+=" "+a.groupOp+" "}try{b+=this.getStringForGroup(a.groups[c])}catch(d){alert(d)}}}if(a.rules!==undefined){try{for(c=0;c<a.rules.length;c++){if(b.length>1){b+=" "+a.groupOp+" "}b+=this.getStringForRule(a.rules[c])}}catch(e){alert(e)}}b+=")";if(b==="()"){return""}else{return b}};this.getStringForRule=function(b){var c="",d="",f,h,i,j,k=["int","integer","float","number","currency"];for(f=0;f<this.p.ops.length;f++){if(this.p.ops[f].name===b.op){c=this.p.ops[f].operator;d=this.p.ops[f].name;break}}for(f=0;f<this.p.columns.length;f++){if(this.p.columns[f].name===b.field){h=this.p.columns[f];break}}j=b.data;if(d==="bw"||d==="bn"){j=j+"%"}if(d==="ew"||d==="en"){j="%"+j}if(d==="cn"||d==="nc"){j="%"+j+"%"}if(d==="in"||d==="ni"){j=" ("+j+")"}if(e.errorcheck){g(b.data,h)}if(a.inArray(h.searchtype,k)!==-1||d==="nn"||d==="nu"){i=b.field+" "+c+" "+j}else{i=b.field+" "+c+' "'+j+'"'}return i};this.resetFilter=function(){this.p.filter=a.extend(true,{},this.p.initFilter);this.reDraw();this.onchange()};this.hideError=function(){a("th.ui-state-error",this).html("");a("tr.error",this).hide()};this.showError=function(){a("th.ui-state-error",this).html(this.p.errmsg);a("tr.error",this).show()};this.toUserFriendlyString=function(){return this.getStringForGroup(e.filter)};this.toString=function(){function c(a){var d="(",e;if(a.groups!==undefined){for(e=0;e<a.groups.length;e++){if(d.length>1){if(a.groupOp==="OR"){d+=" || "}else{d+=" && "}}d+=c(a.groups[e])}}if(a.rules!==undefined){for(e=0;e<a.rules.length;e++){if(d.length>1){if(a.groupOp==="OR"){d+=" || "}else{d+=" && "}}d+=b(a.rules[e])}}d+=")";if(d==="()"){return""}else{return d}}function b(b){if(a.p.errorcheck){var c,d;for(c=0;c<a.p.columns.length;c++){if(a.p.columns[c].name===b.field){d=a.p.columns[c];break}}if(d){g(b.data,d)}}return b.op+"(item."+b.field+",'"+b.data+"')"}var a=this;return c(this.p.filter)};this.reDraw();if(this.p.showQuery){this.onchange()}this.filter=true})};a.extend(a.fn.jqFilter,{toSQLString:function(){var a="";this.each(function(){a=this.toUserFriendlyString()});return a},filterData:function(){var a;this.each(function(){a=this.p.filter});return a},getParameter:function(a){if(a!==undefined){if(this.p.hasOwnProperty(a)){return this.p[a]}}return this.p},resetFilter:function(){return this.each(function(){this.resetFilter()})},addFilter:function(a){if(typeof a==="string"){a=jQuery.jgrid.parse(a)}this.each(function(){this.p.filter=a;this.reDraw();this.onchange()})}})})(jQuery);(function(a){var b={};a.jgrid.extend({searchGrid:function(b){b=a.extend({recreateFilter:false,drag:true,sField:"searchField",sValue:"searchString",sOper:"searchOper",sFilter:"filters",loadDefaults:true,beforeShowSearch:null,afterShowSearch:null,onInitializeSearch:null,afterRedraw:null,closeAfterSearch:false,closeAfterReset:false,closeOnEscape:false,multipleSearch:false,multipleGroup:false,top:0,left:0,jqModal:true,modal:false,resize:true,width:450,height:"auto",dataheight:"auto",showQuery:false,errorcheck:true,sopt:null,stringResult:undefined,onClose:null,onSearch:null,onReset:null,toTop:true,overlay:30,columns:[],tmplNames:null,tmplFilters:null,tmplLabel:" Template: ",showOnLoad:false,layer:null},a.jgrid.search,b||{});return this.each(function(){function h(){if(a.isFunction(b.beforeShowSearch)){e=b.beforeShowSearch(a("#"+d));if(typeof e==="undefined"){e=true}}if(e){a.jgrid.viewModal("#"+f.themodal,{gbox:"#gbox_"+d,jqm:b.jqModal,modal:b.modal,overlay:b.overlay,toTop:b.toTop});if(a.isFunction(b.afterShowSearch)){b.afterShowSearch(a("#"+d))}}}var c=this;if(!c.grid){return}var d="fbox_"+c.p.id,e=true,f={themodal:"searchmod"+d,modalhead:"searchhd"+d,modalcontent:"searchcnt"+d,scrollelm:d},g=c.p.postData[b.sFilter];if(typeof g==="string"){g=a.jgrid.parse(g)}if(b.recreateFilter===true){a("#"+f.themodal).remove()}if(a("#"+f.themodal).html()!==null){h()}else{var i=a("<div><div id='"+d+"' class='searchFilter' style='overflow:auto'></div></div>").insertBefore("#gview_"+c.p.id),j="left",k="";if(c.p.direction=="rtl"){j="right";k=" style='text-align:left'";i.attr("dir","rtl")}if(a.isFunction(b.onInitializeSearch)){b.onInitializeSearch(a("#"+d))}var l=a.extend([],c.p.colModel),m="<a href='javascript:void(0)' id='"+d+"_search' class='fm-button ui-state-default ui-corner-all fm-button-icon-right ui-reset'><span class='ui-icon ui-icon-search'></span>"+b.Find+"</a>",n="<a href='javascript:void(0)' id='"+d+"_reset' class='fm-button ui-state-default ui-corner-all fm-button-icon-left ui-search'><span class='ui-icon ui-icon-arrowreturnthick-1-w'></span>"+b.Reset+"</a>",o="",q="",r,s=false,t,u=-1;if(b.showQuery){o="<a href='javascript:void(0)' id='"+d+"_query' class='fm-button ui-state-default ui-corner-all fm-button-icon-left'><span class='ui-icon ui-icon-comment'></span>Query</a>"}if(!b.columns.length){a.each(l,function(a,b){if(!b.label){b.label=c.p.colNames[a]}if(!s){var d=typeof b.search==="undefined"?true:b.search,e=b.hidden===true,f=b.searchoptions&&b.searchoptions.searchhidden===true;if(f&&d||d&&!e){s=true;r=b.index||b.name;u=a}}})}else{l=b.columns}if(!g&&r||b.multipleSearch===false){var v="eq";if(u>=0&&l[u].searchoptions&&l[u].searchoptions.sopt){v=l[u].searchoptions.sopt[0]}else if(b.sopt&&b.sopt.length){v=b.sopt[0]}g={groupOp:"AND",rules:[{field:r,op:v,data:""}]}}s=false;if(b.tmplNames&&b.tmplNames.length){s=true;q=b.tmplLabel;q+="<select class='ui-template'>";q+="<option value='default'>Default</option>";a.each(b.tmplNames,function(a,b){q+="<option value='"+a+"'>"+b+"</option>"});q+="</select>"}t="<table class='EditTable' style='border:0px none;margin-top:5px' id='"+d+"_2'><tbody><tr><td colspan='2'><hr class='ui-widget-content' style='margin:1px'/></td></tr><tr><td class='EditButton' style='text-align:"+j+"'>"+n+q+"</td><td class='EditButton' "+k+">"+o+m+"</td></tr></tbody></table>";a("#"+d).jqFilter({columns:l,filter:b.loadDefaults?g:null,showQuery:b.showQuery,errorcheck:b.errorcheck,sopt:b.sopt,groupButton:b.multipleGroup,ruleButtons:b.multipleSearch,afterRedraw:b.afterRedraw,_gridsopt:a.jgrid.search.odata,onChange:function(b){if(this.p.showQuery){a(".query",this).html(this.toUserFriendlyString())}},direction:c.p.direction});i.append(t);if(s&&b.tmplFilters&&b.tmplFilters.length){a(".ui-template",i).bind("change",function(c){var e=a(this).val();if(e=="default"){a("#"+d).jqFilter("addFilter",g)}else{a("#"+d).jqFilter("addFilter",b.tmplFilters[parseInt(e,10)])}return false})}if(b.multipleGroup===true)b.multipleSearch=true;if(a.isFunction(b.onInitializeSearch)){b.onInitializeSearch(a("#"+d))}b.gbox="#gbox_"+d;if(b.layer)a.jgrid.createModal(f,i,b,"#gview_"+c.p.id,a("#gbox_"+c.p.id)[0],"#"+b.layer,{position:"relative"});else a.jgrid.createModal(f,i,b,"#gview_"+c.p.id,a("#gbox_"+c.p.id)[0]);if(o){a("#"+d+"_query").bind("click",function(b){a(".queryresult",i).toggle();return false})}if(b.stringResult===undefined){b.stringResult=b.multipleSearch}a("#"+d+"_search").bind("click",function(){var e=a("#"+d),g={},h,i=e.jqFilter("filterData");if(b.errorcheck){e[0].hideError();if(!b.showQuery){e.jqFilter("toSQLString")}if(e[0].p.error){e[0].showError();return false}}if(b.stringResult){try{h=xmlJsonClass.toJson(i,"","",false)}catch(j){try{h=JSON.stringify(i)}catch(k){}}if(typeof h==="string"){g[b.sFilter]=h;a.each([b.sField,b.sValue,b.sOper],function(){g[this]=""})}}else{if(b.multipleSearch){g[b.sFilter]=i;a.each([b.sField,b.sValue,b.sOper],function(){g[this]=""})}else{g[b.sField]=i.rules[0].field;g[b.sValue]=i.rules[0].data;g[b.sOper]=i.rules[0].op;g[b.sFilter]=""}}c.p.search=true;a.extend(c.p.postData,g);if(a.isFunction(b.onSearch)){b.onSearch()}a(c).trigger("reloadGrid",[{page:1}]);if(b.closeAfterSearch){a.jgrid.hideModal("#"+f.themodal,{gb:"#gbox_"+c.p.id,jqm:b.jqModal,onClose:b.onClose})}return false});a("#"+d+"_reset").bind("click",function(){var e={},f=a("#"+d);c.p.search=false;if(b.multipleSearch===false){e[b.sField]=e[b.sValue]=e[b.sOper]=""}else{e[b.sFilter]=""}f[0].resetFilter();if(s){a(".ui-template",i).val("default")}a.extend(c.p.postData,e);if(a.isFunction(b.onReset)){b.onReset()}a(c).trigger("reloadGrid",[{page:1}]);return false});h();a(".fm-button:not(.ui-state-disabled)",i).hover(function(){a(this).addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover")})}})},editGridRow:function(c,d){d=a.extend({top:0,left:0,width:300,height:"auto",dataheight:"auto",modal:false,overlay:30,drag:true,resize:true,url:null,mtype:"POST",clearAfterAdd:true,closeAfterEdit:false,reloadAfterSubmit:true,onInitializeForm:null,beforeInitData:null,beforeShowForm:null,afterShowForm:null,beforeSubmit:null,afterSubmit:null,onclickSubmit:null,afterComplete:null,onclickPgButtons:null,afterclickPgButtons:null,editData:{},recreateForm:false,jqModal:true,closeOnEscape:false,addedrow:"first",topinfo:"",bottominfo:"",saveicon:[],closeicon:[],savekey:[false,13],navkeys:[false,38,40],checkOnSubmit:false,checkOnUpdate:false,_savedData:{},processing:false,onClose:null,ajaxEditOptions:{},serializeEditData:null,viewPagerButtons:true},a.jgrid.edit,d||{});b[a(this)[0].p.id]=d;return this.each(function(){function H(){var b=a(e).jqGrid("getDataIDs"),c=a("#id_g","#"+h).val(),d=a.inArray(c,b);return[d,b]}function G(b,c){if(b===0){a("#pData","#"+h+"_2").addClass("ui-state-disabled")}else{a("#pData","#"+h+"_2").removeClass("ui-state-disabled")}if(b==c){a("#nData","#"+h+"_2").addClass("ui-state-disabled")}else{a("#nData","#"+h+"_2").removeClass("ui-state-disabled")}}function F(){if(c!=="_empty"&&typeof e.p.savedRow!=="undefined"&&e.p.savedRow.length>0&&a.isFunction(a.fn.jqGrid.restoreRow)){for(var b=0;b<e.p.savedRow.length;b++){if(e.p.savedRow[b].id==c){a(e).jqGrid("restoreRow",c);break}}}}function E(){var c=true;a("#FormError","#"+h).hide();if(b[e.p.id].checkOnUpdate){t={};u={};y();v=a.extend({},t,u);w=C(v,b[e.p.id]._savedData);if(w){a("#"+g).data("disabled",true);a(".confirm","#"+j.themodal).show();c=false}}return c}function D(){a.each(e.p.colModel,function(a,b){if(b.editoptions&&b.editoptions.NullIfEmpty===true){if(t.hasOwnProperty(b.name)&&t[b.name]==""){t[b.name]="null"}}})}function C(a,b){var c=false,d;for(d in a){if(a[d]!=b[d]){c=true;break}}return c}function B(){var c,k=[true,"",""],l={},m=e.p.prmNames,n,o,q,r;if(a.isFunction(b[e.p.id].beforeCheckValues)){var s=b[e.p.id].beforeCheckValues(t,a("#"+g),t[e.p.id+"_id"]=="_empty"?m.addoper:m.editoper);if(s&&typeof s==="object"){t=s}}for(q in t){if(t.hasOwnProperty(q)){k=a.jgrid.checkValues(t[q],q,e);if(k[0]===false){break}}}D();if(k[0]){if(a.isFunction(b[e.p.id].onclickSubmit)){l=b[e.p.id].onclickSubmit(b[e.p.id],t)||{}}if(a.isFunction(b[e.p.id].beforeSubmit)){k=b[e.p.id].beforeSubmit(t,a("#"+g))}}if(k[0]&&!b[e.p.id].processing){b[e.p.id].processing=true;a("#sData",a("div[aria-labelledby='ui-dialog-title-"+j.themodal+"']")).addClass("ui-state-active");o=m.oper;n=m.id;t[o]=a.trim(t[e.p.id+"_id"])=="_empty"?m.addoper:m.editoper;if(t[o]!=m.addoper){t[n]=t[e.p.id+"_id"]}else{if(t[n]===undefined){t[n]=t[e.p.id+"_id"]}}delete t[e.p.id+"_id"];t=a.extend(t,b[e.p.id].editData,l);if(e.p.treeGrid===true){if(t[o]==m.addoper){r=a(e).jqGrid("getGridParam","selrow");var v=e.p.treeGridModel=="adjacency"?e.p.treeReader.parent_id_field:"parent_id";t[v]=r}for(i in e.p.treeReader){var w=e.p.treeReader[i];if(t.hasOwnProperty(w)){if(t[o]==m.addoper&&i==="parent_id_field"){continue}delete t[w]}}}t[n]=a.jgrid.stripPref(e.p.idPrefix,t[n]);var x=a.extend({url:b[e.p.id].url?b[e.p.id].url:a(e).jqGrid("getGridParam","editurl"),type:b[e.p.id].mtype,data:a.isFunction(b[e.p.id].serializeEditData)?b[e.p.id].serializeEditData(t):t,complete:function(i,l){t[n]=e.p.idPrefix+t[n];if(l!="success"){k[0]=false;if(a.isFunction(b[e.p.id].errorTextFormat)){k[1]=b[e.p.id].errorTextFormat(i)}else{k[1]=l+" Status: '"+i.statusText+"'. Error code: "+i.status}}else{if(a.isFunction(b[e.p.id].afterSubmit)){k=b[e.p.id].afterSubmit(i,t)}}if(k[0]===false){a("#FormError>td","#"+h).html(k[1]);a("#FormError","#"+h).show()}else{a.each(e.p.colModel,function(a,b){if(u[this.name]&&this.formatter&&this.formatter=="select"){try{delete u[this.name]}catch(c){}}});t=a.extend(t,u);if(e.p.autoencode){a.each(t,function(b,c){t[b]=a.jgrid.htmlDecode(c)})}if(t[o]==m.addoper){if(!k[2]){k[2]=a.jgrid.randId()}t[n]=k[2];if(b[e.p.id].closeAfterAdd){if(b[e.p.id].reloadAfterSubmit){a(e).trigger("reloadGrid")}else{if(e.p.treeGrid===true){a(e).jqGrid("addChildNode",k[2],r,t)}else{a(e).jqGrid("addRowData",k[2],t,d.addedrow);a(e).jqGrid("setSelection",k[2])}}a.jgrid.hideModal("#"+j.themodal,{gb:"#gbox_"+f,jqm:d.jqModal,onClose:b[e.p.id].onClose})}else if(b[e.p.id].clearAfterAdd){if(b[e.p.id].reloadAfterSubmit){a(e).trigger("reloadGrid")}else{if(e.p.treeGrid===true){a(e).jqGrid("addChildNode",k[2],r,t)}else{a(e).jqGrid("addRowData",k[2],t,d.addedrow)}}A("_empty",e,g)}else{if(b[e.p.id].reloadAfterSubmit){a(e).trigger("reloadGrid")}else{if(e.p.treeGrid===true){a(e).jqGrid("addChildNode",k[2],r,t)}else{a(e).jqGrid("addRowData",k[2],t,d.addedrow)}}}}else{if(b[e.p.id].reloadAfterSubmit){a(e).trigger("reloadGrid");if(!b[e.p.id].closeAfterEdit){setTimeout(function(){a(e).jqGrid("setSelection",t[n])},1e3)}}else{if(e.p.treeGrid===true){a(e).jqGrid("setTreeRow",t[n],t)}else{a(e).jqGrid("setRowData",t[n],t)}}if(b[e.p.id].closeAfterEdit){a.jgrid.hideModal("#"+j.themodal,{gb:"#gbox_"+f,jqm:d.jqModal,onClose:b[e.p.id].onClose})}}if(a.isFunction(b[e.p.id].afterComplete)){c=i;setTimeout(function(){b[e.p.id].afterComplete(c,t,a("#"+g));c=null},500)}if(b[e.p.id].checkOnSubmit||b[e.p.id].checkOnUpdate){a("#"+g).data("disabled",false);if(b[e.p.id]._savedData[e.p.id+"_id"]!="_empty"){for(var q in b[e.p.id]._savedData){if(t[q]){b[e.p.id]._savedData[q]=t[q]}}}}}b[e.p.id].processing=false;a("#sData",a("div[aria-labelledby='ui-dialog-title-"+j.themodal+"']")).removeClass("ui-state-active");try{a(":input:visible","#"+g)[0].focus()}catch(s){}}},a.jgrid.ajaxOptions,b[e.p.id].ajaxEditOptions);if(!x.url&&!b[e.p.id].useDataProxy){if(a.isFunction(e.p.dataProxy)){b[e.p.id].useDataProxy=true}else{k[0]=false;k[1]+=" "+a.jgrid.errors.nourl}}if(k[0]){if(b[e.p.id].useDataProxy){var y=e.p.dataProxy.call(e,x,"set_"+e.p.id);if(typeof y=="undefined"){y=[true,""]}if(y[0]===false){k[0]=false;k[1]=y[1]||"Error deleting the selected row!"}else{if(x.data.oper==m.addoper&&b[e.p.id].closeAfterAdd){a.jgrid.hideModal("#"+j.themodal,{gb:"#gbox_"+f,jqm:d.jqModal,onClose:b[e.p.id].onClose})}if(x.data.oper==m.editoper&&b[e.p.id].closeAfterEdit){a.jgrid.hideModal("#"+j.themodal,{gb:"#gbox_"+f,jqm:d.jqModal,onClose:b[e.p.id].onClose})}}}else{a.ajax(x)}}}if(k[0]===false){a("#FormError>td","#"+h).html(k[1]);a("#FormError","#"+h).show()}}function A(c,d,f){var g,i=0,j,k,l,m,n;if(b[e.p.id].checkOnSubmit||b[e.p.id].checkOnUpdate){b[e.p.id]._savedData={};b[e.p.id]._savedData[d.p.id+"_id"]=c}var o=d.p.colModel;if(c=="_empty"){a(o).each(function(c){g=this.name;l=a.extend({},this.editoptions||{});k=a("#"+a.jgrid.jqID(g),"#"+f);if(k&&k.length&&k[0]!==null){m="";if(l.defaultValue){m=a.isFunction(l.defaultValue)?l.defaultValue():l.defaultValue;if(k[0].type=="checkbox"){n=m.toLowerCase();if(n.search(/(false|0|no|off|undefined)/i)<0&&n!==""){k[0].checked=true;k[0].defaultChecked=true;k[0].value=m}else{k[0].checked=false;k[0].defaultChecked=false}}else{k.val(m)}}else{if(k[0].type=="checkbox"){k[0].checked=false;k[0].defaultChecked=false;m=a(k).attr("offval")}else if(k[0].type&&k[0].type.substr(0,6)=="select"){k[0].selectedIndex=0}else{k.val(m)}}if(b[e.p.id].checkOnSubmit===true||b[e.p.id].checkOnUpdate){b[e.p.id]._savedData[g]=m}}});a("#id_g","#"+f).val(c);return}var p=a(d).jqGrid("getInd",c,true);if(!p){return}a("td",p).each(function(h){g=o[h].name;if(g!=="cb"&&g!=="subgrid"&&g!=="rn"&&o[h].editable===true){if(g==d.p.ExpandColumn&&d.p.treeGrid===true){j=a(this).text()}else{try{j=a.unformat(a(this),{rowId:c,colModel:o[h]},h)}catch(k){j=o[h].edittype=="textarea"?a(this).text():a(this).html()}}if(e.p.autoencode){j=a.jgrid.htmlDecode(j)}if(b[e.p.id].checkOnSubmit===true||b[e.p.id].checkOnUpdate){b[e.p.id]._savedData[g]=j}g=a.jgrid.jqID(g);switch(o[h].edittype){case"password":case"text":case"button":case"image":case"textarea":if(j==" "||j=="&#160;"||j.length==1&&j.charCodeAt(0)==160){j=""}a("#"+g,"#"+f).val(j);break;case"select":var l=j.split(",");l=a.map(l,function(b){return a.trim(b)});a("#"+g+" option","#"+f).each(function(b){if(!o[h].editoptions.multiple&&(a.trim(j)==a.trim(a(this).text())||l[0]==a.trim(a(this).text())||l[0]==a.trim(a(this).val()))){this.selected=true}else if(o[h].editoptions.multiple){if(a.inArray(a.trim(a(this).text()),l)>-1||a.inArray(a.trim(a(this).val()),l)>-1){this.selected=true}else{this.selected=false}}else{this.selected=false}});break;case"checkbox":j=j+"";if(o[h].editoptions&&o[h].editoptions.value){var m=o[h].editoptions.value.split(":");if(m[0]==j){a("#"+g,"#"+f)[e.p.useProp?"prop":"attr"]("checked",true);a("#"+g,"#"+f)[e.p.useProp?"prop":"attr"]("defaultChecked",true)}else{a("#"+g,"#"+f)[e.p.useProp?"prop":"attr"]("checked",false);a("#"+g,"#"+f)[e.p.useProp?"prop":"attr"]("defaultChecked",false)}}else{j=j.toLowerCase();if(j.search(/(false|0|no|off|undefined)/i)<0&&j!==""){a("#"+g,"#"+f)[e.p.useProp?"prop":"attr"]("checked",true);a("#"+g,"#"+f)[e.p.useProp?"prop":"attr"]("defaultChecked",true)}else{a("#"+g,"#"+f)[e.p.useProp?"prop":"attr"]("checked",false);a("#"+g,"#"+f)[e.p.useProp?"prop":"attr"]("defaultChecked",false)}}break;case"custom":try{if(o[h].editoptions&&a.isFunction(o[h].editoptions.custom_value)){o[h].editoptions.custom_value(a("#"+g,"#"+f),"set",j)}else{throw"e1"}}catch(n){if(n=="e1"){a.jgrid.info_dialog(jQuery.jgrid.errors.errcap,"function 'custom_value' "+a.jgrid.edit.msg.nodefined,jQuery.jgrid.edit.bClose)}else{a.jgrid.info_dialog(jQuery.jgrid.errors.errcap,n.message,jQuery.jgrid.edit.bClose)}}break}i++}});if(i>0){a("#id_g","#"+h).val(c)}}function z(c,d,f,g){var h,i,j,k=0,l,m,n,o=[],p=false,q="<td class='CaptionTD'>&#160;</td><td class='DataTD'>&#160;</td>",r="",s;for(s=1;s<=g;s++){r+=q}if(c!="_empty"){p=a(d).jqGrid("getInd",c)}a(d.p.colModel).each(function(q){h=this.name;if(this.editrules&&this.editrules.edithidden===true){i=false}else{i=this.hidden===true?true:false}m=i?"style='display:none'":"";if(h!=="cb"&&h!=="subgrid"&&this.editable===true&&h!=="rn"){if(p===false){l=""}else{if(h==d.p.ExpandColumn&&d.p.treeGrid===true){l=a("td:eq("+q+")",d.rows[p]).text()}else{try{l=a.unformat(a("td:eq("+q+")",d.rows[p]),{rowId:c,colModel:this},q)}catch(s){l=this.edittype&&this.edittype=="textarea"?a("td:eq("+q+")",d.rows[p]).text():a("td:eq("+q+")",d.rows[p]).html()}if(!l||l==" "||l=="&#160;"||l.length==1&&l.charCodeAt(0)==160){l=""}}}var t=a.extend({},this.editoptions||{},{id:h,name:h}),u=a.extend({},{elmprefix:"",elmsuffix:"",rowabove:false,rowcontent:""},this.formoptions||{}),v=parseInt(u.rowpos,10)||k+1,w=parseInt((parseInt(u.colpos,10)||1)*2,10);if(c=="_empty"&&t.defaultValue){l=a.isFunction(t.defaultValue)?t.defaultValue():t.defaultValue}if(!this.edittype){this.edittype="text"}if(e.p.autoencode){l=a.jgrid.htmlDecode(l)}n=a.jgrid.createEl(this.edittype,t,l,false,a.extend({},a.jgrid.ajaxOptions,d.p.ajaxSelectOptions||{}));if(l===""&&this.edittype=="checkbox"){l=a(n).attr("offval")}if(l===""&&this.edittype=="select"){l=a("option:eq(0)",n).text()}if(b[e.p.id].checkOnSubmit||b[e.p.id].checkOnUpdate){b[e.p.id]._savedData[h]=l}a(n).addClass("FormElement");if(this.edittype=="text"||this.edittype=="textarea"){a(n).addClass("ui-widget-content ui-corner-all")}j=a(f).find("tr[rowpos="+v+"]");if(u.rowabove){var x=a("<tr><td class='contentinfo' colspan='"+g*2+"'>"+u.rowcontent+"</td></tr>");a(f).append(x);x[0].rp=v}if(j.length===0){j=a("<tr "+m+" rowpos='"+v+"'></tr>").addClass("FormData").attr("id","tr_"+h);a(j).append(r);a(f).append(j);j[0].rp=v}a("td:eq("+(w-2)+")",j[0]).html(typeof u.label==="undefined"?d.p.colNames[q]:u.label);a("td:eq("+(w-1)+")",j[0]).append(u.elmprefix).append(n).append(u.elmsuffix);o[k]=q;k++}});if(k>0){var t=a("<tr class='FormData' style='display:none'><td class='CaptionTD'></td><td colspan='"+(g*2-1)+"' class='DataTD'><input class='FormElement' id='id_g' type='text' name='"+d.p.id+"_id' value='"+c+"'/></td></tr>");t[0].rp=k+999;a(f).append(t);if(b[e.p.id].checkOnSubmit||b[e.p.id].checkOnUpdate){b[e.p.id]._savedData[d.p.id+"_id"]=c}}return o}function y(){a("#"+h+" > tbody > tr > td > .FormElement").each(function(b){var c=a(".customelement",this);if(c.length){var d=c[0],f=a(d).attr("name");a.each(e.p.colModel,function(b,c){if(this.name===f&&this.editoptions&&a.isFunction(this.editoptions.custom_value)){try{t[f]=this.editoptions.custom_value(a("#"+a.jgrid.jqID(f),"#"+h),"get");if(t[f]===undefined){throw"e1"}}catch(d){if(d==="e1"){a.jgrid.info_dialog(jQuery.jgrid.errors.errcap,"function 'custom_value' "+a.jgrid.edit.msg.novalue,jQuery.jgrid.edit.bClose)}else{a.jgrid.info_dialog(jQuery.jgrid.errors.errcap,d.message,jQuery.jgrid.edit.bClose)}}return true}})}else{switch(a(this).get(0).type){case"checkbox":if(a(this).is(":checked")){t[this.name]=a(this).val()}else{var g=a(this).attr("offval");t[this.name]=g}break;case"select-one":t[this.name]=a("option:selected",this).val();u[this.name]=a("option:selected",this).text();break;case"select-multiple":t[this.name]=a(this).val();if(t[this.name]){t[this.name]=t[this.name].join(",")}else{t[this.name]=""}var i=[];a("option:selected",this).each(function(b,c){i[b]=a(c).text()});u[this.name]=i.join(",");break;case"password":case"text":case"textarea":case"button":t[this.name]=a(this).val();break}if(e.p.autoencode){t[this.name]=a.jgrid.htmlEncode(t[this.name])}}});return true}var e=this;if(!e.grid||!c){return}var f=e.p.id,g="FrmGrid_"+f,h="TblGrid_"+f,j={themodal:"editmod"+f,modalhead:"edithd"+f,modalcontent:"editcnt"+f,scrollelm:g},k=a.isFunction(b[e.p.id].beforeShowForm)?b[e.p.id].beforeShowForm:false,l=a.isFunction(b[e.p.id].afterShowForm)?b[e.p.id].afterShowForm:false,m=a.isFunction(b[e.p.id].beforeInitData)?b[e.p.id].beforeInitData:false,n=a.isFunction(b[e.p.id].onInitializeForm)?b[e.p.id].onInitializeForm:false,o=null,q=true,r=1,s=0,t,u,v,w;if(c==="new"){c="_empty";d.caption=b[e.p.id].addCaption}else{d.caption=b[e.p.id].editCaption}if(d.recreateForm===true&&a("#"+j.themodal).html()!==null){a("#"+j.themodal).remove()}var x=true;if(d.checkOnUpdate&&d.jqModal&&!d.modal){x=false}if(a("#"+j.themodal).html()!==null){if(m){q=m(a("#"+g));if(typeof q=="undefined"){q=true}}if(q===false){return}F();a(".ui-jqdialog-title","#"+j.modalhead).html(d.caption);a("#FormError","#"+h).hide();if(b[e.p.id].topinfo){a(".topinfo","#"+h).html(b[e.p.id].topinfo);a(".tinfo","#"+h).show()}else{a(".tinfo","#"+h).hide()}if(b[e.p.id].bottominfo){a(".bottominfo","#"+h+"_2").html(b[e.p.id].bottominfo);a(".binfo","#"+h+"_2").show()}else{a(".binfo","#"+h+"_2").hide()}A(c,e,g);if(c=="_empty"||!b[e.p.id].viewPagerButtons){a("#pData, #nData","#"+h+"_2").hide()}else{a("#pData, #nData","#"+h+"_2").show()}if(b[e.p.id].processing===true){b[e.p.id].processing=false;a("#sData",a("div[aria-labelledby='ui-dialog-title-"+j.themodal+"']")).removeClass("ui-state-active")}if(a("#"+g).data("disabled")===true){a(".confirm","#"+j.themodal).hide();a("#"+g).data("disabled",false)}if(k){k(a("#"+g))}a("#"+j.themodal).data("onClose",b[e.p.id].onClose);a("#"+j.themodal).data("title",d.caption);a.jgrid.viewModal("#"+j.themodal,{gbox:"#gbox_"+f,jqm:d.jqModal,jqM:false,overlay:d.overlay,modal:d.modal,width:d.width});if(!x){a(".jqmOverlay").click(function(){if(!E()){return false}a.jgrid.hideModal("#"+j.themodal,{gb:"#gbox_"+f,jqm:d.jqModal,onClose:b[e.p.id].onClose});return false})}if(l){l(a("#"+g))}}else{var I=isNaN(d.dataheight)?d.dataheight:d.dataheight+"px",J=a("<form name='FormPost' id='"+g+"' class='FormGrid' onSubmit='return false;' style='width:100%;overflow:auto;position:relative;height:"+I+";'></form>").data("disabled",false),K=a("<table id='"+h+"' class='EditTable' cellspacing='0' cellpadding='0' border='0'><tbody></tbody></table>");if(m){q=m(a("#"+g));if(typeof q=="undefined"){q=true}}if(q===false){return}F();a(e.p.colModel).each(function(a){var b=this.formoptions;r=Math.max(r,b?b.colpos||0:0);s=Math.max(s,b?b.rowpos||0:0)});a(J).append(K);var L=a("<tr id='FormError' style='display:none'><td class='ui-state-error' colspan='"+r*2+"'></td></tr>");L[0].rp=0;a(K).append(L);L=a("<tr style='display:none' class='tinfo'><td class='topinfo' colspan='"+r*2+"'>"+b[e.p.id].topinfo+"</td></tr>");L[0].rp=0;a(K).append(L);var M=e.p.direction=="rtl"?true:false,N=M?"nData":"pData",O=M?"pData":"nData";z(c,e,K,r);var P="<a href='javascript:void(0)' id='"+N+"' class='ui-button ui-state-default ui-corner-left'><span class='ui-icon ui-icon-triangle-1-w'></span></a>",Q="<a href='javascript:void(0)' id='"+O+"' class='ui-button ui-state-default ui-corner-right'><span class='ui-icon ui-icon-triangle-1-e'></span></a>",R="<a href='javascript:void(0)' id='sData' class='ui-button ui-state-default ui-corner-all'>"+d.bSubmit+"</a>",S="<a href='javascript:void(0)' id='cData' class='ui-button ui-state-default ui-corner-all'>"+d.bCancel+"</a>";var T="<table border='0' cellspacing='0' cellpadding='0' class='EditTable' id='"+h+"_2'><tbody><tr><td colspan='2'><hr class='ui-widget-content' style='margin:1px'/></td></tr><tr id='Act_Buttons'><td class='navButton'>"+(M?Q+P:P+Q)+"</td><td class='EditButton'>"+R+S+"</td></tr>";T+="<tr style='display:none' class='binfo'><td class='bottominfo' colspan='2'>"+b[e.p.id].bottominfo+"</td></tr>";T+="</tbody></table>";if(s>0){var U=[],V={};a.each(a(K)[0].rows,function(a,b){U[a]=b});U.sort(function(a,b){if(a.rp>b.rp){return 1}if(a.rp<b.rp){return-1}return 0});a.each(U,function(a,b){V.html+=b});a("tbody",K).append(V.html)}d.gbox="#gbox_"+f;var W=false;if(d.closeOnEscape===true){d.closeOnEscape=false;W=true}var X=a("<span></span>").append(J);a.jgrid.createModal(j,X,d,"#gview_"+e.p.id,a("#gbox_"+e.p.id)[0]);a("#"+j.themodal).data("title",d.caption);if(M){a("#pData, #nData","#"+h+"_2").css("float","right");a(".EditButton","#"+h+"_2").css("text-align","left")}if(b[e.p.id].topinfo){a(".tinfo","#"+h).show()}if(b[e.p.id].bottominfo){a(".binfo","#"+h+"_2").show()}X=null;T=null;a("#"+j.themodal).keydown(function(c){var f=c.target;if(a("#"+g).data("disabled")===true){return false}if(b[e.p.id].savekey[0]===true&&c.which==b[e.p.id].savekey[1]){if(f.tagName!="TEXTAREA"){a("#sData",a("div[aria-labelledby='ui-dialog-title-"+j.themodal+"']")).trigger("click");return false}}if(c.which===27){if(!E()){return false}if(W){a.jgrid.hideModal(this,{gb:d.gbox,jqm:d.jqModal,onClose:b[e.p.id].onClose})}return false}if(b[e.p.id].navkeys[0]===true){if(a("#id_g","#"+h).val()=="_empty"){return true}if(c.which==b[e.p.id].navkeys[1]){a("#pData","#"+h+"_2").trigger("click");return false}if(c.which==b[e.p.id].navkeys[2]){a("#nData","#"+h+"_2").trigger("click");return false}}});if(d.checkOnUpdate){a("a.ui-jqdialog-titlebar-close span","#"+j.themodal).removeClass("jqmClose");a("a.ui-jqdialog-titlebar-close","#"+j.themodal).unbind("click").click(function(){if(!E()){return false}a.jgrid.hideModal("#"+j.themodal,{gb:"#gbox_"+f,jqm:d.jqModal,onClose:b[e.p.id].onClose});return false})}d.saveicon=a.extend([true,"left","ui-icon-disk"],d.saveicon);d.closeicon=a.extend([true,"left","ui-icon-close"],d.closeicon);if(d.saveicon[0]===true){a("#sData",a("div[aria-labelledby='ui-dialog-title-"+j.themodal+"']")).addClass(d.saveicon[1]=="right"?"fm-button-icon-right":"fm-button-icon-left").append("<span class='ui-icon "+d.saveicon[2]+"'></span>")}if(d.closeicon[0]===true){a("#cData","#"+h+"_2").addClass(d.closeicon[1]=="right"?"fm-button-icon-right":"fm-button-icon-left").append("<span class='ui-icon "+d.closeicon[2]+"'></span>")}if(b[e.p.id].checkOnSubmit||b[e.p.id].checkOnUpdate){R="<a href='javascript:void(0)' id='sNew' class='ui-button ui-state-default ui-corner-all' style='z-index:1002'>"+d.bYes+"</a>";Q="<a href='javascript:void(0)' id='nNew' class='ui-button ui-state-default ui-corner-all' style='z-index:1002'>"+d.bNo+"</a>";S="<a href='javascript:void(0)' id='cNew' class='ui-button ui-state-default ui-corner-all' style='z-index:1002'>"+d.bExit+"</a>";var Y,Z=d.zIndex||999;Z++;if(a.browser.msie&&a.browser.version==6){Y='<iframe style="display:block;position:absolute;z-index:-1;filter:Alpha(Opacity=\'0\');" src="javascript:false;"></iframe>'}else{Y=""}a("<div class='ui-widget-overlay jqgrid-overlay confirm' style='z-index:"+Z+";display:none;'>&#160;"+Y+"</div><div class='confirm ui-widget-content ui-jqconfirm' style='z-index:"+(Z+1)+"'>"+d.saveData+"<br/><br/>"+R+Q+S+"</div>").insertAfter("#"+g);a("#sNew","#"+j.themodal).click(function(){B();a("#"+g).data("disabled",false);a(".confirm","#"+j.themodal).hide();return false});a("#nNew","#"+j.themodal).click(function(){a(".confirm","#"+j.themodal).hide();a("#"+g).data("disabled",false);setTimeout(function(){a(":input","#"+g)[0].focus()},0);return false});a("#cNew","#"+j.themodal).click(function(){a(".confirm","#"+j.themodal).hide();a("#"+g).data("disabled",false);a.jgrid.hideModal("#"+j.themodal,{gb:"#gbox_"+f,jqm:d.jqModal,onClose:b[e.p.id].onClose});return false})}if(n){n(a("#"+g))}if(c=="_empty"||!b[e.p.id].viewPagerButtons){a("#pData,#nData","#"+h+"_2").hide()}else{a("#pData,#nData","#"+h+"_2").show()}if(k){k(a("#"+g))}a("#"+j.themodal).data("onClose",b[e.p.id].onClose);a.jgrid.viewModal("#"+j.themodal,{gbox:"#gbox_"+f,jqm:d.jqModal,overlay:d.overlay,modal:d.modal,width:d.width});if(!x){a(".jqmOverlay").click(function(){if(!E()){return false}a.jgrid.hideModal("#"+j.themodal,{gb:"#gbox_"+f,jqm:d.jqModal,onClose:b[e.p.id].onClose});return false})}if(l){l(a("#"+g))}a(".fm-button","#"+j.themodal).hover(function(){a(this).addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover")});a("#sData",a("div[aria-labelledby='ui-dialog-title-"+j.themodal+"']")).click(function(c){t={};u={};a("#FormError","#"+h).hide();y();if(t[e.p.id+"_id"]=="_empty"){B()}else if(d.checkOnSubmit===true){v=a.extend({},t,u);w=C(v,b[e.p.id]._savedData);if(w){a("#"+g).data("disabled",true);a(".confirm","#"+j.themodal).show()}else{B()}}else{B()}return false});a("#cData","#"+h+"_2").click(function(c){if(!E()){return false}a.jgrid.hideModal("#"+j.themodal,{gb:"#gbox_"+f,jqm:d.jqModal,onClose:b[e.p.id].onClose});return false});a("#nData","#"+h+"_2").click(function(b){if(!E()){return false}a("#FormError","#"+h).hide();var c=H();c[0]=parseInt(c[0],10);if(c[0]!=-1&&c[1][c[0]+1]){if(a.isFunction(d.onclickPgButtons)){d.onclickPgButtons("next",a("#"+g),c[1][c[0]])}A(c[1][c[0]+1],e,g);a(e).jqGrid("setSelection",c[1][c[0]+1]);if(a.isFunction(d.afterclickPgButtons)){d.afterclickPgButtons("next",a("#"+g),c[1][c[0]+1])}G(c[0]+1,c[1].length-1)}return false});a("#pData","#"+h+"_2").click(function(b){if(!E()){return false}a("#FormError","#"+h).hide();var c=H();if(c[0]!=-1&&c[1][c[0]-1]){if(a.isFunction(d.onclickPgButtons)){d.onclickPgButtons("prev",a("#"+g),c[1][c[0]])}A(c[1][c[0]-1],e,g);a(e).jqGrid("setSelection",c[1][c[0]-1]);if(a.isFunction(d.afterclickPgButtons)){d.afterclickPgButtons("prev",a("#"+g),c[1][c[0]-1])}G(c[0]-1,c[1].length-1)}return false})}var _=H();G(_[0],_[1].length-1)})},viewGridRow:function(b,c){c=a.extend({top:0,left:0,width:0,height:"auto",dataheight:"auto",modal:false,overlay:30,drag:true,resize:true,jqModal:true,closeOnEscape:false,labelswidth:"30%",closeicon:[],navkeys:[false,38,40],onClose:null,beforeShowForm:null,beforeInitData:null,viewPagerButtons:true},a.jgrid.view,c||{});return this.each(function(){function r(){var b=a(d).jqGrid("getDataIDs"),c=a("#id_g","#"+g).val(),e=a.inArray(c,b);return[e,b]}function q(b,c){if(b===0){a("#pData","#"+g+"_2").addClass("ui-state-disabled")}else{a("#pData","#"+g+"_2").removeClass("ui-state-disabled")}if(b==c){a("#nData","#"+g+"_2").addClass("ui-state-disabled")}else{a("#nData","#"+g+"_2").removeClass("ui-state-disabled")}}function o(b,c){var d,e,f=0,h,i,j;j=a(c).jqGrid("getInd",b,true);if(!j){return}a("td",j).each(function(b){d=c.p.colModel[b].name;if(c.p.colModel[b].editrules&&c.p.colModel[b].editrules.edithidden===true){e=false}else{e=c.p.colModel[b].hidden===true?true:false}if(d!=="cb"&&d!=="subgrid"&&d!=="rn"){if(d==c.p.ExpandColumn&&c.p.treeGrid===true){h=a(this).text()}else{h=a(this).html()}i=a.extend({},c.p.colModel[b].editoptions||{});d=a.jgrid.jqID("v_"+d);a("#"+d+" span","#"+g).html(h);if(e){a("#"+d,"#"+g).parents("tr:first").hide()}f++}});if(f>0){a("#id_g","#"+g).val(b)}}function n(b,d,e,f){var g,h,i,j=0,k,l,m=[],n=false,o="<td class='CaptionTD form-view-label ui-widget-content' width='"+c.labelswidth+"'>&#160;</td><td class='DataTD form-view-data ui-helper-reset ui-widget-content'>&#160;</td>",q="",r="<td class='CaptionTD form-view-label ui-widget-content'>&#160;</td><td class='DataTD form-view-data ui-widget-content'>&#160;</td>",s=["integer","number","currency"],t=0,u=0,v,w,x;for(var y=1;y<=f;y++){q+=y==1?o:r}a(d.p.colModel).each(function(b){if(this.editrules&&this.editrules.edithidden===true){h=false}else{h=this.hidden===true?true:false}if(!h&&this.align==="right"){if(this.formatter&&a.inArray(this.formatter,s)!==-1){t=Math.max(t,parseInt(this.width,10))}else{u=Math.max(u,parseInt(this.width,10))}}});v=t!==0?t:u!==0?u:0;n=a(d).jqGrid("getInd",b);a(d.p.colModel).each(function(b){g=this.name;w=false;if(this.editrules&&this.editrules.edithidden===true){h=false}else{h=this.hidden===true?true:false}l=h?"style='display:none'":"";x=typeof this.viewable!="boolean"?true:this.viewable;if(g!=="cb"&&g!=="subgrid"&&g!=="rn"&&x){if(n===false){k=""}else{if(g==d.p.ExpandColumn&&d.p.treeGrid===true){k=a("td:eq("+b+")",d.rows[n]).text()}else{k=a("td:eq("+b+")",d.rows[n]).html()}}w=this.align==="right"&&v!==0?true:false;var c=a.extend({},this.editoptions||{},{id:g,name:g}),o=a.extend({},{rowabove:false,rowcontent:""},this.formoptions||{}),p=parseInt(o.rowpos,10)||j+1,r=parseInt((parseInt(o.colpos,10)||1)*2,10);if(o.rowabove){var s=a("<tr><td class='contentinfo' colspan='"+f*2+"'>"+o.rowcontent+"</td></tr>");a(e).append(s);s[0].rp=p}i=a(e).find("tr[rowpos="+p+"]");if(i.length===0){i=a("<tr "+l+" rowpos='"+p+"'></tr>").addClass("FormData").attr("id","trv_"+g);a(i).append(q);a(e).append(i);i[0].rp=p}a("td:eq("+(r-2)+")",i[0]).html("<b>"+(typeof o.label==="undefined"?d.p.colNames[b]:o.label)+"</b>");a("td:eq("+(r-1)+")",i[0]).append("<span>"+k+"</span>").attr("id","v_"+g);if(w){a("td:eq("+(r-1)+") span",i[0]).css({"text-align":"right",width:v+"px"})}m[j]=b;j++}});if(j>0){var z=a("<tr class='FormData' style='display:none'><td class='CaptionTD'></td><td colspan='"+(f*2-1)+"' class='DataTD'><input class='FormElement' id='id_g' type='text' name='id' value='"+b+"'/></td></tr>");z[0].rp=j+99;a(e).append(z)}return m}function m(){if(c.closeOnEscape===true||c.navkeys[0]===true){setTimeout(function(){a(".ui-jqdialog-titlebar-close","#"+h.modalhead).focus()},0)}}var d=this;if(!d.grid||!b){return}var e=d.p.id,f="ViewGrid_"+e,g="ViewTbl_"+e,h={themodal:"viewmod"+e,modalhead:"viewhd"+e,modalcontent:"viewcnt"+e,scrollelm:f},i=a.isFunction(c.beforeInitData)?c.beforeInitData:false,j=true,k=1,l=0;if(a("#"+h.themodal).html()!==null){if(i){j=i(a("#"+f));if(typeof j=="undefined"){j=true}}if(j===false){return}a(".ui-jqdialog-title","#"+h.modalhead).html(c.caption);a("#FormError","#"+g).hide();o(b,d);if(a.isFunction(c.beforeShowForm)){c.beforeShowForm(a("#"+f))}a.jgrid.viewModal("#"+h.themodal,{gbox:"#gbox_"+e,jqm:c.jqModal,jqM:false,overlay:c.overlay,modal:c.modal});m()}else{var s=isNaN(c.dataheight)?c.dataheight:c.dataheight+"px";var t=a("<form name='FormPost' id='"+f+"' class='FormGrid' style='width:100%;overflow:auto;position:relative;height:"+s+";'></form>"),u=a("<table id='"+g+"' class='EditTable' cellspacing='1' cellpadding='2' border='0' style='table-layout:fixed'><tbody></tbody></table>");if(i){j=i(a("#"+f));if(typeof j=="undefined"){j=true}}if(j===false){return}a(d.p.colModel).each(function(a){var b=this.formoptions;k=Math.max(k,b?b.colpos||0:0);l=Math.max(l,b?b.rowpos||0:0)});a(t).append(u);n(b,d,u,k);var v=d.p.direction=="rtl"?true:false,w=v?"nData":"pData",x=v?"pData":"nData",y="<a href='javascript:void(0)' id='"+w+"' class='fm-button ui-state-default ui-corner-left'><span class='ui-icon ui-icon-triangle-1-w'></span></a>",z="<a href='javascript:void(0)' id='"+x+"' class='fm-button ui-state-default ui-corner-right'><span class='ui-icon ui-icon-triangle-1-e'></span></a>",A="<a href='javascript:void(0)' id='cData' class='fm-button ui-state-default ui-corner-all'>"+c.bClose+"</a>";if(l>0){var B=[];a.each(a(u)[0].rows,function(a,b){B[a]=b});B.sort(function(a,b){if(a.rp>b.rp){return 1}if(a.rp<b.rp){return-1}return 0});a.each(B,function(b,c){a("tbody",u).append(c)})}c.gbox="#gbox_"+e;var C=false;if(c.closeOnEscape===true){c.closeOnEscape=false;C=true}var D=a("<span></span>").append(t).append("<table border='0' class='EditTable' id='"+g+"_2'><tbody><tr id='Act_Buttons'><td class='navButton' width='"+c.labelswidth+"'>"+(v?z+y:y+z)+"</td><td class='EditButton'>"+A+"</td></tr></tbody></table>");a.jgrid.createModal(h,D,c,"#gview_"+d.p.id,a("#gview_"+d.p.id)[0]);if(v){a("#pData, #nData","#"+g+"_2").css("float","right");a(".EditButton","#"+g+"_2").css("text-align","left")}if(!c.viewPagerButtons){a("#pData, #nData","#"+g+"_2").hide()}D=null;a("#"+h.themodal).keydown(function(b){if(b.which===27){if(C){a.jgrid.hideModal(this,{gb:c.gbox,jqm:c.jqModal,onClose:c.onClose})}return false}if(c.navkeys[0]===true){if(b.which===c.navkeys[1]){a("#pData","#"+g+"_2").trigger("click");return false}if(b.which===c.navkeys[2]){a("#nData","#"+g+"_2").trigger("click");return false}}});c.closeicon=a.extend([true,"left","ui-icon-close"],c.closeicon);if(c.closeicon[0]===true){a("#cData","#"+g+"_2").addClass(c.closeicon[1]=="right"?"fm-button-icon-right":"fm-button-icon-left").append("<span class='ui-icon "+c.closeicon[2]+"'></span>")}if(a.isFunction(c.beforeShowForm)){c.beforeShowForm(a("#"+f))}a.jgrid.viewModal("#"+h.themodal,{gbox:"#gbox_"+e,jqm:c.jqModal,modal:c.modal});a(".fm-button:not(.ui-state-disabled)","#"+g+"_2").hover(function(){a(this).addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover")});m();a("#cData","#"+g+"_2").click(function(b){a.jgrid.hideModal("#"+h.themodal,{gb:"#gbox_"+e,jqm:c.jqModal,onClose:c.onClose});return false});a("#nData","#"+g+"_2").click(function(b){a("#FormError","#"+g).hide();var e=r();e[0]=parseInt(e[0],10);if(e[0]!=-1&&e[1][e[0]+1]){if(a.isFunction(c.onclickPgButtons)){c.onclickPgButtons("next",a("#"+f),e[1][e[0]])}o(e[1][e[0]+1],d);a(d).jqGrid("setSelection",e[1][e[0]+1]);if(a.isFunction(c.afterclickPgButtons)){c.afterclickPgButtons("next",a("#"+f),e[1][e[0]+1])}q(e[0]+1,e[1].length-1)}m();return false});a("#pData","#"+g+"_2").click(function(b){a("#FormError","#"+g).hide();var e=r();if(e[0]!=-1&&e[1][e[0]-1]){if(a.isFunction(c.onclickPgButtons)){c.onclickPgButtons("prev",a("#"+f),e[1][e[0]])}o(e[1][e[0]-1],d);a(d).jqGrid("setSelection",e[1][e[0]-1]);if(a.isFunction(c.afterclickPgButtons)){c.afterclickPgButtons("prev",a("#"+f),e[1][e[0]-1])}q(e[0]-1,e[1].length-1)}m();return false})}var E=r();q(E[0],E[1].length-1)})},delGridRow:function(c,d){d=a.extend({top:0,left:0,width:240,height:"auto",dataheight:"auto",modal:false,overlay:30,drag:true,resize:true,url:"",mtype:"POST",reloadAfterSubmit:true,beforeShowForm:null,beforeInitData:null,afterShowForm:null,beforeSubmit:null,onclickSubmit:null,afterSubmit:null,jqModal:true,closeOnEscape:false,delData:{},delicon:[],cancelicon:[],onClose:null,ajaxDelOptions:{},processing:false,serializeDelData:null,useDataProxy:false},a.jgrid.del,d||{});b[a(this)[0].p.id]=d;return this.each(function(){var e=this;if(!e.grid){return}if(!c){return}var f=a.isFunction(b[e.p.id].beforeShowForm),g=a.isFunction(b[e.p.id].afterShowForm),h=a.isFunction(b[e.p.id].beforeInitData)?b[e.p.id].beforeInitData:false,i=e.p.id,j={},k=true,l="DelTbl_"+i,m,n,o,q,r={themodal:"delmod"+i,modalhead:"delhd"+i,modalcontent:"delcnt"+i,scrollelm:l};if(jQuery.isArray(c)){c=c.join()}if(a("#"+r.themodal).html()!==null){if(h){k=h(a("#"+l));if(typeof k=="undefined"){k=true}}if(k===false){return}a("#DelData>td","#"+l).text(c);a("#DelError","#"+l).hide();if(b[e.p.id].processing===true){b[e.p.id].processing=false;a("#dData","#"+l).removeClass("ui-state-active")}if(f){b[e.p.id].beforeShowForm(a("#"+l))}a("#"+r.themodal).data("title",d.caption);a.jgrid.viewModal("#"+r.themodal,{gbox:"#gbox_"+i,jqm:b[e.p.id].jqModal,jqM:false,overlay:b[e.p.id].overlay,modal:b[e.p.id].modal,width:d.width,rightButton:"Delete",rightButtonId:"dData",leftButton:"Cancel",leftButtonId:"eData"});if(g){b[e.p.id].afterShowForm(a("#"+l))}}else{var s=isNaN(b[e.p.id].dataheight)?b[e.p.id].dataheight:b[e.p.id].dataheight+"px";var t="<div id='"+l+"' class='formdata' style='width:100%;position:relative;height:"+s+";'>";t+="<table class='DelTable'><tbody>";t+="<tr id='DelError' style='display:none'><td class='ui-state-error'></td></tr>";t+="<tr id='DelData' style='display:none'><td >"+c+"</td></tr>";t+='<tr><td class="delmsg" style="white-space:pre;">'+b[e.p.id].msg+"</td></tr>";t+="</tbody></table></div>";d.gbox="#gbox_"+i;a.jgrid.createModal(r,t,d,"#gview_"+e.p.id,a("#gview_"+e.p.id)[0]);if(h){k=h(a("#"+l));if(typeof k=="undefined"){k=true}}if(k===false){return}a(".fm-button","#"+l+"_2").hover(function(){a(this).addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover")});if(f){b[e.p.id].beforeShowForm(a("#"+l))}a("#"+r.themodal).data("title",d.caption);a.jgrid.viewModal("#"+r.themodal,{gbox:"#gbox_"+i,jqm:b[e.p.id].jqModal,overlay:b[e.p.id].overlay,modal:b[e.p.id].modal,width:d.width,rightButton:"Delete",rightButtonId:"dData",leftButton:"Cancel",leftButtonId:"eData"});a("#dData",a("div[aria-labelledby='ui-dialog-title-"+r.themodal+"']")).click(function(c){var f=[true,""];j={};var g=a("#DelData>td","#"+l).text();if(a.isFunction(b[e.p.id].onclickSubmit)){j=b[e.p.id].onclickSubmit(b[e.p.id],g)||{}}if(a.isFunction(b[e.p.id].beforeSubmit)){f=b[e.p.id].beforeSubmit(g)}if(f[0]&&!b[e.p.id].processing){b[e.p.id].processing=true;a(this).addClass("ui-state-active");o=e.p.prmNames;m=a.extend({},b[e.p.id].delData,j);q=o.oper;m[q]=o.deloper;n=o.id;g=g.split(",");for(var h in g){if(g.hasOwnProperty(h)){g[h]=a.jgrid.stripPref(e.p.idPrefix,g[h])}}m[n]=g.join();var k=a.extend({url:b[e.p.id].url?b[e.p.id].url:a(e).jqGrid("getGridParam","editurl"),type:b[e.p.id].mtype,data:a.isFunction(b[e.p.id].serializeDelData)?b[e.p.id].serializeDelData(m):m,complete:function(c,h){if(h!="success"){f[0]=false;if(a.isFunction(b[e.p.id].errorTextFormat)){f[1]=b[e.p.id].errorTextFormat(c)}else{f[1]=h+" Status: '"+c.statusText+"'. Error code: "+c.status}}else{if(a.isFunction(b[e.p.id].afterSubmit)){f=b[e.p.id].afterSubmit(c,m)}}if(f[0]===false){a("#DelError>td","#"+l).html(f[1]);a("#DelError","#"+l).show()}else{if(b[e.p.id].reloadAfterSubmit&&e.p.datatype!="local"){a(e).trigger("reloadGrid")}else{var j=[];j=g.split(",");if(e.p.treeGrid===true){try{a(e).jqGrid("delTreeNode",e.p.idPrefix+j[0])}catch(k){}}else{for(var n=0;n<j.length;n++){a(e).jqGrid("delRowData",e.p.idPrefix+j[n])}}e.p.selrow=null;e.p.selarrrow=[]}if(a.isFunction(b[e.p.id].afterComplete)){setTimeout(function(){b[e.p.id].afterComplete(c,g)},500)}}b[e.p.id].processing=false;a("#dData","#"+l+"_2").removeClass("ui-state-active");if(f[0]){a.jgrid.hideModal("#"+r.themodal,{gb:"#gbox_"+i,jqm:d.jqModal,onClose:b[e.p.id].onClose})}}},a.jgrid.ajaxOptions,b[e.p.id].ajaxDelOptions);if(!k.url&&!b[e.p.id].useDataProxy){if(a.isFunction(e.p.dataProxy)){b[e.p.id].useDataProxy=true}else{f[0]=false;f[1]+=" "+a.jgrid.errors.nourl}}if(f[0]){if(b[e.p.id].useDataProxy){var s=e.p.dataProxy.call(e,k,"del_"+e.p.id);if(typeof s=="undefined"){s=[true,""]}if(s[0]===false){f[0]=false;f[1]=s[1]||"Error deleting the selected row!"}else{a.jgrid.hideModal("#"+r.themodal,{gb:"#gbox_"+i,jqm:d.jqModal,onClose:b[e.p.id].onClose})}}else{a.ajax(k)}}}if(f[0]===false){a("#DelError>td","#"+l).html(f[1]);a("#DelError","#"+l).show()}return false});a("#eData",a("div[aria-labelledby='ui-dialog-title-"+r.themodal+"']")).click(function(c){a.jgrid.hideModal("#"+r.themodal,{gb:"#gbox_"+i,jqm:b[e.p.id].jqModal,onClose:b[e.p.id].onClose});return false});if(g){b[e.p.id].afterShowForm(a("#"+l))}}if(b[e.p.id].closeOnEscape===true){setTimeout(function(){a(".ui-jqdialog-titlebar-close","#"+r.modalhead).focus()},0)}})},navGrid:function(b,c,d,e,f,g,h){c=a.extend({edit:true,editicon:"ui-icon-pencil",add:true,addicon:"ui-icon-plus",del:true,delicon:"ui-icon-trash",search:true,searchicon:"ui-icon-search",refresh:true,refreshicon:"ui-icon-refresh",refreshstate:"firstpage",view:false,viewicon:"ui-icon-document",position:"left",closeOnEscape:true,beforeRefresh:null,afterRefresh:null,cloneToTop:false,alertwidth:200,alertheight:"auto",alerttop:null,alertleft:null,alertzIndex:null},a.jgrid.nav,c||{});return this.each(function(){if(this.nav){return}var i={themodal:"alertmod",modalhead:"alerthd",modalcontent:"alertcnt"},j=this,k,l;if(!j.grid||typeof b!="string"){return}if(a("#"+i.themodal).html()===null){if(!c.alerttop&&!c.alertleft){if(typeof window.innerWidth!="undefined"){c.alertleft=window.innerWidth;c.alerttop=window.innerHeight}else if(typeof document.documentElement!="undefined"&&typeof document.documentElement.clientWidth!="undefined"&&document.documentElement.clientWidth!==0){c.alertleft=document.documentElement.clientWidth;c.alerttop=document.documentElement.clientHeight}else{c.alertleft=1024;c.alerttop=768}c.alertleft=c.alertleft/2-parseInt(c.alertwidth,10)/2;c.alerttop=c.alerttop/2-25}a.jgrid.createModal(i,"<div>"+c.alerttext+"</div><span tabindex='0'><span tabindex='-1' id='jqg_alrt'></span></span>",{gbox:"#gbox_"+j.p.id,jqModal:true,drag:true,resize:true,caption:c.alertcap,top:c.alerttop,left:c.alertleft,width:c.alertwidth,height:c.alertheight,closeOnEscape:c.closeOnEscape,zIndex:c.alertzIndex},"","",true)}var m=1;if(c.cloneToTop&&j.p.toppager){m=2}for(var n=0;n<m;n++){var p,q=a("<table cellspacing='0' cellpadding='0' border='0' class='ui-pg-table navtable' style='float:left;table-layout:auto;'><tbody><tr></tr></tbody></table>"),r="<td class='ui-pg-button ui-state-disabled' style='width:4px;'><span class='ui-separator'></span></td>",s,t;if(n===0){s=b;t=j.p.id;if(s==j.p.toppager){t+="_top";m=1}}else{s=j.p.toppager;t=j.p.id+"_top"}if(j.p.direction=="rtl"){a(q).attr("dir","rtl").css("float","right")}if(c.add){e=e||{};p=a("<td class='ui-pg-button ui-corner-all'></td>");a(p).append("<div class='ui-pg-div'><span class='ui-icon "+c.addicon+"'></span>"+c.addtext+"</div>");a("tr",q).append(p);a(p,q).attr({title:c.addtitle||"",id:e.id||"add_"+t}).click(function(){if(!a(this).hasClass("ui-state-disabled")){if(a.isFunction(c.addfunc)){c.addfunc()}else{a(j).jqGrid("editGridRow","new",e)}}return false}).hover(function(){if(!a(this).hasClass("ui-state-disabled")){a(this).addClass("ui-state-hover")}},function(){a(this).removeClass("ui-state-hover")});p=null}if(c.edit){p=a("<td class='ui-pg-button ui-corner-all'></td>");d=d||{};a(p).append("<div class='ui-pg-div'><span class='ui-icon "+c.editicon+"'></span>"+c.edittext+"</div>");a("tr",q).append(p);a(p,q).attr({title:c.edittitle||"",id:d.id||"edit_"+t}).click(function(){if(!a(this).hasClass("ui-state-disabled")){var b=j.p.selrow;if(b){if(a.isFunction(c.editfunc)){c.editfunc(b)}else{a(j).jqGrid("editGridRow",b,d)}}else{a.jgrid.viewModal("#"+i.themodal,{gbox:"#gbox_"+j.p.id,jqm:true});a("#jqg_alrt").focus()}}return false}).hover(function(){if(!a(this).hasClass("ui-state-disabled")){a(this).addClass("ui-state-hover")}},function(){a(this).removeClass("ui-state-hover")});p=null}if(c.view){p=a("<td class='ui-pg-button ui-corner-all'></td>");h=h||{};a(p).append("<div class='ui-pg-div'><span class='ui-icon "+c.viewicon+"'></span>"+c.viewtext+"</div>");a("tr",q).append(p);a(p,q).attr({title:c.viewtitle||"",id:h.id||"view_"+t}).click(function(){if(!a(this).hasClass("ui-state-disabled")){var b=j.p.selrow;if(b){if(a.isFunction(c.viewfunc)){c.viewfunc(b)}else{a(j).jqGrid("viewGridRow",b,h)}}else{a.jgrid.viewModal("#"+i.themodal,{gbox:"#gbox_"+j.p.id,jqm:true});a("#jqg_alrt").focus()}}return false}).hover(function(){if(!a(this).hasClass("ui-state-disabled")){a(this).addClass("ui-state-hover")}},function(){a(this).removeClass("ui-state-hover")});p=null}if(c.del){p=a("<td class='ui-pg-button ui-corner-all'></td>");f=f||{};a(p).append("<div class='ui-pg-div'><span class='ui-icon "+c.delicon+"'></span>"+c.deltext+"</div>");a("tr",q).append(p);a(p,q).attr({title:c.deltitle||"",id:f.id||"del_"+t}).click(function(){if(!a(this).hasClass("ui-state-disabled")){var b;if(j.p.multiselect){b=j.p.selarrrow;if(b.length===0){b=null}}else{b=j.p.selrow}if(b){if("function"==typeof c.delfunc){c.delfunc(b)}else{a(j).jqGrid("delGridRow",b,f)}}else{a.jgrid.viewModal("#"+i.themodal,{gbox:"#gbox_"+j.p.id,jqm:true});a("#jqg_alrt").focus()}}return false}).hover(function(){if(!a(this).hasClass("ui-state-disabled")){a(this).addClass("ui-state-hover")}},function(){a(this).removeClass("ui-state-hover")});p=null}if(c.add||c.edit||c.del||c.view){a("tr",q).append(r)}if(c.search){p=a("<td class='ui-pg-button ui-corner-all'></td>");g=g||{};a(p).append("<div class='ui-pg-div'><span class='ui-icon "+c.searchicon+"'></span>"+c.searchtext+"</div>");a("tr",q).append(p);a(p,q).attr({title:c.searchtitle||"",id:g.id||"search_"+t}).click(function(){if(!a(this).hasClass("ui-state-disabled")){a(j).jqGrid("searchGrid",g)}return false}).hover(function(){if(!a(this).hasClass("ui-state-disabled")){a(this).addClass("ui-state-hover")}},function(){a(this).removeClass("ui-state-hover")});if(g.showOnLoad&&g.showOnLoad===true)a(p,q).click();p=null}if(c.refresh){p=a("<td class='ui-pg-button ui-corner-all'></td>");a(p).append("<div class='ui-pg-div'><span class='ui-icon "+c.refreshicon+"'></span>"+c.refreshtext+"</div>");a("tr",q).append(p);a(p,q).attr({title:c.refreshtitle||"",id:"refresh_"+t}).click(function(){if(!a(this).hasClass("ui-state-disabled")){if(a.isFunction(c.beforeRefresh)){c.beforeRefresh()}j.p.search=false;try{var b=j.p.id;j.p.postData.filters="";a("#fbox_"+b).jqFilter("resetFilter");if(a.isFunction(j.clearToolbar)){j.clearToolbar(false)}}catch(d){}switch(c.refreshstate){case"firstpage":a(j).trigger("reloadGrid",[{page:1}]);break;case"current":a(j).trigger("reloadGrid",[{current:true}]);break}if(a.isFunction(c.afterRefresh)){c.afterRefresh()}}return false}).hover(function(){if(!a(this).hasClass("ui-state-disabled")){a(this).addClass("ui-state-hover")}},function(){a(this).removeClass("ui-state-hover")});p=null}l=a(".ui-jqgrid").css("font-size")||"11px";a("body").append("<div id='testpg2' class='ui-jqgrid ui-widget ui-widget-content' style='font-size:"+l+";visibility:hidden;' ></div>");k=a(q).clone().appendTo("#testpg2").width();a("#testpg2").remove();a(s+"_"+c.position,s).append(q);if(j.p._nvtd){if(k>j.p._nvtd[0]){a(s+"_"+c.position,s).width(k);j.p._nvtd[0]=k}j.p._nvtd[1]=k}l=null;k=null;q=null;this.nav=true}})},navButtonAdd:function(b,c){c=a.extend({caption:"newButton",title:"",buttonicon:"ui-icon-newwin",onClickButton:null,position:"last",cursor:"pointer"},c||{});return this.each(function(){if(!this.grid){return}if(b.indexOf("#")!==0){b="#"+b}var d=a(".navtable",b)[0],e=this;if(d){if(c.id&&a("#"+c.id,d).html()!==null){return}var f=a("<td></td>");if(c.buttonicon.toString().toUpperCase()=="NONE"){a(f).addClass("ui-pg-button ui-corner-all").append("<div class='ui-pg-div'>"+c.caption+"</div>")}else{a(f).addClass("ui-pg-button ui-corner-all").append("<div class='ui-pg-div'><span class='ui-icon "+c.buttonicon+"'></span>"+c.caption+"</div>")}if(c.id){a(f).attr("id",c.id)}if(c.position=="first"){if(d.rows[0].cells.length===0){a("tr",d).append(f)}else{a("tr td:eq(0)",d).before(f)}}else{a("tr",d).append(f)}a(f,d).attr("title",c.title||"").click(function(b){if(!a(this).hasClass("ui-state-disabled")){if(a.isFunction(c.onClickButton)){c.onClickButton.call(e,b)}}return false}).hover(function(){if(!a(this).hasClass("ui-state-disabled")){a(this).addClass("ui-state-hover")}},function(){a(this).removeClass("ui-state-hover")})}})},navSeparatorAdd:function(b,c){c=a.extend({sepclass:"ui-separator",sepcontent:""},c||{});return this.each(function(){if(!this.grid){return}if(b.indexOf("#")!==0){b="#"+b}var d=a(".navtable",b)[0];if(d){var e="<td class='ui-pg-button ui-state-disabled' style='width:4px;'><span class='"+c.sepclass+"'></span>"+c.sepcontent+"</td>";a("tr",d).append(e)}})},GridToForm:function(b,c){return this.each(function(){var d=this;if(!d.grid){return}var e=a(d).jqGrid("getRowData",b);if(e){for(var f in e){if(a("[name="+a.jgrid.jqID(f)+"]",c).is("input:radio")||a("[name="+a.jgrid.jqID(f)+"]",c).is("input:checkbox")){a("[name="+a.jgrid.jqID(f)+"]",c).each(function(){if(a(this).val()==e[f]){a(this)[d.p.useProp?"prop":"attr"]("checked",true)}else{a(this)[d.p.useProp?"prop":"attr"]("checked",false)}})}else{a("[name="+a.jgrid.jqID(f)+"]",c).val(e[f])}}}})},FormToGrid:function(b,c,d,e){return this.each(function(){var f=this;if(!f.grid){return}if(!d){d="set"}if(!e){e="first"}var g=a(c).serializeArray();var h={};a.each(g,function(a,b){h[b.name]=b.value});if(d=="add"){a(f).jqGrid("addRowData",b,h,e)}else if(d=="set"){a(f).jqGrid("setRowData",b,h)}})},SearchValue:function(b,c){return this.each(function(){var d=this;var e={searchField:b,searchString:c,searchOper:"eq",filters:""};d.p.search=true;a.extend(d.p.postData,e);a(d).trigger("reloadGrid",[{page:1}])})}})})(jQuery);(function(a){a.jgrid.extend({editRow:function(b,c,d,e,f,g,h,i,j){var k={keys:c||false,oneditfunc:d||null,successfunc:e||null,url:f||null,extraparam:g||{},aftersavefunc:h||null,errorfunc:i||null,afterrestorefunc:j||null,restoreAfterError:true,mtype:"POST"},l=a.makeArray(arguments).slice(1),m;if(l[0]&&typeof l[0]=="object"&&!a.isFunction(l[0])){m=a.extend(k,l[0])}else{m=k}return this.each(function(){var c=this,d,e,f,g=0,h=null,i={},k,l;if(!c.grid){return}k=a(c).jqGrid("getInd",b,true);if(k===false){return}f=a(k).attr("editable")||"0";if(f=="0"&&!a(k).hasClass("not-editable-row")){l=c.p.colModel;a("td",k).each(function(f){d=l[f].name;var j=c.p.treeGrid===true&&d==c.p.ExpandColumn;if(j){e=a("span:first",this).html()}else{try{e=a.unformat(this,{rowId:b,colModel:l[f]},f)}catch(k){e=l[f].edittype&&l[f].edittype=="textarea"?a(this).text():a(this).html()}}if(d!="cb"&&d!="subgrid"&&d!="rn"){if(c.p.autoencode){e=a.jgrid.htmlDecode(e)}i[d]=e;if(l[f].editable===true){if(h===null){h=f}if(j){a("span:first",this).html("")}else{a(this).html("")}var m=a.extend({},l[f].editoptions||{},{id:b+"_"+d,name:d});if(!l[f].edittype){l[f].edittype="text"}if(e==" "||e=="&#160;"||e.length==1&&e.charCodeAt(0)==160){e=""}var n=a.jgrid.createEl(l[f].edittype,m,e,true,a.extend({},a.jgrid.ajaxOptions,c.p.ajaxSelectOptions||{}));a(n).addClass("editable");if(j){a("span:first",this).append(n)}else{a(this).append(n)}if(l[f].edittype=="select"&&typeof l[f].editoptions!=="undefined"&&l[f].editoptions.multiple===true&&typeof l[f].editoptions.dataUrl==="undefined"&&a.browser.msie){a(n).width(a(n).width())}g++}}});if(g>0){i.id=b;c.p.savedRow.push(i);a(k).attr("editable","1");a("td:eq("+h+") input",k).focus();if(m.keys===true){a(k).bind("keydown",function(d){if(d.keyCode===27){a(c).jqGrid("restoreRow",b,j)}if(d.keyCode===13){var e=d.target;if(e.tagName=="TEXTAREA"){return true}a(c).jqGrid("saveRow",b,m);return false}d.stopPropagation()})}if(a.isFunction(m.oneditfunc)){m.oneditfunc.call(c,b)}}}})},saveRow:function(b,c,d,e,f,g,h){var i={successfunc:c||null,url:d||null,extraparam:e||{},aftersavefunc:f||null,errorfunc:g||null,afterrestorefunc:h||null,restoreAfterError:true,mtype:"POST"},j=a.makeArray(arguments).slice(1),k;if(j[0]&&typeof j[0]=="object"&&!a.isFunction(j[0])){k=a.extend(i,j[0])}else{k=i}var l=false;var m=this[0],n,o={},p={},q={},r,s,t,u;if(!m.grid){return l}u=a(m).jqGrid("getInd",b,true);if(u===false){return l}r=a(u).attr("editable");k.url=k.url?k.url:m.p.editurl;if(r==="1"){var v;a("td",u).each(function(b){v=m.p.colModel[b];n=v.name;if(n!="cb"&&n!="subgrid"&&v.editable===true&&n!="rn"&&!a(this).hasClass("not-editable-cell")){switch(v.edittype){case"checkbox":var c=["Yes","No"];if(v.editoptions){c=v.editoptions.value.split(":")}o[n]=a("input",this).is(":checked")?c[0]:c[1];break;case"text":case"password":case"textarea":case"button":o[n]=a("input, textarea",this).val();break;case"select":if(!v.editoptions.multiple){o[n]=a("select option:selected",this).val();p[n]=a("select option:selected",this).text()}else{var d=a("select",this),e=[];o[n]=a(d).val();if(o[n]){o[n]=o[n].join(",")}else{o[n]=""}a("select option:selected",this).each(function(b,c){e[b]=a(c).text()});p[n]=e.join(",")}if(v.formatter&&v.formatter=="select"){p={}}break;case"custom":try{if(v.editoptions&&a.isFunction(v.editoptions.custom_value)){o[n]=v.editoptions.custom_value.call(m,a(".customelement",this),"get");if(o[n]===undefined){throw"e2"}}else{throw"e1"}}catch(f){if(f=="e1"){a.jgrid.info_dialog(jQuery.jgrid.errors.errcap,"function 'custom_value' "+a.jgrid.edit.msg.nodefined,jQuery.jgrid.edit.bClose)}if(f=="e2"){a.jgrid.info_dialog(jQuery.jgrid.errors.errcap,"function 'custom_value' "+a.jgrid.edit.msg.novalue,jQuery.jgrid.edit.bClose)}else{a.jgrid.info_dialog(jQuery.jgrid.errors.errcap,f.message,jQuery.jgrid.edit.bClose)}}break}t=a.jgrid.checkValues(o[n],b,m);if(t[0]===false){t[1]=o[n]+" "+t[1];return false}if(m.p.autoencode){o[n]=a.jgrid.htmlEncode(o[n])}if(k.url!=="clientArray"&&v.editoptions&&v.editoptions.NullIfEmpty===true){if(o[n]==""){q[n]="null"}}}});if(t[0]===false){try{var w=a.jgrid.findPos(a("#"+a.jgrid.jqID(b),m.grid.bDiv)[0]);a.jgrid.info_dialog(a.jgrid.errors.errcap,t[1],a.jgrid.edit.bClose,{left:w[0],top:w[1]})}catch(x){alert(t[1])}return l}var y,z,A;z=m.p.prmNames;A=z.oper;y=z.id;if(o){o[A]=z.editoper;o[y]=b;if(typeof m.p.inlineData=="undefined"){m.p.inlineData={}}o=a.extend({},o,m.p.inlineData,k.extraparam)}if(k.url=="clientArray"){o=a.extend({},o,p);if(m.p.autoencode){a.each(o,function(b,c){o[b]=a.jgrid.htmlDecode(c)})}var B=a(m).jqGrid("setRowData",b,o);a(u).attr("editable","0");for(var C=0;C<m.p.savedRow.length;C++){if(m.p.savedRow[C].id==b){s=C;break}}if(s>=0){m.p.savedRow.splice(s,1)}if(a.isFunction(k.aftersavefunc)){k.aftersavefunc.call(m,b,B)}l=true;a(u).unbind("keydown")}else{a("#lui_"+m.p.id).show();q=a.extend({},o,q);q[y]=a.jgrid.stripPref(m.p.idPrefix,q[y]);a.ajax(a.extend({url:k.url,data:a.isFunction(m.p.serializeRowData)?m.p.serializeRowData.call(m,q):q,type:k.mtype,async:false,complete:function(c,d){a("#lui_"+m.p.id).hide();if(d==="success"){var e;if(a.isFunction(k.successfunc)){e=k.successfunc.call(m,c)}else{e=true}if(e===true){if(m.p.autoencode){a.each(o,function(b,c){o[b]=a.jgrid.htmlDecode(c)})}o=a.extend({},o,p);a(m).jqGrid("setRowData",b,o);a(u).attr("editable","0");for(var f=0;f<m.p.savedRow.length;f++){if(m.p.savedRow[f].id==b){s=f;break}}if(s>=0){m.p.savedRow.splice(s,1)}if(a.isFunction(k.aftersavefunc)){k.aftersavefunc.call(m,b,c)}l=true;a(u).unbind("keydown")}else{if(a.isFunction(k.errorfunc)){k.errorfunc.call(m,b,c,d)}if(k.restoreAfterError===true){a(m).jqGrid("restoreRow",b,k.afterrestorefunc)}}}},error:function(c,d){a("#lui_"+m.p.id).hide();if(a.isFunction(k.errorfunc)){k.errorfunc.call(m,b,c,d)}else{try{jQuery.jgrid.info_dialog(jQuery.jgrid.errors.errcap,'<div class="ui-state-error">'+c.responseText+"</div>",jQuery.jgrid.edit.bClose,{buttonalign:"right"})}catch(e){alert(c.responseText)}}if(k.restoreAfterError===true){a(m).jqGrid("restoreRow",b,k.afterrestorefunc)}}},a.jgrid.ajaxOptions,m.p.ajaxRowOptions||{}))}}return l},restoreRow:function(b,c){return this.each(function(){var d=this,e,f,g={};if(!d.grid){return}f=a(d).jqGrid("getInd",b,true);if(f===false){return}for(var h=0;h<d.p.savedRow.length;h++){if(d.p.savedRow[h].id==b){e=h;break}}if(e>=0){if(a.isFunction(a.fn.datepicker)){try{a("input.hasDatepicker","#"+a.jgrid.jqID(f.id)).datepicker("hide")}catch(i){}}a.each(d.p.colModel,function(b,c){if(this.editable===true&&this.name in d.p.savedRow[e]&&!a(this).hasClass("not-editable-cell")){g[this.name]=d.p.savedRow[e][this.name]}});a(d).jqGrid("setRowData",b,g);a(f).attr("editable","0").unbind("keydown");d.p.savedRow.splice(e,1)}if(a.isFunction(c)){c.call(d,b)}})}})})(jQuery);(function(a){a.jgrid.extend({editCell:function(b,c,d){return this.each(function(){var e=this,f,g,h,i;if(!e.grid||e.p.cellEdit!==true){return}c=parseInt(c,10);e.p.selrow=e.rows[b].id;if(!e.p.knv){a(e).jqGrid("GridNav")}if(e.p.savedRow.length>0){if(d===true){if(b==e.p.iRow&&c==e.p.iCol){return}}a(e).jqGrid("saveCell",e.p.savedRow[0].id,e.p.savedRow[0].ic)}else{window.setTimeout(function(){a("#"+e.p.knv).attr("tabindex","-1").focus()},0)}i=e.p.colModel[c];f=i.name;if(f=="subgrid"||f=="cb"||f=="rn"){return}h=a("td:eq("+c+")",e.rows[b]);if(i.editable===true&&d===true&&!h.hasClass("not-editable-cell")){if(parseInt(e.p.iCol,10)>=0&&parseInt(e.p.iRow,10)>=0){a("td:eq("+e.p.iCol+")",e.rows[e.p.iRow]).removeClass("edit-cell ui-state-highlight");a(e.rows[e.p.iRow]).removeClass("selected-row ui-state-hover")}a(h).addClass("edit-cell ui-state-highlight");a(e.rows[b]).addClass("selected-row ui-state-hover");try{g=a.unformat(h,{rowId:e.rows[b].id,colModel:i},c)}catch(j){g=i.edittype&&i.edittype=="textarea"?a(h).text():a(h).html()}if(e.p.autoencode){g=a.jgrid.htmlDecode(g)}if(!i.edittype){i.edittype="text"}e.p.savedRow.push({id:b,ic:c,name:f,v:g});if(g==" "||g=="&#160;"||g.length==1&&g.charCodeAt(0)==160){g=""}if(a.isFunction(e.p.formatCell)){var k=e.p.formatCell.call(e,e.rows[b].id,f,g,b,c);if(k!==undefined){g=k}}var l=a.extend({},i.editoptions||{},{id:b+"_"+f,name:f});var m=a.jgrid.createEl(i.edittype,l,g,true,a.extend({},a.jgrid.ajaxOptions,e.p.ajaxSelectOptions||{}));if(a.isFunction(e.p.beforeEditCell)){e.p.beforeEditCell.call(e,e.rows[b].id,f,g,b,c)}a(h).html("").append(m).attr("tabindex","0");window.setTimeout(function(){a(m).focus()},0);a("input, select, textarea",h).bind("keydown",function(d){if(d.keyCode===27){if(a("input.hasDatepicker",h).length>0){if(a(".ui-datepicker").is(":hidden")){a(e).jqGrid("restoreCell",b,c)}else{a("input.hasDatepicker",h).datepicker("hide")}}else{a(e).jqGrid("restoreCell",b,c)}}if(d.keyCode===13){a(e).jqGrid("saveCell",b,c)}if(d.keyCode==9){if(!e.grid.hDiv.loading){if(d.shiftKey){a(e).jqGrid("prevCell",b,c)}else{a(e).jqGrid("nextCell",b,c)}}else{return false}}d.stopPropagation()});if(a.isFunction(e.p.afterEditCell)){e.p.afterEditCell.call(e,e.rows[b].id,f,g,b,c)}}else{if(parseInt(e.p.iCol,10)>=0&&parseInt(e.p.iRow,10)>=0){a("td:eq("+e.p.iCol+")",e.rows[e.p.iRow]).removeClass("edit-cell ui-state-highlight");a(e.rows[e.p.iRow]).removeClass("selected-row ui-state-hover")}h.addClass("edit-cell ui-state-highlight");a(e.rows[b]).addClass("selected-row ui-state-hover");if(a.isFunction(e.p.onSelectCell)){g=h.html().replace(/\&#160\;/ig,"");e.p.onSelectCell.call(e,e.rows[b].id,f,g,b,c)}}e.p.iCol=c;e.p.iRow=b})},saveCell:function(b,c){return this.each(function(){var d=this,e;if(!d.grid||d.p.cellEdit!==true){return}if(d.p.savedRow.length>=1){e=0}else{e=null}if(e!==null){var f=a("td:eq("+c+")",d.rows[b]),g,h,i=d.p.colModel[c],j=i.name,k=a.jgrid.jqID(j);switch(i.edittype){case"select":if(!i.editoptions.multiple){g=a("#"+b+"_"+k+">option:selected",d.rows[b]).val();h=a("#"+b+"_"+k+">option:selected",d.rows[b]).text()}else{var l=a("#"+b+"_"+k,d.rows[b]),m=[];g=a(l).val();if(g){g.join(",")}else{g=""}a("option:selected",l).each(function(b,c){m[b]=a(c).text()});h=m.join(",")}if(i.formatter){h=g}break;case"checkbox":var n=["Yes","No"];if(i.editoptions){n=i.editoptions.value.split(":")}g=a("#"+b+"_"+k,d.rows[b]).is(":checked")?n[0]:n[1];h=g;break;case"password":case"text":case"textarea":case"button":g=a("#"+b+"_"+k,d.rows[b]).val();h=g;break;case"custom":try{if(i.editoptions&&a.isFunction(i.editoptions.custom_value)){g=i.editoptions.custom_value.call(d,a(".customelement",f),"get");if(g===undefined){throw"e2"}else{h=g}}else{throw"e1"}}catch(o){if(o=="e1"){a.jgrid.info_dialog(jQuery.jgrid.errors.errcap,"function 'custom_value' "+a.jgrid.edit.msg.nodefined,jQuery.jgrid.edit.bClose)}if(o=="e2"){a.jgrid.info_dialog(jQuery.jgrid.errors.errcap,"function 'custom_value' "+a.jgrid.edit.msg.novalue,jQuery.jgrid.edit.bClose)}else{a.jgrid.info_dialog(jQuery.jgrid.errors.errcap,o.message,jQuery.jgrid.edit.bClose)}}break}if(h!==d.p.savedRow[e].v){if(a.isFunction(d.p.beforeSaveCell)){var p=d.p.beforeSaveCell.call(d,d.rows[b].id,j,g,b,c);if(p){g=p;h=p}}var q=a.jgrid.checkValues(g,c,d);if(q[0]===true){var r={};if(a.isFunction(d.p.beforeSubmitCell)){r=d.p.beforeSubmitCell.call(d,d.rows[b].id,j,g,b,c);if(!r){r={}}}if(a("input.hasDatepicker",f).length>0){a("input.hasDatepicker",f).datepicker("hide")}if(d.p.cellsubmit=="remote"){if(d.p.cellurl){var s={};if(d.p.autoencode){g=a.jgrid.htmlEncode(g)}s[j]=g;var t,u,v;v=d.p.prmNames;t=v.id;u=v.oper;s[t]=a.jgrid.stripPref(d.p.idPrefix,d.rows[b].id);s[u]=v.editoper;s=a.extend(r,s);a("#lui_"+d.p.id).show();d.grid.hDiv.loading=true;a.ajax(a.extend({url:d.p.cellurl,data:a.isFunction(d.p.serializeCellData)?d.p.serializeCellData.call(d,s):s,type:"POST",complete:function(e,i){a("#lui_"+d.p.id).hide();d.grid.hDiv.loading=false;if(i=="success"){if(a.isFunction(d.p.afterSubmitCell)){var k=d.p.afterSubmitCell.call(d,e,s.id,j,g,b,c);if(k[0]===true){a(f).empty();a(d).jqGrid("setCell",d.rows[b].id,c,h,false,false,true);a(f).addClass("dirty-cell");a(d.rows[b]).addClass("edited");if(a.isFunction(d.p.afterSaveCell)){d.p.afterSaveCell.call(d,d.rows[b].id,j,g,b,c)}d.p.savedRow.splice(0,1)}else{a.jgrid.info_dialog(a.jgrid.errors.errcap,k[1],a.jgrid.edit.bClose);a(d).jqGrid("restoreCell",b,c)}}else{a(f).empty();a(d).jqGrid("setCell",d.rows[b].id,c,h,false,false,true);a(f).addClass("dirty-cell");a(d.rows[b]).addClass("edited");if(a.isFunction(d.p.afterSaveCell)){d.p.afterSaveCell.call(d,d.rows[b].id,j,g,b,c)}d.p.savedRow.splice(0,1)}}},error:function(e,f){a("#lui_"+d.p.id).hide();d.grid.hDiv.loading=false;if(a.isFunction(d.p.errorCell)){d.p.errorCell.call(d,e,f);a(d).jqGrid("restoreCell",b,c)}else{a.jgrid.info_dialog(a.jgrid.errors.errcap,e.status+" : "+e.statusText+"<br/>"+f,a.jgrid.edit.bClose);a(d).jqGrid("restoreCell",b,c)}}},a.jgrid.ajaxOptions,d.p.ajaxCellOptions||{}))}else{try{a.jgrid.info_dialog(a.jgrid.errors.errcap,a.jgrid.errors.nourl,a.jgrid.edit.bClose);a(d).jqGrid("restoreCell",b,c)}catch(o){}}}if(d.p.cellsubmit=="clientArray"){a(f).empty();a(d).jqGrid("setCell",d.rows[b].id,c,h,false,false,true);a(f).addClass("dirty-cell");a(d.rows[b]).addClass("edited");if(a.isFunction(d.p.afterSaveCell)){d.p.afterSaveCell.call(d,d.rows[b].id,j,g,b,c)}d.p.savedRow.splice(0,1)}}else{try{window.setTimeout(function(){a.jgrid.info_dialog(a.jgrid.errors.errcap,g+" "+q[1],a.jgrid.edit.bClose)},100);a(d).jqGrid("restoreCell",b,c)}catch(o){}}}else{a(d).jqGrid("restoreCell",b,c)}}if(a.browser.opera){a("#"+d.p.knv).attr("tabindex","-1").focus()}else{window.setTimeout(function(){a("#"+d.p.knv).attr("tabindex","-1").focus()},0)}})},restoreCell:function(b,c){return this.each(function(){var d=this,e;if(!d.grid||d.p.cellEdit!==true){return}if(d.p.savedRow.length>=1){e=0}else{e=null}if(e!==null){var f=a("td:eq("+c+")",d.rows[b]);if(a.isFunction(a.fn.datepicker)){try{a("input.hasDatepicker",f).datepicker("hide")}catch(g){}}a(f).empty().attr("tabindex","-1");a(d).jqGrid("setCell",d.rows[b].id,c,d.p.savedRow[e].v,false,false,true);if(a.isFunction(d.p.afterRestoreCell)){d.p.afterRestoreCell.call(d,d.rows[b].id,d.p.savedRow[e].v,b,c)}d.p.savedRow.splice(0,1)}window.setTimeout(function(){a("#"+d.p.knv).attr("tabindex","-1").focus()},0)})},nextCell:function(b,c){return this.each(function(){var d=this,e=false;if(!d.grid||d.p.cellEdit!==true){return}for(var f=c+1;f<d.p.colModel.length;f++){if(d.p.colModel[f].editable===true){e=f;break}}if(e!==false){a(d).jqGrid("editCell",b,e,true)}else{if(d.p.savedRow.length>0){a(d).jqGrid("saveCell",b,c)}}})},prevCell:function(b,c){return this.each(function(){var d=this,e=false;if(!d.grid||d.p.cellEdit!==true){return}for(var f=c-1;f>=0;f--){if(d.p.colModel[f].editable===true){e=f;break}}if(e!==false){a(d).jqGrid("editCell",b,e,true)}else{if(d.p.savedRow.length>0){a(d).jqGrid("saveCell",b,c)}}})},GridNav:function(){return this.each(function(){function g(a,c){var d,e;if(c=="lft"){d=a+1;for(e=a;e>=0;e--){if(b.p.colModel[e].hidden!==true){d=e;break}}}if(c=="rgt"){d=a-1;for(e=a;e<b.p.colModel.length;e++){if(b.p.colModel[e].hidden!==true){d=e;break}}}return d}function f(c,d,e){if(e.substr(0,1)=="v"){var f=a(b.grid.bDiv)[0].clientHeight,g=a(b.grid.bDiv)[0].scrollTop,h=b.rows[c].offsetTop+b.rows[c].clientHeight,i=b.rows[c].offsetTop;if(e=="vd"){if(h>=f){a(b.grid.bDiv)[0].scrollTop=a(b.grid.bDiv)[0].scrollTop+b.rows[c].clientHeight}}if(e=="vu"){if(i<g){a(b.grid.bDiv)[0].scrollTop=a(b.grid.bDiv)[0].scrollTop-b.rows[c].clientHeight}}}if(e=="h"){var j=a(b.grid.bDiv)[0].clientWidth,k=a(b.grid.bDiv)[0].scrollLeft,l=b.rows[c].cells[d].offsetLeft+b.rows[c].cells[d].clientWidth,m=b.rows[c].cells[d].offsetLeft;if(l>=j+parseInt(k,10)){a(b.grid.bDiv)[0].scrollLeft=a(b.grid.bDiv)[0].scrollLeft+b.rows[c].cells[d].clientWidth}else if(m<k){a(b.grid.bDiv)[0].scrollLeft=a(b.grid.bDiv)[0].scrollLeft-b.rows[c].cells[d].clientWidth}}}var b=this;if(!b.grid||b.p.cellEdit!==true){return}b.p.knv=b.p.id+"_kn";var c=a("<span style='width:0px;height:0px;background-color:black;' tabindex='0'><span tabindex='-1' style='width:0px;height:0px;background-color:grey' id='"+b.p.knv+"'></span></span>"),d,e;a(c).insertBefore(b.grid.cDiv);a("#"+b.p.knv).focus().keydown(function(c){e=c.keyCode;if(b.p.direction=="rtl"){if(e==37){e=39}else if(e==39){e=37}}switch(e){case 38:if(b.p.iRow-1>0){f(b.p.iRow-1,b.p.iCol,"vu");a(b).jqGrid("editCell",b.p.iRow-1,b.p.iCol,false)}break;case 40:if(b.p.iRow+1<=b.rows.length-1){f(b.p.iRow+1,b.p.iCol,"vd");a(b).jqGrid("editCell",b.p.iRow+1,b.p.iCol,false)}break;case 37:if(b.p.iCol-1>=0){d=g(b.p.iCol-1,"lft");f(b.p.iRow,d,"h");a(b).jqGrid("editCell",b.p.iRow,d,false)}break;case 39:if(b.p.iCol+1<=b.p.colModel.length-1){d=g(b.p.iCol+1,"rgt");f(b.p.iRow,d,"h");a(b).jqGrid("editCell",b.p.iRow,d,false)}break;case 13:if(parseInt(b.p.iCol,10)>=0&&parseInt(b.p.iRow,10)>=0){a(b).jqGrid("editCell",b.p.iRow,b.p.iCol,true)}break}return false})})},getChangedCells:function(b){var c=[];if(!b){b="all"}this.each(function(){var d=this,e;if(!d.grid||d.p.cellEdit!==true){return}a(d.rows).each(function(f){var g={};if(a(this).hasClass("edited")){a("td",this).each(function(c){e=d.p.colModel[c].name;if(e!=="cb"&&e!=="subgrid"){if(b=="dirty"){if(a(this).hasClass("dirty-cell")){try{g[e]=a.unformat(this,{rowId:d.rows[f].id,colModel:d.p.colModel[c]},c)}catch(h){g[e]=a.jgrid.htmlDecode(a(this).html())}}}else{try{g[e]=a.unformat(this,{rowId:d.rows[f].id,colModel:d.p.colModel[c]},c)}catch(h){g[e]=a.jgrid.htmlDecode(a(this).html())}}}});g.id=this.id;c.push(g)}})});return c}})})(jQuery);(function(a){a.jgrid.extend({setSubGrid:function(){return this.each(function(){var b=this,c,d={plusicon:"ui-icon-plus",minusicon:"ui-icon-minus",openicon:"ui-icon-carat-1-sw",expandOnLoad:false,delayOnLoad:50,selectOnExpand:false,reloadOnExpand:true};b.p.subGridOptions=a.extend(d,b.p.subGridOptions||{});b.p.colNames.unshift("");b.p.colModel.unshift({name:"subgrid",width:a.browser.safari?b.p.subGridWidth+b.p.cellLayout:b.p.subGridWidth,sortable:false,resizable:false,hidedlg:true,search:false,fixed:true});c=b.p.subGridModel;if(c[0]){c[0].align=a.extend([],c[0].align||[]);for(var e=0;e<c[0].name.length;e++){c[0].align[e]=c[0].align[e]||"left"}}})},addSubGridCell:function(a,b){var c="",d,e;this.each(function(){c=this.formatCol(a,b);e=this.p.id;d=this.p.subGridOptions.plusicon});return'<td role="grid" aria-describedby="'+e+'_subgrid" class="ui-sgcollapsed sgcollapsed" '+c+"><a href='javascript:void(0);'><span class='ui-icon "+d+"'></span></a></td>"},addSubGrid:function(b,c){return this.each(function(){var d=this;if(!d.grid){return}var e=function(b,c,e){var f=a("<td align='"+d.p.subGridModel[0].align[e]+"'></td>").html(c);a(b).append(f)};var f=function(b,c){var f,g,h,i=a("<table cellspacing='0' cellpadding='0' border='0'><tbody></tbody></table>"),j=a("<tr></tr>");for(g=0;g<d.p.subGridModel[0].name.length;g++){f=a("<th class='ui-state-default ui-th-subgrid ui-th-column ui-th-"+d.p.direction+"'></th>");a(f).html(d.p.subGridModel[0].name[g]);a(f).width(d.p.subGridModel[0].width[g]);a(j).append(f)}a(i).append(j);if(b){h=d.p.xmlReader.subgrid;a(h.root+" "+h.row,b).each(function(){j=a("<tr class='ui-widget-content ui-subtblcell'></tr>");if(h.repeatitems===true){a(h.cell,this).each(function(b){e(j,a(this).text()||"&#160;",b)})}else{var b=d.p.subGridModel[0].mapping||d.p.subGridModel[0].name;if(b){for(g=0;g<b.length;g++){e(j,a(b[g],this).text()||"&#160;",g)}}}a(i).append(j)})}var k=a("table:first",d.grid.bDiv).attr("id")+"_";a("#"+k+c).append(i);d.grid.hDiv.loading=false;a("#load_"+d.p.id).hide();return false};var g=function(b,c){var f,g,h,i,j,k,l=a("<table cellspacing='0' cellpadding='0' border='0'><tbody></tbody></table>"),m=a("<tr></tr>");for(h=0;h<d.p.subGridModel[0].name.length;h++){f=a("<th class='ui-state-default ui-th-subgrid ui-th-column ui-th-"+d.p.direction+"'></th>");a(f).html(d.p.subGridModel[0].name[h]);a(f).width(d.p.subGridModel[0].width[h]);a(m).append(f)}a(l).append(m);if(b){j=d.p.jsonReader.subgrid;g=b[j.root];if(typeof g!=="undefined"){for(h=0;h<g.length;h++){i=g[h];m=a("<tr class='ui-widget-content ui-subtblcell'></tr>");if(j.repeatitems===true){if(j.cell){i=i[j.cell]}for(k=0;k<i.length;k++){e(m,i[k]||"&#160;",k)}}else{var n=d.p.subGridModel[0].mapping||d.p.subGridModel[0].name;if(n.length){for(k=0;k<n.length;k++){e(m,i[n[k]]||"&#160;",k)}}}a(l).append(m)}}}var o=a("table:first",d.grid.bDiv).attr("id")+"_";a("#"+o+c).append(l);d.grid.hDiv.loading=false;a("#load_"+d.p.id).hide();return false};var h=function(b){var c,e,h,i;c=a(b).attr("id");e={nd_:(new Date).getTime()};e[d.p.prmNames.subgridid]=c;if(!d.p.subGridModel[0]){return false}if(d.p.subGridModel[0].params){for(i=0;i<d.p.subGridModel[0].params.length;i++){for(h=0;h<d.p.colModel.length;h++){if(d.p.colModel[h].name==d.p.subGridModel[0].params[i]){e[d.p.colModel[h].name]=a("td:eq("+h+")",b).text().replace(/\&#160\;/ig,"")}}}}if(!d.grid.hDiv.loading){d.grid.hDiv.loading=true;a("#load_"+d.p.id).show();if(!d.p.subgridtype){d.p.subgridtype=d.p.datatype}if(a.isFunction(d.p.subgridtype)){d.p.subgridtype.call(d,e)}else{d.p.subgridtype=d.p.subgridtype.toLowerCase()}switch(d.p.subgridtype){case"xml":case"json":a.ajax(a.extend({type:d.p.mtype,url:d.p.subGridUrl,dataType:d.p.subgridtype,data:a.isFunction(d.p.serializeSubGridData)?d.p.serializeSubGridData.call(d,e):e,complete:function(b){if(d.p.subgridtype=="xml"){f(b.responseXML,c)}else{g(a.jgrid.parse(b.responseText),c)}b=null}},a.jgrid.ajaxOptions,d.p.ajaxSubgridOptions||{}));break}}return false};var i,j,k,l=0,m,n;a.each(d.p.colModel,function(a,b){if(this.hidden===true||this.name=="rn"||this.name=="cb"){l++}});var o=d.rows.length,p=1;if(c!==undefined&&c>0){p=c;o=c+1}while(p<o){if(a(d.rows[p]).hasClass("jqgrow")){a(d.rows[p].cells[b]).bind("click",function(c){var e=a(this).parent("tr")[0];n=e.nextSibling;if(a(this).hasClass("sgcollapsed")){j=d.p.id;i=e.id;if(d.p.subGridOptions.reloadOnExpand===true||d.p.subGridOptions.reloadOnExpand===false&&!a(n).hasClass("ui-subgrid")){k=b>=1?"<td colspan='"+b+"'>&#160;</td>":"";m=true;if(a.isFunction(d.p.subGridBeforeExpand)){m=d.p.subGridBeforeExpand.call(d,j+"_"+i,i)}if(m===false){return false}a(e).after("<tr role='row' class='ui-subgrid'>"+k+"<td class='ui-widget-content subgrid-cell'><span class='ui-icon "+d.p.subGridOptions.openicon+"'></span></td><td colspan='"+parseInt(d.p.colNames.length-1-l,10)+"' class='ui-widget-content subgrid-data'><div id="+j+"_"+i+" class='tablediv'></div></td></tr>");if(a.isFunction(d.p.subGridRowExpanded)){d.p.subGridRowExpanded.call(d,j+"_"+i,i)}else{h(e)}}else{a(n).show()}a(this).html("<a href='javascript:void(0);'><span class='ui-icon "+d.p.subGridOptions.minusicon+"'></span></a>").removeClass("sgcollapsed").addClass("sgexpanded");if(d.p.subGridOptions.selectOnExpand){a(d).jqGrid("setSelection",i)}}else if(a(this).hasClass("sgexpanded")){m=true;if(a.isFunction(d.p.subGridRowColapsed)){i=e.id;m=d.p.subGridRowColapsed.call(d,j+"_"+i,i)}if(m===false){return false}if(d.p.subGridOptions.reloadOnExpand===true){a(n).remove(".ui-subgrid")}else if(a(n).hasClass("ui-subgrid")){a(n).hide()}a(this).html("<a href='javascript:void(0);'><span class='ui-icon "+d.p.subGridOptions.plusicon+"'></span></a>").removeClass("sgexpanded").addClass("sgcollapsed")}return false})}if(d.p.subGridOptions.expandOnLoad===true){a(d.rows[p].cells[b]).trigger("click")}p++}d.subGridXml=function(a,b){f(a,b)};d.subGridJson=function(a,b){g(a,b)}})},expandSubGridRow:function(b){return this.each(function(){var c=this;if(!c.grid&&!b){return}if(c.p.subGrid===true){var d=a(this).jqGrid("getInd",b,true);if(d){var e=a("td.sgcollapsed",d)[0];if(e){a(e).trigger("click")}}}})},collapseSubGridRow:function(b){return this.each(function(){var c=this;if(!c.grid&&!b){return}if(c.p.subGrid===true){var d=a(this).jqGrid("getInd",b,true);if(d){var e=a("td.sgexpanded",d)[0];if(e){a(e).trigger("click")}}}})},toggleSubGridRow:function(b){return this.each(function(){var c=this;if(!c.grid&&!b){return}if(c.p.subGrid===true){var d=a(this).jqGrid("getInd",b,true);if(d){var e=a("td.sgcollapsed",d)[0];if(e){a(e).trigger("click")}else{e=a("td.sgexpanded",d)[0];if(e){a(e).trigger("click")}}}}})}})})(jQuery);(function(a){a.jgrid.extend({setTreeNode:function(b,c){return this.each(function(){var d=this;if(!d.grid||!d.p.treeGrid){return}var e=d.p.expColInd,f=d.p.treeReader.expanded_field,g=d.p.treeReader.leaf_field,h=d.p.treeReader.level_field,j=d.p.treeReader.icon_field,k=d.p.treeReader.loaded,l,m,n,o,p,q,r,s;while(b<c){var t=d.rows[b].id,u=d.p._index[t],v;r=d.p.data[u];if(d.p.treeGridModel=="nested"){if(!r[g]){l=parseInt(r[d.p.treeReader.left_field],10);m=parseInt(r[d.p.treeReader.right_field],10);r[g]=m===l+1?"true":"false";d.rows[b].cells[d.p._treeleafpos].innerHTML=r[g]}}n=parseInt(r[h],10);if(d.p.tree_root_level===0){o=n+1;p=n}else{o=n;p=n-1}q="<div class='tree-wrap tree-wrap-"+d.p.direction+"' style='width:"+o*18+"px;'>";q+="<div style='"+(d.p.direction=="rtl"?"right:":"left:")+p*18+"px;' class='ui-icon ";if(r[k]!==undefined){if(r[k]=="true"||r[k]===true){r[k]=true}else{r[k]=false}}if(r[g]=="true"||r[g]===true){q+=(r[j]!==undefined&&r[j]!==""?r[j]:d.p.treeIcons.leaf)+" tree-leaf treeclick";r[g]=true;s="leaf"}else{r[g]=false;s=""}r[f]=(r[f]=="true"||r[f]===true?true:false)&&r[k];if(r[f]===false){q+=r[g]===true?"'":d.p.treeIcons.plus+" tree-plus treeclick'"}else{q+=r[g]===true?"'":d.p.treeIcons.minus+" tree-minus treeclick'"}q+="></div></div>";a(d.rows[b].cells[e]).wrapInner("<span class='cell-wrapper"+s+"'></span>").prepend(q);if(n!==parseInt(d.p.tree_root_level,10)){var w=a(d).jqGrid("getNodeParent",r);v=w&&w.hasOwnProperty(f)?w[f]:true;if(!v){a(d.rows[b]).css("display","none")}}a(d.rows[b].cells[e]).find("div.treeclick").bind("click",function(b){var c=b.target||b.srcElement,e=a(c,d.rows).closest("tr.jqgrow")[0].id,h=d.p._index[e];if(!d.p.data[h][g]){if(d.p.data[h][f]){a(d).jqGrid("collapseRow",d.p.data[h]);a(d).jqGrid("collapseNode",d.p.data[h])}else{a(d).jqGrid("expandRow",d.p.data[h]);a(d).jqGrid("expandNode",d.p.data[h])}}return false});if(d.p.ExpandColClick===true){a(d.rows[b].cells[e]).find("span.cell-wrapper").css("cursor","pointer").bind("click",function(b){var c=b.target||b.srcElement,e=a(c,d.rows).closest("tr.jqgrow")[0].id,h=d.p._index[e];if(!d.p.data[h][g]){if(d.p.data[h][f]){a(d).jqGrid("collapseRow",d.p.data[h]);a(d).jqGrid("collapseNode",d.p.data[h])}else{a(d).jqGrid("expandRow",d.p.data[h]);a(d).jqGrid("expandNode",d.p.data[h])}}a(d).jqGrid("setSelection",e);return false})}b++}})},setTreeGrid:function(){return this.each(function(){var b=this,c=0,d,e=false,f,g,h=[];if(!b.p.treeGrid){return}if(!b.p.treedatatype){a.extend(b.p,{treedatatype:b.p.datatype})}b.p.subGrid=false;b.p.altRows=false;b.p.pgbuttons=false;b.p.pginput=false;b.p.gridview=true;if(b.p.rowTotal===null){b.p.rowNum=1e4}b.p.multiselect=false;b.p.rowList=[];b.p.expColInd=0;d="ui-icon-triangle-1-"+(b.p.direction=="rtl"?"w":"e");b.p.treeIcons=a.extend({plus:d,minus:"ui-icon-triangle-1-s",leaf:"ui-icon-radio-off"},b.p.treeIcons||{});if(b.p.treeGridModel=="nested"){b.p.treeReader=a.extend({level_field:"level",left_field:"lft",right_field:"rgt",leaf_field:"isLeaf",expanded_field:"expanded",loaded:"loaded",icon_field:"icon"},b.p.treeReader)}else if(b.p.treeGridModel=="adjacency"){b.p.treeReader=a.extend({level_field:"level",parent_id_field:"parent",leaf_field:"isLeaf",expanded_field:"expanded",loaded:"loaded",icon_field:"icon"},b.p.treeReader)}for(g in b.p.colModel){if(b.p.colModel.hasOwnProperty(g)){f=b.p.colModel[g].name;if(f==b.p.ExpandColumn&&!e){e=true;b.p.expColInd=c}c++;for(var i in b.p.treeReader){if(b.p.treeReader[i]==f)h.push(f)}}}a.each(b.p.treeReader,function(d,e){if(e&&a.inArray(e,h)===-1){if(d==="leaf_field"){b.p._treeleafpos=c}c++;b.p.colNames.push(e);b.p.colModel.push({name:e,width:1,hidden:true,sortable:false,resizable:false,hidedlg:true,editable:true,search:false})}})})},expandRow:function(b){this.each(function(){var c=this;if(!c.grid||!c.p.treeGrid){return}var d=a(c).jqGrid("getNodeChildren",b),e=c.p.treeReader.expanded_field;a(d).each(function(b){var d=a.jgrid.getAccessor(this,c.p.localReader.id);a("#"+d,c.grid.bDiv).css("display","");if(this[e]){a(c).jqGrid("expandRow",this)}})})},collapseRow:function(b){this.each(function(){var c=this;if(!c.grid||!c.p.treeGrid){return}var d=a(c).jqGrid("getNodeChildren",b),e=c.p.treeReader.expanded_field;a(d).each(function(b){var d=a.jgrid.getAccessor(this,c.p.localReader.id);a("#"+d,c.grid.bDiv).css("display","none");if(this[e]){a(c).jqGrid("collapseRow",this)}})})},getRootNodes:function(){var b=[];this.each(function(){var c=this;if(!c.grid||!c.p.treeGrid){return}switch(c.p.treeGridModel){case"nested":var d=c.p.treeReader.level_field;a(c.p.data).each(function(a){if(parseInt(this[d],10)===parseInt(c.p.tree_root_level,10)){b.push(this)}});break;case"adjacency":var e=c.p.treeReader.parent_id_field;a(c.p.data).each(function(a){if(this[e]===null||String(this[e]).toLowerCase()=="null"){b.push(this)}});break}});return b},getNodeDepth:function(b){var c=null;this.each(function(){if(!this.grid||!this.p.treeGrid){return}var d=this;switch(d.p.treeGridModel){case"nested":var e=d.p.treeReader.level_field;c=parseInt(b[e],10)-parseInt(d.p.tree_root_level,10);break;case"adjacency":c=a(d).jqGrid("getNodeAncestors",b).length;break}});return c},getNodeParent:function(b){var c=null;this.each(function(){var d=this;if(!d.grid||!d.p.treeGrid){return}switch(d.p.treeGridModel){case"nested":var e=d.p.treeReader.left_field,f=d.p.treeReader.right_field,g=d.p.treeReader.level_field,h=parseInt(b[e],10),i=parseInt(b[f],10),j=parseInt(b[g],10);a(this.p.data).each(function(){if(parseInt(this[g],10)===j-1&&parseInt(this[e],10)<h&&parseInt(this[f],10)>i){c=this;return false}});break;case"adjacency":var k=d.p.treeReader.parent_id_field,l=d.p.localReader.id;a(this.p.data).each(function(a,d){if(this[l]==b[k]){c=this;return false}});break}});return c},getNodeChildren:function(b){var c=[];this.each(function(){var d=this;if(!d.grid||!d.p.treeGrid){return}switch(d.p.treeGridModel){case"nested":var e=d.p.treeReader.left_field,f=d.p.treeReader.right_field,g=d.p.treeReader.level_field,h=parseInt(b[e],10),i=parseInt(b[f],10),j=parseInt(b[g],10);a(this.p.data).each(function(a){if(parseInt(this[g],10)===j+1&&parseInt(this[e],10)>h&&parseInt(this[f],10)<i){c.push(this)}});break;case"adjacency":var k=d.p.treeReader.parent_id_field,l=d.p.localReader.id;a(this.p.data).each(function(a,d){if(this[k]==b[l]){c.push(this)}});break}});return c},getFullTreeNode:function(b){var c=[];this.each(function(){var d=this,e;if(!d.grid||!d.p.treeGrid){return}switch(d.p.treeGridModel){case"nested":var f=d.p.treeReader.left_field,g=d.p.treeReader.right_field,h=d.p.treeReader.level_field,i=parseInt(b[f],10),j=parseInt(b[g],10),k=parseInt(b[h],10);a(this.p.data).each(function(a){if(parseInt(this[h],10)>=k&&parseInt(this[f],10)>=i&&parseInt(this[f],10)<=j){c.push(this)}});break;case"adjacency":if(b){c.push(b);var l=d.p.treeReader.parent_id_field,m=d.p.localReader.id;a(this.p.data).each(function(a){e=c.length;for(a=0;a<e;a++){if(c[a][m]==this[l]){c.push(this);break}}})}break}});return c},getNodeAncestors:function(b){var c=[];this.each(function(){if(!this.grid||!this.p.treeGrid){return}var d=a(this).jqGrid("getNodeParent",b);while(d){c.push(d);d=a(this).jqGrid("getNodeParent",d)}});return c},isVisibleNode:function(b){var c=true;this.each(function(){var d=this;if(!d.grid||!d.p.treeGrid){return}var e=a(d).jqGrid("getNodeAncestors",b),f=d.p.treeReader.expanded_field;a(e).each(function(){c=c&&this[f];if(!c){return false}})});return c},isNodeLoaded:function(b){var c;this.each(function(){var d=this;if(!d.grid||!d.p.treeGrid){return}var e=d.p.treeReader.leaf_field;if(b!==undefined){if(b.loaded!==undefined){c=b.loaded}else if(b[e]||a(d).jqGrid("getNodeChildren",b).length>0){c=true}else{c=false}}else{c=false}});return c},expandNode:function(b){return this.each(function(){if(!this.grid||!this.p.treeGrid){return}var c=this.p.treeReader.expanded_field,d=this.p.treeReader.parent_id_field,e=this.p.treeReader.loaded,f=this.p.treeReader.level_field,g=this.p.treeReader.left_field,h=this.p.treeReader.right_field;if(!b[c]){var i=a.jgrid.getAccessor(b,this.p.localReader.id);var j=a("#"+i,this.grid.bDiv)[0];var k=this.p._index[i];if(a(this).jqGrid("isNodeLoaded",this.p.data[k])){b[c]=true;a("div.treeclick",j).removeClass(this.p.treeIcons.plus+" tree-plus").addClass(this.p.treeIcons.minus+" tree-minus")}else{b[c]=true;a("div.treeclick",j).removeClass(this.p.treeIcons.plus+" tree-plus").addClass(this.p.treeIcons.minus+" tree-minus");this.p.treeANode=j.rowIndex;this.p.datatype=this.p.treedatatype;if(this.p.treeGridModel=="nested"){a(this).jqGrid("setGridParam",{postData:{nodeid:i,n_left:b[g],n_right:b[h],n_level:b[f]}})}else{a(this).jqGrid("setGridParam",{postData:{nodeid:i,parentid:b[d],n_level:b[f]}})}a(this).trigger("reloadGrid");b[e]=true;if(this.p.treeGridModel=="nested"){a(this).jqGrid("setGridParam",{postData:{nodeid:"",n_left:"",n_right:"",n_level:""}})}else{a(this).jqGrid("setGridParam",{postData:{nodeid:"",parentid:"",n_level:""}})}}}})},collapseNode:function(b){return this.each(function(){if(!this.grid||!this.p.treeGrid){return}if(b.expanded){b.expanded=false;var c=a.jgrid.getAccessor(b,this.p.localReader.id);var d=a("#"+c,this.grid.bDiv)[0];a("div.treeclick",d).removeClass(this.p.treeIcons.minus+" tree-minus").addClass(this.p.treeIcons.plus+" tree-plus")}})},SortTree:function(b,c,d,e){return this.each(function(){if(!this.grid||!this.p.treeGrid){return}var f,g,h,i=[],j=this,k,l,m=a(this).jqGrid("getRootNodes");k=a.jgrid.from(m);k.orderBy(b,c,d,e);l=k.select();for(f=0,g=l.length;f<g;f++){h=l[f];i.push(h);a(this).jqGrid("collectChildrenSortTree",i,h,b,c,d,e)}a.each(i,function(b,c){var d=a.jgrid.getAccessor(this,j.p.localReader.id);a("#"+j.p.id+" tbody tr:eq("+b+")").after(a("tr#"+d,j.grid.bDiv))});k=null;l=null;i=null})},collectChildrenSortTree:function(b,c,d,e,f,g){return this.each(function(){if(!this.grid||!this.p.treeGrid){return}var h,i,j,k,l,m;k=a(this).jqGrid("getNodeChildren",c);l=a.jgrid.from(k);l.orderBy(d,e,f,g);m=l.select();for(h=0,i=m.length;h<i;h++){j=m[h];b.push(j);a(this).jqGrid("collectChildrenSortTree",b,j,d,e,f,g)}})},setTreeRow:function(b,c){var d=false;this.each(function(){var e=this;if(!e.grid||!e.p.treeGrid){return}d=a(e).jqGrid("setRowData",b,c)});return d},delTreeNode:function(b){return this.each(function(){var c=this,d=c.p.localReader.id,e=c.p.treeReader.left_field,f=c.p.treeReader.right_field,g,h,i,j;if(!c.grid||!c.p.treeGrid){return}var k=c.p._index[b];if(k!==undefined){g=parseInt(c.p.data[k][f],10);h=g-parseInt(c.p.data[k][e],10)+1;var l=a(c).jqGrid("getFullTreeNode",c.p.data[k]);if(l.length>0){for(var m=0;m<l.length;m++){a(c).jqGrid("delRowData",l[m][d])}}if(c.p.treeGridModel==="nested"){i=a.jgrid.from(c.p.data).greater(e,g,{stype:"integer"}).select();if(i.length){for(j in i){i[j][e]=parseInt(i[j][e],10)-h}}i=a.jgrid.from(c.p.data).greater(f,g,{stype:"integer"}).select();if(i.length){for(j in i){i[j][f]=parseInt(i[j][f],10)-h}}}}})},addChildNode:function(b,c,d){var e=this[0];if(d){var f=e.p.treeReader.expanded_field,g=e.p.treeReader.leaf_field,h=e.p.treeReader.level_field,i=e.p.treeReader.icon_field,j=e.p.treeReader.parent_id_field,k=e.p.treeReader.left_field,l=e.p.treeReader.right_field,m=e.p.treeReader.loaded,n,o,p,q,r,s,t=0,u=c,v,w;if(!b){r=e.p.data.length-1;if(r>=0){while(r>=0){t=Math.max(t,parseInt(e.p.data[r][e.p.localReader.id],10));r--}}b=t+1}var x=a(e).jqGrid("getInd",c);v=false;if(c===undefined||c===null||c===""){c=null;u=null;n="last";q=e.p.tree_root_level;r=e.p.data.length+1}else{n="after";o=e.p._index[c];p=e.p.data[o];c=p[e.p.localReader.id];q=parseInt(p[h],10)+1;var y=a(e).jqGrid("getFullTreeNode",p);if(y.length){r=y[y.length-1][e.p.localReader.id];u=r;r=a(e).jqGrid("getInd",u)+1}else{r=a(e).jqGrid("getInd",c)+1}if(p[g]){v=true;p[f]=true;a(e.rows[x]).find("span.cell-wrapperleaf").removeClass("cell-wrapperleaf").addClass("cell-wrapper").end().find("div.tree-leaf").removeClass(e.p.treeIcons.leaf+" tree-leaf").addClass(e.p.treeIcons.minus+" tree-minus");e.p.data[o][g]=false;p[m]=true}}s=r+1;d[f]=false;d[m]=true;d[h]=q;d[g]=true;if(e.p.treeGridModel==="adjacency"){d[j]=c}if(e.p.treeGridModel==="nested"){var z,A,B;if(c!==null){w=parseInt(p[l],10);z=a.jgrid.from(e.p.data);z=z.greaterOrEquals(l,w,{stype:"integer"});A=z.select();if(A.length){for(B in A){A[B][k]=A[B][k]>w?parseInt(A[B][k],10)+2:A[B][k];A[B][l]=A[B][l]>=w?parseInt(A[B][l],10)+2:A[B][l]}}d[k]=w;d[l]=w+1}else{w=parseInt(a(e).jqGrid("getCol",l,false,"max"),10);A=a.jgrid.from(e.p.data).greater(k,w,{stype:"integer"}).select();if(A.length){for(B in A){A[B][k]=parseInt(A[B][k],10)+2}}A=a.jgrid.from(e.p.data).greater(l,w,{stype:"integer"}).select();if(A.length){for(B in A){A[B][l]=parseInt(A[B][l],10)+2}}d[k]=w+1;d[l]=w+2}}if(c===null||a(e).jqGrid("isNodeLoaded",p)||v){a(e).jqGrid("addRowData",b,d,n,u);a(e).jqGrid("setTreeNode",r,s)}if(p&&!p[f]){a(e.rows[x]).find("div.treeclick").click()}}}})})(jQuery);(function(a){a.jgrid.extend({groupingSetup:function(){return this.each(function(){var b=this,c=b.p.groupingView;if(c!==null&&(typeof c==="object"||a.isFunction(c))){if(!c.groupField.length){b.p.grouping=false}else{if(typeof c.visibiltyOnNextGrouping=="undefined"){c.visibiltyOnNextGrouping=[]}for(var d=0;d<c.groupField.length;d++){if(!c.groupOrder[d]){c.groupOrder[d]="asc"}if(!c.groupText[d]){c.groupText[d]="{0}"}if(typeof c.groupColumnShow[d]!="boolean"){c.groupColumnShow[d]=true}if(typeof c.groupSummary[d]!="boolean"){c.groupSummary[d]=false}if(c.groupColumnShow[d]===true){c.visibiltyOnNextGrouping[d]=true;a(b).jqGrid("showCol",c.groupField[d])}else{c.visibiltyOnNextGrouping[d]=a("#"+b.p.id+"_"+c.groupField[d]).is(":visible");a(b).jqGrid("hideCol",c.groupField[d])}c.sortitems[d]=[];c.sortnames[d]=[];c.summaryval[d]=[];if(c.groupSummary[d]){c.summary[d]=[];var e=b.p.colModel;for(var f=0,g=e.length;f<g;f++){if(e[f].summaryType){c.summary[d].push({nm:e[f].name,st:e[f].summaryType,v:""})}}}}b.p.scroll=false;b.p.rownumbers=false;b.p.subGrid=false;b.p.treeGrid=false;b.p.gridview=true}}else{b.p.grouping=false}})},groupingPrepare:function(b,c,d,e){this.each(function(){c[0]+="";var f=c[0].toString().split(" ").join("");var g=this.p.groupingView,h=this;if(d.hasOwnProperty(f)){d[f].push(b)}else{d[f]=[];d[f].push(b);g.sortitems[0].push(f);g.sortnames[0].push(a.trim(c[0].toString()));g.summaryval[0][f]=a.extend(true,[],g.summary[0])}if(g.groupSummary[0]){a.each(g.summaryval[0][f],function(){if(a.isFunction(this.st)){this.v=this.st.call(h,this.v,this.nm,e)}else{this.v=a(h).jqGrid("groupingCalculations."+this.st,this.v,this.nm,e)}})}});return d},groupingToggle:function(b){this.each(function(){var c=this,d=c.p.groupingView,e=b.lastIndexOf("_"),f=b.substring(0,e+1),g=parseInt(b.substring(e+1),10)+1,h=d.minusicon,i=d.plusicon,j=a("#"+b),k=j.length?j[0].nextSibling:null,l=a("#"+b+" span."+"tree-wrap-"+c.p.direction),m=false;if(l.hasClass(h)){if(d.showSummaryOnHide&&d.groupSummary[0]){if(k){while(k){if(a(k).hasClass("jqfoot")){break}a(k).hide();k=k.nextSibling}}}else{if(k){while(k){if(a(k).attr("id")==f+String(g)){break}a(k).hide();k=k.nextSibling}}}l.removeClass(h).addClass(i);m=true}else{if(k){while(k){if(a(k).attr("id")==f+String(g)){break}a(k).show();k=k.nextSibling}}l.removeClass(i).addClass(h)}if(a.isFunction(c.p.onClickGroup)){c.p.onClickGroup.call(c,b,m)}});return false},groupingRender:function(b,c){return this.each(function(){var d=this,e=d.p.groupingView,f="",g="",h,i=e.groupCollapse?e.plusicon:e.minusicon,j,k,l;if(!e.groupDataSorted){e.sortitems[0].sort();e.sortnames[0].sort();if(e.groupOrder[0].toLowerCase()=="desc"){e.sortitems[0].reverse();e.sortnames[0].reverse()}}i+=" tree-wrap-"+d.p.direction;l=0;while(l<c){if(d.p.colModel[l].name==e.groupField[0]){k=l;break}l++}a.each(e.sortitems[0],function(l,m){h=d.p.id+"ghead_"+l;g="<span style='cursor:pointer;' class='ui-icon "+i+"' onclick=\"jQuery('#"+d.p.id+"').jqGrid('groupingToggle','"+h+"');return false;\"></span>";try{j=d.formatter(h,e.sortnames[0][l],k,e.sortitems[0])}catch(n){j=e.sortnames[0][l]}f+='<tr id="'+h+'" role="row" class= "ui-widget-content jqgroup ui-row-'+d.p.direction+'"><td colspan="'+c+'">'+g+a.jgrid.format(e.groupText[0],j,b[m].length)+"</td></tr>";for(var o=0;o<b[m].length;o++){f+=b[m][o].join("")}if(e.groupSummary[0]){var p="";if(e.groupCollapse&&!e.showSummaryOnHide){p=' style="display:none;"'}f+="<tr"+p+' role="row" class="ui-widget-content jqfoot ui-row-'+d.p.direction+'">';var q=e.summaryval[0][m],r=d.p.colModel,s,t=b[m].length;for(var u=0;u<c;u++){var v="<td "+d.formatCol(u,1,"")+">&#160;</td>",w="{0}";a.each(q,function(){if(this.nm==r[u].name){if(r[u].summaryTpl){w=r[u].summaryTpl}if(this.st=="avg"){if(this.v&&t>0){this.v=this.v/t}}try{s=d.formatter("",this.v,u,this)}catch(b){s=this.v}v="<td "+d.formatCol(u,1,"")+">"+a.jgrid.format(w,s)+"</td>";return false}});f+=v}f+="</tr>"}});a("#"+d.p.id+" tbody:first").append(f);f=null})},groupingGroupBy:function(b,c){return this.each(function(){var d=this;if(typeof b=="string"){b=[b]}var e=d.p.groupingView;d.p.grouping=true;if(typeof e.visibiltyOnNextGrouping=="undefined"){e.visibiltyOnNextGrouping=[]}var f;for(f=0;f<e.groupField.length;f++){if(!e.groupColumnShow[f]&&e.visibiltyOnNextGrouping[f]){a(d).jqGrid("showCol",e.groupField[f])}}for(f=0;f<b.length;f++){e.visibiltyOnNextGrouping[f]=a("#"+d.p.id+"_"+b[f]).is(":visible")}d.p.groupingView=a.extend(d.p.groupingView,c||{});e.groupField=b;a(d).trigger("reloadGrid")})},groupingRemove:function(b){return this.each(function(){var c=this;if(typeof b=="undefined"){b=true}c.p.grouping=false;if(b===true){var d=c.p.groupingView;for(var e=0;e<d.groupField.length;e++){if(!d.groupColumnShow[e]&&d.visibiltyOnNextGrouping[e]){a(c).jqGrid("showCol",d.groupField)}}a("tr.jqgroup, tr.jqfoot","#"+c.p.id+" tbody:first").remove();a("tr.jqgrow:hidden","#"+c.p.id+" tbody:first").show()}else{a(c).trigger("reloadGrid")}})},groupingCalculations:{sum:function(a,b,c){return parseFloat(a||0)+parseFloat(c[b]||0)},min:function(a,b,c){if(a===""){return parseFloat(c[b]||0)}return Math.min(parseFloat(a),parseFloat(c[b]||0))},max:function(a,b,c){if(a===""){return parseFloat(c[b]||0)}return Math.max(parseFloat(a),parseFloat(c[b]||0))},count:function(a,b,c){if(a===""){a=0}if(c.hasOwnProperty(b)){return a+1}else{return 0}},avg:function(a,b,c){return parseFloat(a||0)+parseFloat(c[b]||0)}}})})(jQuery);(function(a){a.jgrid.extend({jqGridImport:function(b){b=a.extend({imptype:"xml",impstring:"",impurl:"",mtype:"GET",impData:{},xmlGrid:{config:"roots>grid",data:"roots>rows"},jsonGrid:{config:"grid",data:"data"},ajaxOptions:{}},b||{});return this.each(function(){var c=this;var d=function(b,d){var e=a(d.xmlGrid.config,b)[0];var f=a(d.xmlGrid.data,b)[0],g,h;if(xmlJsonClass.xml2json&&a.jgrid.parse){g=xmlJsonClass.xml2json(e," ");g=a.jgrid.parse(g);for(var i in g){if(g.hasOwnProperty(i)){h=g[i]}}if(f){var j=g.grid.datatype;g.grid.datatype="xmlstring";g.grid.datastr=b;a(c).jqGrid(h).jqGrid("setGridParam",{datatype:j})}else{a(c).jqGrid(h)}g=null;h=null}else{alert("xml2json or parse are not present")}};var e=function(b,d){if(b&&typeof b=="string"){var e=a.jgrid.parse(b);var f=e[d.jsonGrid.config];var g=e[d.jsonGrid.data];if(g){var h=f.datatype;f.datatype="jsonstring";f.datastr=g;a(c).jqGrid(f).jqGrid("setGridParam",{datatype:h})}else{a(c).jqGrid(f)}}};switch(b.imptype){case"xml":a.ajax(a.extend({url:b.impurl,type:b.mtype,data:b.impData,dataType:"xml",complete:function(c,e){if(e=="success"){d(c.responseXML,b);if(a.isFunction(b.importComplete)){b.importComplete(c)}}c=null}},b.ajaxOptions));break;case"xmlstring":if(b.impstring&&typeof b.impstring=="string"){var f=a.jgrid.stringToDoc(b.impstring);if(f){d(f,b);if(a.isFunction(b.importComplete)){b.importComplete(f)}b.impstring=null}f=null}break;case"json":a.ajax(a.extend({url:b.impurl,type:b.mtype,data:b.impData,dataType:"json",complete:function(c,d){if(d=="success"){e(c.responseText,b);if(a.isFunction(b.importComplete)){b.importComplete(c)}}c=null}},b.ajaxOptions));break;case"jsonstring":if(b.impstring&&typeof b.impstring=="string"){e(b.impstring,b);if(a.isFunction(b.importComplete)){b.importComplete(b.impstring)}b.impstring=null}break}})},jqGridExport:function(b){b=a.extend({exptype:"xmlstring",root:"grid",ident:"\t"},b||{});var c=null;this.each(function(){if(!this.grid){return}var d=a.extend({},a(this).jqGrid("getGridParam"));if(d.rownumbers){d.colNames.splice(0,1);d.colModel.splice(0,1)}if(d.multiselect){d.colNames.splice(0,1);d.colModel.splice(0,1)}if(d.subGrid){d.colNames.splice(0,1);d.colModel.splice(0,1)}d.knv=null;if(d.treeGrid){for(var e in d.treeReader){if(d.treeReader.hasOwnProperty(e)){d.colNames.splice(d.colNames.length-1);d.colModel.splice(d.colModel.length-1)}}}switch(b.exptype){case"xmlstring":c="<"+b.root+">"+xmlJsonClass.json2xml(d,b.ident)+"</"+b.root+">";break;case"jsonstring":c="{"+xmlJsonClass.toJson(d,b.root,b.ident,false)+"}";if(d.postData.filters!==undefined){c=c.replace(/filters":"/,'filters":');c=c.replace(/}]}"/,"}]}")}break}});return c},excelExport:function(b){b=a.extend({exptype:"remote",url:null,oper:"oper",tag:"excel",exportOptions:{}},b||{});return this.each(function(){if(!this.grid){return}var c;if(b.exptype=="remote"){var d=a.extend({},this.p.postData);d[b.oper]=b.tag;var e=jQuery.param(d);if(b.url.indexOf("?")!=-1){c=b.url+"&"+e}else{c=b.url+"?"+e}window.location=c}})}})})(jQuery);(function($){if($.browser.msie&&$.browser.version==8){$.expr[":"].hidden=function(a){return a.offsetWidth===0||a.offsetHeight===0||a.style.display=="none"}}$.jgrid._multiselect=false;if($.ui){if($.ui.multiselect){if($.ui.multiselect.prototype._setSelected){var setSelected=$.ui.multiselect.prototype._setSelected;$.ui.multiselect.prototype._setSelected=function(a,b){var c=setSelected.call(this,a,b);if(b&&this.selectedList){var d=this.element;this.selectedList.find("li").each(function(){if($(this).data("optionLink")){$(this).data("optionLink").remove().appendTo(d)}})}return c}}if($.ui.multiselect.prototype.destroy){$.ui.multiselect.prototype.destroy=function(){this.element.show();this.container.remove();if($.Widget===undefined){$.widget.prototype.destroy.apply(this,arguments)}else{$.Widget.prototype.destroy.apply(this,arguments)}}}$.jgrid._multiselect=true}}$.jgrid.extend({sortableColumns:function(a){return this.each(function(){function d(){b.p.disableClick=true}var b=this,c=b.p.id;var e={tolerance:"pointer",axis:"x",scrollSensitivity:"1",items:">th:not(:has(#jqgh_"+c+"_cb"+",#jqgh_"+c+"_rn"+",#jqgh_"+c+"_subgrid),:hidden)",placeholder:{element:function(a){var b=$(document.createElement(a[0].nodeName)).addClass(a[0].className+" ui-sortable-placeholder ui-state-highlight").removeClass("ui-sortable-helper")[0];return b},update:function(a,b){b.height(a.currentItem.innerHeight()-parseInt(a.currentItem.css("paddingTop")||0,10)-parseInt(a.currentItem.css("paddingBottom")||0,10));b.width(a.currentItem.innerWidth()-parseInt(a.currentItem.css("paddingLeft")||0,10)-parseInt(a.currentItem.css("paddingRight")||0,10))}},update:function(a,c){var d=$(c.item).parent(),e=$(">th",d),f=b.p.colModel,g={},h=b.p.id+"_";$.each(f,function(a){g[this.name]=a});var i=[];e.each(function(a){var b=$(">div",this).get(0).id.replace(/^jqgh_/,"").replace(h,"");if(b in g){i.push(g[b])}});$(b).jqGrid("remapColumns",i,true,true);if($.isFunction(b.p.sortable.update)){b.p.sortable.update(i)}setTimeout(function(){b.p.disableClick=false},50)}};if(b.p.sortable.options){$.extend(e,b.p.sortable.options)}else if($.isFunction(b.p.sortable)){b.p.sortable={update:b.p.sortable}}if(e.start){var f=e.start;e.start=function(a,b){d();f.call(this,a,b)}}else{e.start=d}if(b.p.sortable.exclude){e.items+=":not("+b.p.sortable.exclude+")"}a.sortable(e).data("sortable").floating=true})},columnChooser:function(a){function j(a,b){if(!a){return}if(typeof a=="string"){if($.fn[a]){$.fn[a].apply(b,$.makeArray(arguments).slice(2))}}else if($.isFunction(a)){a.apply(b,$.makeArray(arguments).slice(2))}}function e(a,b,c){if(b>=0){var d=a.slice();var e=d.splice(b,Math.max(a.length-b,b));if(b>a.length){b=a.length}d[b]=c;return d.concat(e)}}var b=this;if($("#colchooser_"+b[0].p.id).length){return}var c=$('<div id="colchooser_'+b[0].p.id+'" style="position:relative;overflow:hidden"><div><select multiple="multiple"></select></div></div>');var d=$("select",c);a=$.extend({width:420,height:240,classname:null,done:function(a){if(a){b.jqGrid("remapColumns",a,true)}},msel:"multiselect",dlog:"dialog",dlog_opts:function(a){var b={};b[a.bSubmit]=function(){a.apply_perm();a.cleanup(false)};b[a.bCancel]=function(){a.cleanup(true)};return{buttons:b,close:function(){a.cleanup(true)},modal:a.modal?a.modal:false,resizable:a.resizable?a.resizable:true,width:a.width+20}},apply_perm:function(){$("option",d).each(function(a){if(this.selected){b.jqGrid("showCol",f[this.value].name)}else{b.jqGrid("hideCol",f[this.value].name)}});var c=[];$("option:selected",d).each(function(){c.push(parseInt(this.value,10))});$.each(c,function(){delete h[f[parseInt(this,10)].name]});$.each(h,function(){var a=parseInt(this,10);c=e(c,a,a)});if(a.done){a.done.call(b,c)}},cleanup:function(e){j(a.dlog,c,"destroy");j(a.msel,d,"destroy");c.remove();if(e&&a.done){a.done.call(b)}},msel_opts:{}},$.jgrid.col,a||{});if($.ui){if($.ui.multiselect){if(a.msel=="multiselect"){if(!$.jgrid._multiselect){alert("Multiselect plugin loaded after jqGrid. Please load the plugin before the jqGrid!");return}a.msel_opts=$.extend($.ui.multiselect.defaults,a.msel_opts)}}}if(a.caption){c.attr("title",a.caption)}if(a.classname){c.addClass(a.classname);d.addClass(a.classname)}if(a.width){$(">div",c).css({width:a.width,margin:"0 auto"});d.css("width",a.width)}if(a.height){$(">div",c).css("height",a.height);d.css("height",a.height-10)}var f=b.jqGrid("getGridParam","colModel");var g=b.jqGrid("getGridParam","colNames");var h={},i=[];d.empty();$.each(f,function(a){h[this.name]=a;if(this.hidedlg){if(!this.hidden){i.push(a)}return}d.append("<option value='"+a+"' "+(this.hidden?"":"selected='selected'")+">"+g[a]+"</option>")});var k=$.isFunction(a.dlog_opts)?a.dlog_opts.call(b,a):a.dlog_opts;j(a.dlog,c,k);var l=$.isFunction(a.msel_opts)?a.msel_opts.call(b,a):a.msel_opts;j(a.msel,d,l)},sortableRows:function(a){return this.each(function(){var b=this;if(!b.grid){return}if(b.p.treeGrid){return}if($.fn.sortable){a=$.extend({cursor:"move",axis:"y",items:".jqgrow"},a||{});if(a.start&&$.isFunction(a.start)){a._start_=a.start;delete a.start}else{a._start_=false}if(a.update&&$.isFunction(a.update)){a._update_=a.update;delete a.update}else{a._update_=false}a.start=function(c,d){$(d.item).css("border-width","0px");$("td",d.item).each(function(a){this.style.width=b.grid.cols[a].style.width});if(b.p.subGrid){var e=$(d.item).attr("id");try{$(b).jqGrid("collapseSubGridRow",e)}catch(f){}}if(a._start_){a._start_.apply(this,[c,d])}};a.update=function(c,d){$(d.item).css("border-width","");if(b.p.rownumbers===true){$("td.jqgrid-rownum",b.rows).each(function(a){$(this).html(a+1+(parseInt(b.p.page,10)-1)*parseInt(b.p.rowNum,10))})}if(a._update_){a._update_.apply(this,[c,d])}};$("tbody:first",b).sortable(a);$("tbody:first",b).disableSelection()}})},gridDnD:function(a){return this.each(function(){function c(){var a=$.data(b,"dnd");$("tr.jqgrow:not(.ui-draggable)",b).draggable($.isFunction(a.drag)?a.drag.call($(b),a):a.drag)}var b=this;if(!b.grid){return}if(b.p.treeGrid){return}if(!$.fn.draggable||!$.fn.droppable){return}var d="<table id='jqgrid_dnd' class='ui-jqgrid-dnd'></table>";if($("#jqgrid_dnd").html()===null){$("body").append(d)}if(typeof a=="string"&&a=="updateDnD"&&b.p.jqgdnd===true){c();return}a=$.extend({drag:function(a){return $.extend({start:function(c,d){if(b.p.subGrid){var e=$(d.helper).attr("id");try{$(b).jqGrid("collapseSubGridRow",e)}catch(f){}}for(var g=0;g<$.data(b,"dnd").connectWith.length;g++){if($($.data(b,"dnd").connectWith[g]).jqGrid("getGridParam","reccount")=="0"){$($.data(b,"dnd").connectWith[g]).jqGrid("addRowData","jqg_empty_row",{})}}d.helper.addClass("ui-state-highlight");$("td",d.helper).each(function(a){this.style.width=b.grid.headers[a].width+"px"});if(a.onstart&&$.isFunction(a.onstart)){a.onstart.call($(b),c,d)}},stop:function(c,d){if(d.helper.dropped&&!a.dragcopy){var e=$(d.helper).attr("id");$(b).jqGrid("delRowData",e)}for(var f=0;f<$.data(b,"dnd").connectWith.length;f++){$($.data(b,"dnd").connectWith[f]).jqGrid("delRowData","jqg_empty_row")}if(a.onstop&&$.isFunction(a.onstop)){a.onstop.call($(b),c,d)}}},a.drag_opts||{})},drop:function(a){return $.extend({accept:function(a){if(!$(a).hasClass("jqgrow")){return a}var b=$(a).closest("table.ui-jqgrid-btable");if(b.length>0&&$.data(b[0],"dnd")!==undefined){var c=$.data(b[0],"dnd").connectWith;return $.inArray("#"+this.id,c)!=-1?true:false}return a},drop:function(c,d){if(!$(d.draggable).hasClass("jqgrow")){return}var e=$(d.draggable).attr("id");var f=d.draggable.parent().parent().jqGrid("getRowData",e);if(!a.dropbyname){var g=0,h={},i;var j=$("#"+this.id).jqGrid("getGridParam","colModel");try{for(var k in f){if(f.hasOwnProperty(k)&&j[g]){i=j[g].name;h[i]=f[k]}g++}f=h}catch(l){}}d.helper.dropped=true;if(a.beforedrop&&$.isFunction(a.beforedrop)){var m=a.beforedrop.call(this,c,d,f,$("#"+b.id),$(this));if(typeof m!="undefined"&&m!==null&&typeof m=="object"){f=m}}if(d.helper.dropped){var n;if(a.autoid){if($.isFunction(a.autoid)){n=a.autoid.call(this,f)}else{n=Math.ceil(Math.random()*1e3);n=a.autoidprefix+n}}$("#"+this.id).jqGrid("addRowData",n,f,a.droppos)}if(a.ondrop&&$.isFunction(a.ondrop)){a.ondrop.call(this,c,d,f)}}},a.drop_opts||{})},onstart:null,onstop:null,beforedrop:null,ondrop:null,drop_opts:{activeClass:"ui-state-active",hoverClass:"ui-state-hover"},drag_opts:{revert:"invalid",helper:"clone",cursor:"move",appendTo:"#jqgrid_dnd",zIndex:5e3},dragcopy:false,dropbyname:false,droppos:"first",autoid:true,autoidprefix:"dnd_"},a||{});if(!a.connectWith){return}a.connectWith=a.connectWith.split(",");a.connectWith=$.map(a.connectWith,function(a){return $.trim(a)});$.data(b,"dnd",a);if(b.p.reccount!="0"&&!b.p.jqgdnd){c()}b.p.jqgdnd=true;for(var e=0;e<a.connectWith.length;e++){var f=a.connectWith[e];$(f).droppable($.isFunction(a.drop)?a.drop.call($(b),a):a.drop)}})},gridResize:function(opts){return this.each(function(){var $t=this;if(!$t.grid||!$.fn.resizable){return}opts=$.extend({},opts||{});if(opts.alsoResize){opts._alsoResize_=opts.alsoResize;delete opts.alsoResize}else{opts._alsoResize_=false}if(opts.stop&&$.isFunction(opts.stop)){opts._stop_=opts.stop;delete opts.stop}else{opts._stop_=false}opts.stop=function(a,b){$($t).jqGrid("setGridParam",{height:$("#gview_"+$t.p.id+" .ui-jqgrid-bdiv").height()});$($t).jqGrid("setGridWidth",b.size.width,opts.shrinkToFit);if(opts._stop_){opts._stop_.call($t,a,b)}};if(opts._alsoResize_){var optstest="{'#gview_"+$t.p.id+" .ui-jqgrid-bdiv':true,'"+opts._alsoResize_+"':true}";opts.alsoResize=eval("("+optstest+")")}else{opts.alsoResize=$(".ui-jqgrid-bdiv","#gview_"+$t.p.id)}delete opts._alsoResize_;$("#gbox_"+$t.p.id).resizable(opts)})}})})(jQuery);